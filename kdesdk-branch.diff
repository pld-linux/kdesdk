Index: kbabel/kbabel/kbabelview.cpp
===================================================================
--- kbabel/kbabel/kbabelview.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabel/kbabelview.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -33,12 +33,6 @@
 
 **************************************************************************** */
 
-#include "config.h"
-
-#ifdef HAVE_UNISTD_H
-#include <unistd.h>
-#endif
-
 #include "kbabelview.h"
 
 #include "catalogfileplugin.h"
@@ -440,8 +434,8 @@
 
        hb->addStretch(1);
 
-       QString ledMsg=i18n("<qt><p><b>Status LEDS</b></p>\n"
-       "<p>These LEDS display the status of the currently displayed message.\n"
+       QString ledMsg=i18n("<qt><p><b>Status LEDs</b></p>\n"
+       "<p>These LEDs display the status of the currently displayed message.\n"
        "You can change their color in the preferences dialog section\n"
        "<b>Editor</b> on page <b>Appearance</b></p></qt>");
        QWhatsThis::add(_fuzzyLed,ledMsg);
@@ -1518,7 +1512,7 @@
 	     case KMessageBox::Continue:
 	     {
 		// ask for new filename
-		if ((url = KFileDialog::getSaveURL(currentURL().url(),i18n("*.po *.pot|Gettext Files"),this)).isEmpty())
+		if ((url = KFileDialog::getSaveURL(currentURL().url(), CatalogExportPlugin::availableExportMimeTypes().join(" "), this)).isEmpty())
 		{
 		   // if no filename was given cancel all
 		   return false;
@@ -1616,7 +1610,7 @@
 	}
     }
     
-    unlink(tmpname.local8Bit());
+    QFile::remove( tmpname );
 
     return result;
 }
@@ -1654,7 +1648,7 @@
           if(!msgOnlyAtError)
           {
     		KMessageBox::sorry(this
-        	    ,i18n("You can use gettext tools only for checking GNU PO files."));
+        	    ,i18n("You can use gettext tools only for checking PO files."));
 	  }
 	  returnCode=true;
 	  break;
Index: kbabel/kbabel/kbabel.cpp
===================================================================
--- kbabel/kbabel/kbabel.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabel/kbabel.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1704,9 +1704,9 @@
     QString oldproject = m_view->project();
     if( oldproject == KBABEL_DEFAULTPROJECT )
     {
-        oldproject = "";
+        oldproject = QString();
     }
-    QString file = KFileDialog::getOpenFileName(oldproject, i18n("*|All Files"), this);
+    const QString file = KFileDialog::getOpenFileName(oldproject, QString::null, this);
     if (file.isEmpty())
     {
         return;
Index: kbabel/kbabel/kbabelview2.cpp
===================================================================
--- kbabel/kbabel/kbabelview2.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabel/kbabelview2.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -691,8 +691,8 @@
 
     if(url.isEmpty())
     {
-        url = KFileDialog::getOpenURL(_project->settings()->diffBaseDir(), i18n("*.po *.pot|Gettext Files")
-               ,this, i18n("Select File to Diff With"));
+        url = KFileDialog::getOpenURL(_project->settings()->diffBaseDir(), 
+"application/x-gettext", this, i18n("Select File to Diff With"));
     }
 
     if(url.isEmpty())
Index: kbabel/kbabel/kbabel.desktop
===================================================================
--- kbabel/kbabel/kbabel.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabel/kbabel.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -10,7 +10,6 @@
 Name[pt_BR]=Editor de POTFiles
 Name[sv]=Kbabel
 Name[ta]=Kபாபேல்
-Name[xx]=xxKBabelxx
 Exec=kbabel %i %m -caption "%c" %U
 Icon=kbabel
 Type=Application
@@ -70,7 +69,6 @@
 GenericName[ven]=Zwishumiswa zwau Dologa
 GenericName[vi]=Công cụ dịch 
 GenericName[xh]=Isixhobo Soguqulelo lomsebenzi kolunye ulwimi
-GenericName[xx]=xxTranslation Toolxx
 GenericName[zh_CN]=翻译工具
 GenericName[zh_TW]=翻譯工具
 GenericName[zu]=Ithuluzi Lokuguqulela
Index: kbabel/kbabel/kbabel.kcfg
===================================================================
--- kbabel/kbabel/kbabel.kcfg	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabel/kbabel.kcfg	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -227,7 +227,7 @@
     <entry name="RecentFiles" key="Recent Files" type="String">
         <label>
         </label>
-        <default>$HOME/kde/kde-i18n/templates/kdelibs,$HOME/kde/kde-i18n/sk/messages/kdelibs,$HOME/done,$HOME/foo2,$HOME/foo,$HOME/.kde/share/config/kbabel.defaultproject,$HOME/no,$HOME/ahoj.po,$HOME/bla.po</default>
+        <default></default>
     </entry>
     <entry name="ShowPreviews"  type="Bool">
         <label>
Index: kbabel/kbabel/main.cpp
===================================================================
--- kbabel/kbabel/main.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabel/main.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -507,7 +507,7 @@
 {
     KAboutData about("kbabel",I18N_NOOP("KBabel"),VERSION,
        I18N_NOOP("An advanced PO file editor"),KAboutData::License_GPL,
-       I18N_NOOP("(c) 1999,2000,2001,2002,2003,2004,2005 The KBabel developers"),0,"http://i18n.kde.org/tools/kbabel");
+       I18N_NOOP("(c) 1999,2000,2001,2002,2003,2004,2005,2006 The KBabel developers"),0,"http://i18n.kde.org/tools/kbabel");
 
     about.addAuthor("Matthias Kiefer",I18N_NOOP("Original author"),"kiefer@kde.org");
     about.addAuthor("Wolfram Diestel"
@@ -522,7 +522,7 @@
          ,"dubbleu@web.de");
     about.addAuthor("Asgeir Frimannsson",I18N_NOOP("Translation List View")
          ,"asgeirf@redhat.com");
-    about.addAuthor("Nicolas Goutte", I18N_NOOP("Filter improvements"), "goutte@kde.org");
+    about.addAuthor("Nicolas Goutte", I18N_NOOP("Current maintainer"), "goutte@kde.org");
 
     about.addCredit("Claudiu Costin",I18N_NOOP("Wrote documentation and sent "
 		"many bug reports and suggestions for improvements.")
Index: kbabel/kbabel/sourceview.cpp
===================================================================
--- kbabel/kbabel/sourceview.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabel/sourceview.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -61,8 +61,8 @@
 {
     if (isVisible ())
     {
-	_contextView->setContext(_catalog->packageDir()
-            ,_catalog->packageName(), _catalog->context(_currentIndex));
+        // Note: we use Catalog::comment instead of Catalog::context as SourceContext::setContext has to repeat the major part of the code of Catalog::context, so SourceContext::setContext can do the whole job alone.
+	_contextView->setContext( _catalog->packageDir(), _catalog->packageName(), _catalog->comment(_currentIndex), _catalog->currentURL() );
     }
 }
 
Index: kbabel/kbabeldict/kbabeldict.desktop
===================================================================
--- kbabel/kbabeldict/kbabeldict.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/kbabeldict.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -14,6 +14,7 @@
 Name[fi]=KBabel sanakirja
 Name[fr]=Dictionnaire de KBabel
 Name[ga]=KBabel - Foclóir
+Name[he]=KBabel - מילון
 Name[hu]=KBabel szótár
 Name[is]=KBabel orðabók
 Name[it]=Dizionario di KBabel
@@ -31,7 +32,6 @@
 Name[sv]=Kbabel ordlista
 Name[tr]=KBabel Sözlüğü
 Name[uk]=Словник KBabel
-Name[xx]=xxKBabel Dictionaryxx
 Name[zh_CN]=KBabel 词典
 GenericName=Translation Tool Dictionary
 GenericName[bg]=Инструмент за превод
@@ -47,6 +47,7 @@
 GenericName[fi]=Käännöstyökalun kansio
 GenericName[fr]=Dictionnaire d'un outil de traduction
 GenericName[ga]=Uirlis Aistriúcháin - Foclóir
+GenericName[he]=מילון של כלי תרגום
 GenericName[hu]=Fordítássegítő szótár
 GenericName[is]=Þýðingaforrit orðabók
 GenericName[it]=Dizionario di uno strumento di traduzione
@@ -64,7 +65,6 @@
 GenericName[sv]=Översättningsverktyg ordlista
 GenericName[tr]=Çeviri Aracı Sözlüğü
 GenericName[uk]=Словник засобу для перекладів
-GenericName[xx]=xxTranslation Tool Dictionaryxx
 GenericName[zh_CN]=翻译工具词典
 Exec=kbabeldict %i %m -caption "%c"
 Icon=kbabeldict
Index: kbabel/kbabeldict/kbabeldict_module.desktop
===================================================================
--- kbabel/kbabeldict/kbabeldict_module.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/kbabeldict_module.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -38,7 +38,6 @@
 Comment[tg]=Модули луғат барои KBabelDict
 Comment[tr]=KBabelDict için Sözlük Modülü
 Comment[uk]=Модуль словника для KBabelDict
-Comment[xx]=xxDictionary module for KBabelDictxx
 Comment[zh_CN]=KBabelDict 的词典模块
 
 [PropertyDef::Applications]
Index: kbabel/kbabeldict/kbabeldict.cpp
===================================================================
--- kbabel/kbabeldict/kbabeldict.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/kbabeldict.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -58,6 +58,9 @@
     // HACK: hide default button, otherwise it would be Help button
     showButtonOK(false);
 
+    // KBabelDict has not a separate help file, so point to the correct part of the KBabel documentation
+    setHelp( "using-kbabeldict", "kbabel" );
+
     setMainWidget(view);
 
     readConfig();
Index: kbabel/kbabeldict/modules/pocompendium/pocompendium.desktop
===================================================================
--- kbabel/kbabeldict/modules/pocompendium/pocompendium.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/modules/pocompendium/pocompendium.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -36,7 +36,6 @@
 Name[tg]=Модули тасвири PO барои KBabelDict
 Name[tr]=KBabelDict için PO Özet Modülü
 Name[uk]=Модуль збірки перекладів PO для KBabelDict
-Name[xx]=xxPO Compendium Module for KBabelDictxx
 Name[zh_CN]=KBabelDict 的 PO 概要词典模块
 X-KDE-Library=kbabeldict_pocompendium
 ServiceTypes=KBabelDictModule

Property changes on: kbabel/kbabeldict/modules/pocompendium
___________________________________________________________________
Name: svn:ignore
   - Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/kbabeldict/modules/dbsearchengine/dbsearchengine.desktop
===================================================================
--- kbabel/kbabeldict/modules/dbsearchengine/dbsearchengine.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/modules/dbsearchengine/dbsearchengine.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -37,7 +37,6 @@
 Name[tg]=Базаи маълумоти тарҷумаҳо барои KBabelDict
 Name[tr]=KBabelDict için Çeviri Veritabanı
 Name[uk]=База даних перекладів для KBabelDict
-Name[xx]=xxTranslation Database for KBabelDictxx
 Name[zh_CN]=KBabelDict 的翻译数据库
 X-KDE-Library=kbabeldict_dbsearchengine
 ServiceTypes=KBabelDictModule

Property changes on: kbabel/kbabeldict/modules/dbsearchengine
___________________________________________________________________
Name: svn:ignore
   - Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/kbabeldict/modules/dbsearchengine2/dbsearchengine2.desktop
===================================================================
--- kbabel/kbabeldict/modules/dbsearchengine2/dbsearchengine2.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/modules/dbsearchengine2/dbsearchengine2.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -37,7 +37,6 @@
 Name[tg]=Тафсири 2 базаи маълумоти тарҷумаҳо барои KBabelDict
 Name[tr]=KBabelDict için Çeviri Veritabanı v2
 Name[uk]=Версія 2 бази даних перекладів для KBabelDict
-Name[xx]=xxTranslation Database v2 for KBabelDictxx
 Name[zh_CN]=KBabelDict 的翻译数据库 v2
 X-KDE-Library=kbabeldict_dbsearchengine2
 ServiceTypes=KBabelDictModule
Index: kbabel/kbabeldict/modules/poauxiliary/poauxiliary.desktop
===================================================================
--- kbabel/kbabeldict/modules/poauxiliary/poauxiliary.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/modules/poauxiliary/poauxiliary.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -36,7 +36,6 @@
 Name[tg]=Модули ёрирасони PO барои KBabelDict
 Name[tr]=KBabelDict için Yardımcı PO Modülü
 Name[uk]=Модуль допоміжного словника PO для KBabelDict
-Name[xx]=xxAuxiliary PO Module for KBabelDictxx
 Name[zh_CN]=KBabelDict 的 PO 辅助词典模块
 X-KDE-Library=kbabeldict_poauxiliary
 ServiceTypes=KBabelDictModule

Property changes on: kbabel/kbabeldict/modules/poauxiliary
___________________________________________________________________
Name: svn:ignore
   - Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/kbabeldict/modules/tmx/tmxcompendium.h
===================================================================
--- kbabel/kbabeldict/modules/tmx/tmxcompendium.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/modules/tmx/tmxcompendium.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -96,7 +96,7 @@
 protected:
 	void loadCompendium();
     void addResult(SearchResult *);
-    QString maskString(QString string);
+    QString maskString(QString string) const;
 
     void registerData();
     void unregisterData();
Index: kbabel/kbabeldict/modules/tmx/tmxcompendium.desktop
===================================================================
--- kbabel/kbabeldict/modules/tmx/tmxcompendium.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/modules/tmx/tmxcompendium.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -36,7 +36,6 @@
 Name[tg]=Модули тасвири TMX барои KBabelDict
 Name[tr]=KBabelDict için TMX Özet Modülü
 Name[uk]=Модуль збірки перекладів TMX для KBabelDict
-Name[xx]=xxTMX Compendium Module for KBabelDictxx
 Name[zh_CN]=KBabelDict 的 TMX 概要词典模块
 X-KDE-Library=kbabeldict_tmxcompendium
 ServiceTypes=KBabelDictModule
Index: kbabel/kbabeldict/modules/tmx/tmxcompendium.cpp
===================================================================
--- kbabel/kbabeldict/modules/tmx/tmxcompendium.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/kbabeldict/modules/tmx/tmxcompendium.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -41,7 +41,6 @@
 #include <kinstance.h>
 #include <kio/netaccess.h>
 
-#include <qregexp.h>
 #include <qtextstream.h>
 #include <qtimer.h>
 
@@ -747,21 +746,21 @@
     loading=false;
 }
 
-QString TmxCompendium::maskString(QString s)
+QString TmxCompendium::maskString(QString s) const
 {
-    s.replace(QRegExp("\\\\"),"\\\\");
-    s.replace(QRegExp("\\?"),"\\?");
-    s.replace(QRegExp("\\["),"\\[");
-    s.replace(QRegExp("\\."),"\\.");
-    s.replace(QRegExp("\\*"),"\\*");
-    s.replace(QRegExp("\\+"),"\\+");
-    s.replace(QRegExp("\\^"),"\\^");
-    s.replace(QRegExp("\\$"),"\\$");
-    s.replace(QRegExp("\\("),"\\(");
-    s.replace(QRegExp("\\)"),"\\)");
-    s.replace(QRegExp("\\{"),"\\{");
-    s.replace(QRegExp("\\}"),"\\}");
-    s.replace(QRegExp("\\|"),"\\|");
+    s.replace('\\',"\\\\");
+    s.replace('?',"\\?");
+    s.replace('[',"\\[");
+    s.replace('.',"\\.");
+    s.replace('*',"\\*");
+    s.replace('+',"\\+");
+    s.replace('^',"\\^");
+    s.replace('$',"\\$");
+    s.replace('(',"\\(");
+    s.replace(')',"\\)");
+    s.replace('{',"\\{");
+    s.replace('}',"\\}");
+    s.replace('|',"\\|");
     
     return s;
 }

Property changes on: kbabel/kbabeldict/modules/tmx
___________________________________________________________________
Name: svn:ignore
   - Makefile
Makefile.in
Makefile.rules.in
pwidget.cpp
pwidget.h
   + Makefile
Makefile.in
Makefile.rules.in
pwidget.cpp
pwidget.h
*.moc
.libs
.deps



Property changes on: kbabel/kbabeldict
___________________________________________________________________
Name: svn:ignore
   - Makefile
Makefile.in
kbabeldict
   + Makefile
Makefile.in
kbabeldict
*.moc
.libs
.deps


Index: kbabel/VERSION
===================================================================
--- kbabel/VERSION	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/VERSION	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1 +1 @@
-1.11
+1.11.1
Index: kbabel/commonui/cmdedit.cpp
===================================================================
--- kbabel/commonui/cmdedit.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/commonui/cmdedit.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -48,7 +48,7 @@
     QGridLayout* layout = new QGridLayout( this , 1 , 1 );
     layout->setSpacing( KDialog::spacingHint() );
 
-    QLabel* nameLabel = new QLabel( i18n("&Name:"), this);
+    QLabel* nameLabel = new QLabel( i18n("Command &Label:"), this);
     QLabel* cmdLabel = new QLabel( i18n("Co&mmand:"), this);
     layout->addWidget( nameLabel, 0 , 0 );
     layout->addWidget( cmdLabel, 0 , 1 );
Index: kbabel/commonui/projectprefwidgets.cpp
===================================================================
--- kbabel/commonui/projectprefwidgets.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/commonui/projectprefwidgets.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -287,9 +287,8 @@
 "what encoding to use, please ask your translation coordinator.</p>"
 "<ul><li><b>%1</b>: this is the encoding that fits the character "
 "set of your system language.</li>"
-"<li><b>%2</b>: uses unicode (UTF-8) encoding.</li>"
-"<li><b>%3</b>: uses unicode (UTF-16) encoding."
-"This is not recommended at the moment because gettext might have some trouble reading this.</li></ul></qt>").arg(defaultName).arg(utf8Name).arg(utf16Name) );
+"<li><b>%2</b>: uses Unicode (UTF-8) encoding.</li>"
+"</ul></qt>").arg(defaultName).arg(utf8Name) );
 
 
     QWhatsThis::add(_oldEncodingButton
@@ -318,8 +317,10 @@
 "<li><b>Local</b> is the format specific to your country.\n"
 "It can be configured in KDE's Control Center.</li>\n"
 "<li><b>Custom</b> lets you define your own format.</li></ul></p> "
+"<p>It is recommended that you use the default format to avoid creating non-standard PO files.</p>"
 "<p>For more information, see section <b>The Preferences Dialog</b> "
-"in the online help.</p></qt>") );
+"in the online help.</p>"
+"</qt>") );
 
     setMinimumSize(sizeHint());
 }
@@ -481,18 +482,16 @@
     connect(_testPluralButton, SIGNAL(clicked()), this
             , SLOT(testPluralForm()));
 
-    // ### FIXME: "KDE >= 2.2" should be replaced
-    QString msg=i18n("<qt><p><b>Number of singular/plural forms</b></p>\n"
-            "<p><b>Note</b>: This option is KDE specific at the moment. "
+    const QString msg=i18n("<qt><p><b>Number of singular/plural forms</b></p>"
+            "<p><b>Note</b>: This option is KDE specific. "
             "If you are not translating a KDE application, you can safely "
-            "ignore this option.</p>\n"
+            "ignore this option.</p>"
             "<p>Choose here how many singular and plural forms are used in "
             "your language. "
             "This number must correspond to the settings of your language "
-            "team. "
-            "If you are working with KDE >= 2.2 with support for the "
-            "language you are translating to, set this option to "
-            "<i>Automatic</i> and KBabel tries to get this information "
+            "team.</p>"
+            "<p>Alternatively, you can set this option to "
+            "<i>Automatic</i> and KBabel will try to get this information "
             "automatically from KDE. Use the <i>Test</i> button "
             "to test if it can find it out.</p></qt>");
     QWhatsThis::add(_pluralFormsBox,msg);
@@ -930,11 +929,10 @@
 
     _killButton = new QCheckBox( i18n("&Kill processes on exit") , box, "kcfg_KillCmdOnExit" );
 
-    // ### FIXME: s/It's/It is/ (especially that it is folowed by "not")
     QWhatsThis::add( _killButton , i18n("<qt><p><b>Kill processes on exit</b></p>\n"
 "<p>If you check this, KBabel tries to kill the processes, that have not exited already when KBabel exits,\n"
 "by sending a kill signal to them.</p>\n"
-"<p>NOTE: It's not guaranteed that the processes will be killed.</p></qt>") );
+"<p>NOTE: It is not guaranteed that the processes will be killed.</p></qt>") );
 
 
     _indexButton = new QCheckBox( i18n("Create inde&x for file contents"), box, "kcfg_IndexWords" );
@@ -946,15 +944,15 @@
     m_msgfmtButton = new QCheckBox( i18n("Run &msgfmt before processing a file"), box, "kcfg_msgfmt" );
 
     QWhatsThis::add( m_msgfmtButton, i18n("<qt><p><b>Run msgfmt before processing a file</b></p>"
-        "<p>If you check this, KBabel will run Gettext's "
+        "<p>If you enable this, KBabel will run Gettext's "
         "msgfmt tool before processing a file.</p>"
-        "<p>It is recommended to check this setting, even if it makes the processing slower. "
-        "Checking this setting is the default.</p>"
-        "<p>Unchecking is useful for slow computers and when you want "
+        "<p>Enabling this setting is recommended, even if it causes processing to be slower. "
+        "This setting is enabled by default.</p>"
+        "<p>Disabling is useful for slow computers and when you want "
         "to translate PO files that are not supported by the current version "
         "of the Gettext tools that are on your system. "
-        "The drawback of unchecking is that barely not any syntax checking is done by the processing code, "
-        "so that invalid PO files could be shown as good ones, "
+        "The drawback of disabling is that hardly any syntax checking is done by the processing code, "
+        "so invalid PO files could be shown as good ones, "
         "even if Gettext tools would reject such files.</p></qt>") );
 
     layout->addStretch(1);
@@ -1120,7 +1118,7 @@
     _fuzzyColumnCheckbox = new QCheckBox( i18n("&Fuzzy"), box, "kcfg_ShowFuzzyColumn" );
     _untranslatedColumnCheckbox = new QCheckBox( i18n("&Untranslated"), box, "kcfg_ShowUntranslatedColumn" );
     _totalColumnCheckbox = new QCheckBox( i18n("&Total"), box, "kcfg_ShowTotalColumn" );
-    _cvsColumnCheckbox = new QCheckBox( i18n("&CVS status"), box, "kcfg_ShowCVSColumn" );
+    _cvsColumnCheckbox = new QCheckBox( i18n("SVN/&CVS status"), box, "kcfg_ShowCVSColumn" );
     _revisionColumnCheckbox = new QCheckBox( i18n("Last &revision"), box, "kcfg_ShowRevisionColumn" );
     _translatorColumnCheckbox = new QCheckBox( i18n("Last t&ranslator"), box, "kcfg_ShowTranslatorColumn" );
 
Index: kbabel/commonui/kbabel_validator.desktop
===================================================================
--- kbabel/commonui/kbabel_validator.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/commonui/kbabel_validator.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -38,7 +38,6 @@
 Comment[tg]=Маълумоти асбоби KDE барои KBabel
 Comment[tr]=KBabel için KDE Veri Aracı
 Comment[uk]=Засіб роботи з даними KDE для KBabel
-Comment[xx]=xxKDE Data Tool for KBabelxx
 Comment[zh_CN]=KBabel 的 KDE 数据工具
 
 [PropertyDef::Shortcuts]
Index: kbabel/commonui/context.cpp
===================================================================
--- kbabel/commonui/context.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/commonui/context.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -50,6 +50,9 @@
 #include <kdialog.h>
 #include <klocale.h>
 #include <kmessagebox.h>
+#include <kurl.h>
+#include <kdeversion.h>
+#include <kio/netaccess.h>
 
 #include <klibloader.h>
 #include <ktrader.h>
@@ -59,6 +62,7 @@
 #include <ktexteditor/viewcursorinterface.h>
 
 SourceContext::SourceContext(QWidget *parent, KBabel::Project::Ptr project): QWidget(parent)
+    , m_parent( parent )
     , _part(0)
     , _view(0)
     , _referenceCombo(0)
@@ -73,21 +77,24 @@
     _layout->addWidget(_referenceCombo);
 }
 
-void SourceContext::setContext(const QString& packageDir, const QString& packageName, const QString& gettextComment)
+void SourceContext::setContext( const QString& packageDir, const QString& packageName, const QString& gettextComment, const KURL& urlPoFile )
 {
     if( !_part && !loadPart() ) return;
     _referenceCombo->clear();
-    _referenceList.clear();
-    _referenceList = resolvePath(packageDir,packageName,gettextComment);
+    _referenceList = resolvePath( packageDir, packageName, gettextComment, urlPoFile );
     
-    for( QValueList<ContextInfo>::Iterator it=_referenceList.begin(); it!=_referenceList.end() ; ++it)
+    for( QValueList<ContextInfo>::const_iterator it = _referenceList.constBegin(); it != _referenceList.constEnd(); ++it )
 	_referenceCombo->insertItem((*it).path);
+
     _referenceCombo->setEnabled( !_referenceList.isEmpty() );
-    
     if( _referenceList.isEmpty() )
     {
-	(dynamic_cast<KTextEditor::EditInterface *>(_part))->setText(i18n("Corresponding source file not found"));
-	_part->setReadWrite(false);
+        _part->setReadWrite( true );
+        // We have to simulate a new document (like with File/New) by using openStream and closeStream
+        _part->openStream("text/plain","kbabel:error"); // KBabel does not show the URL kbabel:error
+        _part->closeStream();
+        (dynamic_cast<KTextEditor::EditInterface *>(_part))->setText(i18n("Corresponding source file not found"));
+        _part->setReadWrite(false);
 	_part->setModified(false);
     } 
     else 
@@ -101,72 +108,149 @@
 {
     if( !_part ) return;
     ContextInfo ci = *(_referenceList.at(index));
-    if( _part->url() != KURL(ci.path) )
+    KURL newUrl( KURL::fromPathOrURL( ci.path ) );
+    if( _part->url() != newUrl )
     {
-	_part->openURL( KURL(ci.path) );
+        _part->setReadWrite( true );
+        _part->openURL( newUrl );
     }
-    _part->setReadWrite(true);
+    _part->setReadWrite( false );
     (dynamic_cast<KTextEditor::ViewCursorInterface *>(_view))->setCursorPosition(ci.line,0);
     (dynamic_cast<KTextEditor::SelectionInterface *>(_part))->setSelection(ci.line-1,0,ci.line,0);
 }
 
-QValueList<ContextInfo> SourceContext::resolvePath(const QString& packageDir, const QString& packageName, const QString& gettextComment)
+QValueList<ContextInfo> SourceContext::resolvePath( const QString& packageDir, const QString& packageName, const QString& gettextComment, const KURL& urlPoFile )
 {
+    //kdDebug() << "GETTEXTCOMMENT:" << gettextComment << endl;
+
+    // Find the directory name of the PO file, if the PO file is local
+    // ### TODO: find a way to allow remote files too
+    QString poDir;
+#if KDE_IS_VERSION( 3, 5, 0 )
+    const KURL localUrl( KIO::NetAccess::mostLocalURL( urlPoFile, m_parent ) );
+    if ( localUrl.isLocalFile() )
+    {
+        const QFileInfo fi( localUrl.path() );
+        poDir = fi.dirPath( true );
+    }
+#else
+    if ( urlPoFile.isLocalFile() )
+    {
+        const QFileInfo fi( urlPoFile.path() );
+        poDir = fi.dirPath( true );
+    }
+#endif
+
+#if 0
+    kdDebug() << "CONTEXT VARIABLE START" << endl;
+    kdDebug() << "@CODEROOT@: " << _project->settings()->codeRoot() << endl;
+    kdDebug() << "@PACKAGEDIR@: " << packageDir  << endl;
+    kdDebug() << "@PACKAGE@: " << packageName << endl;
+    kdDebug() << "@POFILEDIR@: " << poDir  << endl;
+    kdDebug() << "CONTEXT VARIABLE END" << endl;
+#endif
+    
     QStringList prefixes;
-    QStringList paths = _project->settings()->paths();
+    const QStringList paths = _project->settings()->paths();
     
-    for( QStringList::Iterator it = paths.begin() 
-	; it!=paths.end() ; ++it)
+    for( QStringList::const_iterator it = paths.constBegin(); it!=paths.constEnd() ; ++it )
     {
 	QString pref = (*it);
+
+        if ( !poDir.isEmpty() )
+        {
+            pref.replace( "@POFILEDIR@", poDir );
+        }
+        else if ( pref.find( "@POFILEDIR@ " ) != -1 )
+            continue; // No need to keep this path pattern, as we have no PO file dir
+        
         pref.replace( "@PACKAGEDIR@", packageDir);
         pref.replace( "@PACKAGE@", packageName);
 	pref.replace( "@CODEROOT@", _project->settings()->codeRoot());
 	prefixes.append(pref);
     }
 
-    QStringList references;
-    QStringList lines = QStringList::split("\n", gettextComment);
-    for( QStringList::Iterator it = lines.begin() ; it!=lines.end() ; ++it)
+    QValueList<ContextInfo> rawRefList; // raw references
+    QRegExp re("^\\s*(.+):(\\d+)\\s*$"); // Reg. exp. for Gettext references
+    QRegExp rex( "^#. i18n: file (.+) line (\\d+)\\s*$" ); //Reg. exp. for KDE extractrc/extractattr references
+    QRegExp res( "^# [Ff]ile: (.+), line(?: number)?: (\\d+)\\s*$"); // Reg. exp. for "strict" PO format
+    const QStringList lines = QStringList::split( "\n", gettextComment );
+    for ( QStringList::const_iterator it = lines.constBegin() ; it != lines.constEnd() ; ++it)
     {
-	QString curLine = (*it);
-	if( curLine.startsWith("#:") ) curLine = curLine.mid(2);
-	curLine = curLine.stripWhiteSpace();
-	
-	QStringList refs=QStringList::split(" ",curLine);
-	
-	for( QStringList::Iterator it=refs.begin(); it!=refs.end(); ++it)
-	{
-	     references.push_back( *it );
-	}
+	const QString curLine = (*it).stripWhiteSpace();
+	if( curLine.startsWith( "#:" ) )
+        {
+            // We have a Gettext line with references
+            const QStringList references( QStringList::split( " ", curLine.mid( 2 ), false ) );
+            for ( QStringList::const_iterator it = references.constBegin(); it != references.constEnd(); ++it )
+            {
+                if ( re.exactMatch( (*it) ) )
+                {
+                    ContextInfo ref;
+                    ref.line = re.cap(2).toInt();
+                    ref.path = re.cap(1);
+                    // ### TODO KDE4: perhaps we should not do the replace if compiled for Windows
+                    ref.path.replace( QChar( '\\' ), QChar( '/' ) );
+                    rawRefList.append( ref );
+                }
+            }
+            
+        }
+        else if ( curLine.startsWith( "#," ) )
+        {
+            // We have a Gettext option line. There is no source reference here.
+            continue;
+        }
+        else if ( curLine.startsWith( "#. i18n:") )
+        {
+            // We might have a KDE reference from extractrc/extractattr
+            if ( rex.exactMatch( (*it) ) )
+            {
+                ContextInfo ref;
+                ref.line = rex.cap(2).toInt();
+                ref.path = rex.cap(1);
+                // KDE is not extracted on Windows, so no backslash conversion is needed.
+                rawRefList.append( ref );
+            }
+        }
+        else if ( curLine.startsWith( "# F" ) || curLine.startsWith( "# f" ) )
+        {
+            // We might have a "strict PO" reference
+            if ( res.exactMatch( (*it) ) )
+            {
+                ContextInfo ref;
+                ref.line = res.cap(2).toInt();
+                ref.path = res.cap(1);
+                // ### TODO KDE4: perhaps we should not do the replace if compiled for Windows
+                ref.path.replace( QChar( '\\' ), QChar( '/' ) );
+                rawRefList.append( ref );
+            }
+        }
+        else
+            continue; 
     }
     
+    // Now that we have gathered the references, we need to convert them to absolute paths
     QValueList<ContextInfo> results;
-    QRegExp re(":\\d+");
-    
-    for( QStringList::Iterator it = references.begin() ; it!=references.end() ; ++it)
+    for ( QValueList<ContextInfo>::const_iterator it = rawRefList.constBegin(); it != rawRefList.constEnd(); ++it )
     {
-	QString curRef = (*it);
-	curRef.findRev(re);
-	if( re.pos(0)+re.cap(0).length() == curRef.length() )
-	{
-	    QString lineNum = re.cap(0).mid(1);
-	    QString fileName = curRef.mid( 0, curRef.length()-re.matchedLength() );
-	    for( QStringList::Iterator it1 = prefixes.begin(); it1!=prefixes.end() ; ++it1 )
-	    {
-		QString path = (*it1);
-		path.replace( "@COMMENTPATH@", fileName);
-		
-		QFileInfo url(path);
-		if( url.exists())
-		{
-		    ContextInfo ref;
-		    ref.path = url.absFilePath();
-		    ref.line = lineNum.toInt();
-		    results.append(ref);
-		}
-	    }
-	}
+        const int lineNum = (*it).line;
+        const QString fileName = (*it).path;
+        for ( QStringList::const_iterator it1 = prefixes.constBegin(); it1 != prefixes.constEnd(); ++it1 )
+        {
+            QString path = (*it1);
+            path.replace( "@COMMENTPATH@", fileName);
+
+            //kdDebug() << "CONTEXT PATH: " << path << endl; // DEBUG
+            QFileInfo pathInfo( path );
+            if( pathInfo.exists() )
+            {
+                ContextInfo ref;
+                ref.path = pathInfo.absFilePath();
+                ref.line = lineNum;
+                results.append(ref);
+            }
+        }
     }
     
     return results;
@@ -216,3 +300,5 @@
 }
 
 #include "context.moc"
+
+// kate: space-indent on; indent-width 4; replace-tabs on;
Index: kbabel/commonui/context.h
===================================================================
--- kbabel/commonui/context.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/commonui/context.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -46,6 +46,7 @@
 class QLineEdit;
 class KListEditor;
 class KConfig;
+class KURL;
 
 struct ContextInfo
 {
@@ -54,14 +55,25 @@
 };
 
 /**
-* Widget for displaying source code context of for the given GNU gettext comment.
-* The searched paths can be configured using variables @PACKAGE@, @PACKAGEDIR@,
-* @CODEROOT@ and @COMMENTPATH@. It requires a KPart implementing KTextEditor interface
-* with selections.
-*
-* @short Class for displaying source code context
-* @author Stanislav Visnovsky <visnovsky@kde.org>
-*/
+ * @short Class for displaying source code context
+ *
+ * Widget for displaying source code context of for the given GNU gettext comment.
+ * The searched paths can be configured using variables.
+ *
+ * The possible variables are:
+ * - \@POFILEDIR\@   absolute directory of the PO file (to create paths relatives to the PO file)
+ * - \@PACKAGE\@     name of the PO file
+ * - \@PACKAGEDIR\@  relative directory of the PO file (relative to \@CODEROOT\@)
+ * - \@CODEROOT\@    base directory (especially of the catalog manager)
+ * - \@COMMENTPATH\@ (relative) path given as source code reference in a comment of the PO file
+ *
+ * @note The difference between \@POFILEDIR\@ and a path constructed by
+ * \@CODEROOT\@\@PACKAGEDIR\@/ is that \@POFILEDIR\@ will also work if the file is external
+ * to the catalog manager's root
+ *
+ * @note It requires a KPart implementing KTextEditor interface with selections.
+ * @author Stanislav Visnovsky <visnovsky@kde.org>
+ */
 class SourceContext : public QWidget
 {
     Q_OBJECT
@@ -76,13 +88,26 @@
      * @param packageDir	path of the package, where to find the source file
      * @param packageName	name of the package, where to find the source file
      * @param gettextComment	comment string with context as generated by xgettext (can start with #:)
+     * @param urlPoFile         URL of the PO file
+     * @todo even if @p urlPoFile is an URL SourceContext::resolvePath is not remote-aware yet
      */
-    void setContext( const QString& packageDir, const QString& packageName, const QString& gettextComment );
+    void setContext( const QString& packageDir, const QString& packageName, const QString& gettextComment, const KURL& urlPoFile );
 
 private:
-    QValueList<ContextInfo> resolvePath( const QString& packageDir, const QString& packageName, const QString& gettextComment);
+    /**
+     * Get a list of paths from the source references in the comment @p gettextComment
+     * @param packageDir        path of the package, where to find the source file
+     * @param packageName       name of the package, where to find the source file
+     * @param gettextComment    comment string with context as generated by xgettext (can start with #:)
+     * @param urlPoFile         URL of the PO file
+     * @todo even if @p urlPoFile is an URL SourceContext::resolvePath is not remote-aware yet
+     * @private 
+     */
+    QValueList<ContextInfo> resolvePath( const QString& packageDir, const QString& packageName, const QString& gettextComment, const KURL& urlPoFile );
     bool loadPart();
-    
+
+    /// Parent widget (for KIO::NetAccess member functions)
+    QWidget* m_parent;
     KTextEditor::Document* _part;
     KTextEditor::View* _view;
     QComboBox *_referenceCombo;
Index: kbabel/ChangeLog
===================================================================
--- kbabel/ChangeLog	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/ChangeLog	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1,8 +1,28 @@
-Changes 1.11:
+Changes 1.11.1 (KDE 3.5.1)
+- Avoid user-visible strings that need to be translated in two ways (bug #114151)
+- Fix and improve source references
+- Add a new variable @POFILEDIR@ for source references.
+  This is for allowing search paths starting at the directory of the PO file,
+  like what is needed for GNU projects: starting at the parent directory (bug #114041)
+- Allow backslashes in source references in the PO file (bug #116393)
+- Clicking the help button of KBabelDict calls the corresponding section in the KBabel documentation
+- Improved documentation
+
+Changes 1.11 (KDE 3.5):
 - Diff settings part of a project (Stanislav Visnovsky)
 - View for current list of errors (Albert Cervera Areny)
 - Datatool for generic regexp validation (Albert Cervera Areny)
 - Separated editor color settings to its own page (Stanislav Visnovsky)
+- Improve CVS support of catalog manager
+- Allow the user to select an encoding for CVS (bug #66605)
+- Add SVN support to catalog manager (bug #105805)
+- Support for Gettext context (keyword "msgctxt")
+- Improve Gettext plural support
+- Abort load of a PO file with CVS/SVN conflict markers in it (bug #108285)
+- Make optional the ; character before the "charset" of a Content-Type declaration in a PO file (bug #106733)
+- Make the catalog manager work with PO files having CR/LF line endings (bug #105399)
+- Fix remote saving of files (bug #106738)
+- Improve writing the header while saving a PO file (bugs #64413, #107782, #115275, #115276, #115295)
 
 Changes 1.10:
 - XLIFF support (Stanislav Visnovsky)
Index: kbabel/common/poinfo.h
===================================================================
--- kbabel/common/poinfo.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/common/poinfo.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -93,7 +93,36 @@
     */
    static void cacheSave(const QString url, PoInfo& info);
 
+   /** 
+    * @brief Get information about the PO file
+    * 
+    * @param url The path (not an URL) of the file 
+    * @param info The information retrieved from the file
+    * @param wordList ???
+    * @param updateWordList ???
+    * @param interactive Can the function interact with the user?
+    * @param msgfmt Should each file be checked with Gettext's msgfmt before
+    *        being parsed?
+    * @since KBabel 1.11 (KDE 3.5)
+    */
    static ConversionStatus info(const QString& url,PoInfo& info, QStringList &wordList, bool updateWordList, bool interactive, bool msgfmt);
+
+   /** 
+    * @brief Get information about the PO file
+    * 
+    * @param url The path (not an URL) of the file 
+    * @param info The information retrieved from the file
+    * @param wordList ???
+    * @param updateWordList ???
+    * @param interactive Can the function interact with the user?
+    * @deprecated
+    * @note This function is missing in KBabel 1.11 (KDE 3.5). 
+    *       The function was re-introduced for binary-compatibility in
+    *       KBabel 1.11.1 (KDE 3.5.1)
+    * @note This function always call Gettext's mgfmt before parsing each file
+    */
+   static ConversionStatus info(const QString& url,PoInfo& info, QStringList &wordList, bool updateWordList, bool interactive = true);
+
    static PoInfo headerInfo(const CatalogItem&);
    static bool findInFile(const QString& url, FindOptions options );
    
Index: kbabel/common/catalog.h
===================================================================
--- kbabel/common/catalog.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/common/catalog.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -187,8 +187,9 @@
    *
    * @param index  index of the requested message
    * @return       context information found in the message comment
+   * @deprecated
    */
-   QString context(uint index) const;
+   QString context(uint index) const KDE_DEPRECATED;
 
    /**
    * Get the header for the current file.
Index: kbabel/common/catalogitem.cpp
===================================================================
--- kbabel/common/catalogitem.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/common/catalogitem.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -76,7 +76,7 @@
     if( noNewlines )
     {
         QString tmp = d->_msgctxt;
-        tmp.replace("\n", " ");
+        tmp.replace("\n", " "); // ### TODO: " " or "" ?
         return tmp;
     }
     else
@@ -88,14 +88,7 @@
     QStringList result=d->_msgid;
     if( noNewlines )
     {
-        // ### TODO JJ: use QstringList::gres to replace inside the QStringLisz
-        result.clear();
-        for( QStringList::Iterator it = d->_msgid.begin() ; it != d->_msgid.end() ; it++ )
-	{
-	    QString resultstring = (*it);
-	    resultstring.replace("\n","");
-	    result.append(resultstring);
-	}
+        result.gres( "\n", "" );
     }
     return result;
 }
@@ -105,14 +98,7 @@
     QStringList result=d->_msgstr;
     if( noNewlines )
     {
-        // ### TODO JJ: use QstringList::gres to replace inside the QStringLisz
-	result.clear();
-	for( QStringList::Iterator it = d->_msgstr.begin() ; it != d->_msgstr.end() ; it++ )
-	{
-	    QString resultstring = (*it);
-	    resultstring.replace("\n","");
-	    result.append(resultstring);
-	}
+        result.gres( "\n", "" );
     }
     return result;
 }
@@ -255,7 +241,7 @@
 PluralFormType CatalogItem::pluralForm() const
 {
     if( d->_gettextPluralForm ) return Gettext;
-    if( d->_msgid.first().find( QRegExp("_n:\\s")) == 0 ) return KDESpecific;
+    if( d->_msgid.first().find( QRegExp("_n:\\s")) == 0 ) return KDESpecific; // ### TODO: we could use startsWith("_n: ")
     else return NoPluralForm;
 }
 
@@ -528,3 +514,5 @@
 {
     d->_project = project;
 }
+
+// kate: space-indent on; indent-width 4; replace-tabs on;
Index: kbabel/common/poinfo.cpp
===================================================================
--- kbabel/common/poinfo.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/common/poinfo.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -350,6 +350,11 @@
 }
 
 
+ConversionStatus PoInfo::info(const QString& url, PoInfo& info, QStringList &wordList, bool updateWordList, bool interactive)
+{
+    return PoInfo::info( url, info, wordList, updateWordList, interactive, true);
+}
+
 ConversionStatus PoInfo::info(const QString& url, PoInfo& info, QStringList &wordList, bool updateWordList, bool interactive, bool msgfmt)
 {
    stopStaticRead = false;
Index: kbabel/common/catalog.cpp
===================================================================
--- kbabel/common/catalog.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/common/catalog.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -833,20 +833,18 @@
 
 void Catalog::setPackage(const QString& package )
 {
-    int pos=package.findRev("/");
-    if( pos<0 )
+    const int pos = package.findRev( '/' );
+    if( pos < 0 )
     {
-	d->_packageDir = "";
+	d->_packageDir = QString();
 	d->_packageName = package;
-	d->_packageName.replace( QRegExp("^/+"),"");
     }
     else
     {
-	d->_packageDir = package.left(pos);
-	if( !d->_packageDir.endsWith("/") ) d->_packageDir+="/";
-	d->_packageName = package.right(package.length()-pos);
-	d->_packageName.replace( QRegExp("^/+"),"");
+	d->_packageDir = package.left( pos + 1 ); // We want the / included
+	d->_packageName = package.mid( pos + 1 ); // We do not want /
     }
+    kdDebug() << k_funcinfo << " " << package << " => " << d->_packageDir << " + " << d->_packageName << endl;
 }
 
 QString Catalog::packageDir() const
Index: kbabel/common/kbabelfilter.desktop
===================================================================
--- kbabel/common/kbabelfilter.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/common/kbabelfilter.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -16,6 +16,7 @@
 Comment[fi]=KBabel-suodin
 Comment[fr]=Filtre pour KBabel
 Comment[ga]=Scagaire KBabel
+Comment[he]=מסנן KBabel
 Comment[hi]=के-बेबल फ़िल्टर
 Comment[hu]=KBabel-szűrő
 Comment[is]=KBabel sía
@@ -38,7 +39,6 @@
 Comment[tg]=Филтри KBabel
 Comment[tr]=KBabel süzgeci
 Comment[uk]=Фільтр KBabel
-Comment[xx]=xxKBabel filterxx
 Comment[zh_CN]=KBabel 过滤器
 
 [PropertyDef::X-KDE-Import]
Index: kbabel/common/kbprojectsettings.kcfg
===================================================================
--- kbabel/common/kbprojectsettings.kcfg	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/common/kbprojectsettings.kcfg	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -348,7 +348,7 @@
 		<default></default>
 	</entry>
 	<entry name="Paths" type="StringList">
-		<default>@PACKAGEDIR@/@PACKAGE@/@COMMENTPATH@,@CODEROOT@/@PACKAGEDIR@/@PACKAGE@/@COMMENTPATH@,@CODEROOT@/@PACKAGE@/@COMMENTPATH@</default>
+		<default>@PACKAGEDIR@/@PACKAGE@/@COMMENTPATH@,@CODEROOT@/@PACKAGEDIR@/@PACKAGE@/@COMMENTPATH@,@CODEROOT@/@PACKAGE@/@COMMENTPATH@,@POFILEDIR@/@COMMENTPATH@,@POFILEDIR@/../@COMMENTPATH@</default>
 	</entry>
   </group>
 </kcfg>
Index: kbabel/datatools/not-translated/kbabel_nottranslatedtool.desktop
===================================================================
--- kbabel/datatools/not-translated/kbabel_nottranslatedtool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/not-translated/kbabel_nottranslatedtool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -32,7 +32,6 @@
 Name[tg]=Тафтиши сатрҳои тарҷумашуда ба баробарии аслӣ барои KBabel
 Name[tr]=KBabel için İngilizce İhtiva Eden Çevrilen Dizgeler Denetimi
 Name[uk]=Перевірка перекладених фраз на вміст англійської для KBabel
-Name[xx]=xxCheck for Translated Strings Containing English for KBabelxx
 Name[zh_CN]=KBabel 检查已翻译字符串包含英语的工具
 ValidationString=whitespace checking
 X-KDE-Library=kbabel_nottranslatedtool
@@ -51,6 +50,7 @@
 Comment[eu]=Inglesa duten itzulpenak
 Comment[fi]=Käännös sisältää englantia
 Comment[fr]=Traductions contenant de l'anglais
+Comment[he]=תרגומים המכילים אנגלית
 Comment[hi]=अंग्रेज़ी युक्त अनुवाद
 Comment[hu]=Angol nyelvű részeket tartalmazó fordítások
 Comment[is]=Þýðingar sem innihalda ensku
@@ -72,7 +72,6 @@
 Comment[tg]=Тарҷумаҳое, ки англисӣ доранд
 Comment[tr]=İngilizce İhtiva eden Çeviriler
 Comment[uk]=Переклади, які містять англійську
-Comment[xx]=xxTranslations Containing Englishxx
 Comment[zh_CN]=翻译包含英语
 ServiceTypes=KDataTool,KBabelValidator
 DataType=CatalogItem
Index: kbabel/datatools/not-translated/main.cc
===================================================================
--- kbabel/datatools/not-translated/main.cc	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/not-translated/main.cc	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -57,7 +57,7 @@
 NotTranslatedTool::NotTranslatedTool( QObject* parent, const char* name, const QStringList & )
     : KDataTool( parent, name ) , _cache_origin( 0 )
 {
-    i18n("which check found errors","english text in translation");
+    i18n("which check found errors","English text in translation");
 }
 
 bool NotTranslatedTool::run( const QString& command, void* data, const QString& datatype, const QString& mimetype )

Property changes on: kbabel/datatools/not-translated
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/datatools/xml/kbabel_xmltool.desktop
===================================================================
--- kbabel/datatools/xml/kbabel_xmltool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/xml/kbabel_xmltool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -35,7 +35,6 @@
 Name[tg]=Тафтиши XML барои KBabel
 Name[tr]=KBabel için XML Onaylama
 Name[uk]=Перевірка XML для KBabel
-Name[xx]=xxXML Validation for KBabelxx
 Name[zh_CN]=KBabel 的 XML 检查器
 ValidationString=XML tags
 X-KDE-Library=kbabel_xmltool
@@ -50,12 +49,13 @@
 Comment[da]=Tjek tag
 Comment[de]=Prüfung der Tags in Übersetzungen
 Comment[el]=Έλεγχος ετικετών
-Comment[es]=Etiquetas de comprobación
+Comment[es]=Comprobación de etiquetas
 Comment[et]=Siltide kontroll
 Comment[eu]=Egiaztatu etiketak
 Comment[fi]=Tarkista tagit
 Comment[fr]=Vérifier les balises
 Comment[ga]=Seiceáil Clibeanna
+Comment[he]=בודק תגיות
 Comment[hi]=टैग्स जांच करें
 Comment[hu]=A tag-ek ellenőrzése
 Comment[is]=Athuga tög
@@ -78,7 +78,6 @@
 Comment[tg]=Тафтиш кардани тегҳо
 Comment[tr]=Biçim İmlerini Sına
 Comment[uk]=Перевірити мітки
-Comment[xx]=xxCheck Tagsxx
 Comment[zh_CN]=检查标签
 ServiceTypes=KDataTool,KBabelValidator
 DataType=CatalogItem

Property changes on: kbabel/datatools/xml
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.deps
.libs


Index: kbabel/datatools/length/kbabel_lengthtool.desktop
===================================================================
--- kbabel/datatools/length/kbabel_lengthtool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/length/kbabel_lengthtool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -32,7 +32,6 @@
 Name[tg]=Утилитаи тафтиши дарозии ахборҳои тарҷумакунанда барои KBabel
 Name[tr]=KBabel için Çevrilen Mesaj Uzunluk Kontrolü
 Name[uk]=Перевірка довжини перекладених фраз для KBabel
-Name[xx]=xxTranslated Message Length Validator for KBabelxx
 Name[zh_CN]=KBabel 已翻译消息的长度检查器
 ValidationString=length checking
 X-KDE-Library=kbabel_lengthtool
@@ -72,7 +71,6 @@
 Comment[tg]=Тафтиш кардани дарозии хабарҳои тарҷумашуда
 Comment[tr]=Çevrilen Mesaj Uzunluğunu Denetle
 Comment[uk]=Перевірити довжину перекладених фраз
-Comment[xx]=xxCheck Translated Message Lengthxx
 Comment[zh_CN]=检查已翻译消息的长度
 ServiceTypes=KDataTool,KBabelValidator
 DataType=CatalogItem

Property changes on: kbabel/datatools/length
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/datatools/setfuzzy/kbabel_setfuzzytool.desktop
===================================================================
--- kbabel/datatools/setfuzzy/kbabel_setfuzzytool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/setfuzzy/kbabel_setfuzzytool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -34,7 +34,6 @@
 Name[tg]=Утилита барои сиёҳнависӣ дар KBabel
 Name[tr]=KBabel için Geçiş Bulanık Aracı
 Name[uk]=Засіб перемикання неточних фраз для KBabel
-Name[xx]=xxToggle Fuzzy Tool for KBabelxx
 Name[zh_CN]=KBabel 切换模糊工具
 X-KDE-Library=kbabel_setfuzzytool
 Type=Service
@@ -74,7 +73,6 @@
 Comment[tg]=Барқарор кардани ҳолати "сиёҳнависҳо" барои ҳамаи сабтҳо
 Comment[tr]=Tümünü Bulanık Ata
 Comment[uk]=Встановити всі фрази як "неточні"
-Comment[xx]=xxSet All Fuzzyxx
 Comment[zh_CN]=全部设为模糊
 ServiceTypes=KDataTool,KBabelTool
 DataType=Catalog

Property changes on: kbabel/datatools/setfuzzy
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/datatools/context/kbabel_contexttool.desktop
===================================================================
--- kbabel/datatools/context/kbabel_contexttool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/context/kbabel_contexttool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -34,7 +34,6 @@
 Name[tg]=Тафтиши ахбороти тарҷумашудаи матнӣ барои KBabel
 Name[tr]=KBabel için Çevrilen Bağlam Bilgisi Denetimi
 Name[uk]=Перевірка інформації контексту перекладу для KBabel
-Name[xx]=xxTranslated Context Info Validation for KBabelxx
 Name[zh_CN]=KBabel 的上下文信息翻译检查器
 ValidationString=context information
 X-KDE-Library=kbabel_contexttool
@@ -74,7 +73,6 @@
 Comment[tg]=Ҷустуҷӯи ахбороти тарҷумашудаи матнӣ 
 Comment[tr]=Çevrilen Bağlam Bilgisi için Görünüş
 Comment[uk]=Пошук за інформацією контексту перекладу
-Comment[xx]=xxLook for Translated Context Infoxx
 Comment[zh_CN]=查找翻译的上下文信息
 Shortcuts=Ctrl+L
 ServiceTypes=KDataTool,KBabelValidator

Property changes on: kbabel/datatools/context
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/datatools/arguments/kbabel_argstool.desktop
===================================================================
--- kbabel/datatools/arguments/kbabel_argstool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/arguments/kbabel_argstool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -34,7 +34,6 @@
 Name[tg]=Тафтиши далелҳо барои KBabel
 Name[tr]=KBabel için Hızlandırma Argümanı
 Name[uk]=Перевірка аргументів для KBabel
-Name[xx]=xxArgument Validation for KBabelxx
 Name[zh_CN]=KBabel 的参数检查器
 X-KDE-Library=kbabel_argstool
 Type=Service
@@ -54,6 +53,7 @@
 Comment[fi]=Tarkista muuttujat
 Comment[fr]=Vérification des arguments
 Comment[ga]=Seiceáil Argóintí
+Comment[he]=בודק ארגומנטים
 Comment[hi]=आर्गुमेंट जांच करें
 Comment[hu]=Az argumentumok ellenőrzése
 Comment[is]=Athuga viðföng
@@ -75,7 +75,6 @@
 Comment[tg]=Тафтиш кардани далелҳо
 Comment[tr]=Argümanların Denetimi
 Comment[uk]=Перевірити аргументи
-Comment[xx]=xxCheck Argumentsxx
 Comment[zh_CN]=检查参数
 Shortcuts=Ctrl+D
 ValidationString=arguments

Property changes on: kbabel/datatools/arguments
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/datatools/pluralforms/kbabel_pluralformstool.desktop
===================================================================
--- kbabel/datatools/pluralforms/kbabel_pluralformstool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/pluralforms/kbabel_pluralformstool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -34,7 +34,6 @@
 Name[tg]=Тафтиши шаклҳои бисёр барои KBabel
 Name[tr]=KBabel için Çoklu Form Denetimi
 Name[uk]=Перевірка форм множини для KBabel
-Name[xx]=xxPlural Form Validation for KBabelxx
 Name[zh_CN]=KBabel 的复数形式检查器
 ValidationString=plural forms
 X-KDE-Library=kbabel_pluraltool
@@ -53,6 +52,7 @@
 Comment[eu]=Egiaztatu plural formak
 Comment[fi]=Tarkista monikkomuodot
 Comment[fr]=Vérifie les formes plurielles
+Comment[he]=בודק מצבי רבים
 Comment[hi]=बहुवचन जाँचें
 Comment[hu]=A többes számú alakok ellenőrzése
 Comment[is]=Athuga fleirtöluform
@@ -75,7 +75,6 @@
 Comment[tg]=Тафтиш кардани шаклҳои бисёр
 Comment[tr]=Çoklu Formları denetle
 Comment[uk]=Перевірити форми множини
-Comment[xx]=xxCheck Plural Formsxx
 Comment[zh_CN]=检查复数形式
 ServiceTypes=KDataTool,KBabelValidator
 DataType=CatalogItem

Property changes on: kbabel/datatools/pluralforms
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.deps
.libs


Index: kbabel/datatools/accelerators/kbabel_accelstool.desktop
===================================================================
--- kbabel/datatools/accelerators/kbabel_accelstool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/accelerators/kbabel_accelstool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -35,7 +35,6 @@
 Name[tg]=Тафтиши акселаторҳо барои KBabel
 Name[tr]=KBabel için Hızlandırma Onayı
 Name[uk]=Перевірка акселератора для KBabel
-Name[xx]=xxAccelerator Validation for KBabelxx
 Name[zh_CN]=KBabel 的快捷键检查器
 ValidationString=accelerator
 X-KDE-Library=kbabel_accelstool
@@ -54,6 +53,7 @@
 Comment[eu]=Egiaztatu bizkortzaileak
 Comment[fi]=Tarkista pikavalinnat
 Comment[fr]=Vérification des accélérateurs clavier
+Comment[he]=בודק מזנקים
 Comment[hi]=त्वरक जांच करें
 Comment[hu]=A gyorsbillentyűk ellenőrzése
 Comment[is]=Athuga flýtilykla
@@ -76,7 +76,6 @@
 Comment[tg]=Тафтиши акселаторҳо
 Comment[tr]=Hızlandırıcıları Denetle
 Comment[uk]=Перевірити акселератори
-Comment[xx]=xxCheck Acceleratorsxx
 Comment[zh_CN]=检查快捷键
 Shortcuts=Ctrl+H
 ServiceTypes=KBabelValidator,KDataTool

Property changes on: kbabel/datatools/accelerators
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/datatools/equations/kbabel_equationstool.desktop
===================================================================
--- kbabel/datatools/equations/kbabel_equationstool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/equations/kbabel_equationstool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -34,7 +34,6 @@
 Name[tg]=Тафтиши баробар барои KBabel
 Name[tr]=KBabel için Denklem Denetimi
 Name[uk]=Перевірка рівнянь для KBabel
-Name[xx]=xxEquation Validation for KBabelxx
 Name[zh_CN]=KBabel 的等式检查器
 X-KDE-Library=kbabel_equationstool
 Type=Service
@@ -52,6 +51,7 @@
 Comment[eu]=Egiaztatu ekuazioak
 Comment[fi]=Tarkista yhtälöt
 Comment[fr]=Vérifier les identités
+Comment[he]=בודק משוואות
 Comment[hi]=समीकरण जांच करें
 Comment[hu]=Az egyenletek ellenőrzése
 Comment[is]=Athuga jöfnur
@@ -74,7 +74,6 @@
 Comment[tg]=Тафтиш кардани баробарҳо
 Comment[tr]=Denklemleri Denetle
 Comment[uk]=Перевірити рівняння
-Comment[xx]=xxCheck Equationsxx
 Comment[zh_CN]=检查等式
 ServiceTypes=KDataTool,KBabelValidator
 Shortcuts=Ctrl+J

Property changes on: kbabel/datatools/equations
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.deps
.libs


Index: kbabel/datatools/punctuation/kbabel_punctuationtool.desktop
===================================================================
--- kbabel/datatools/punctuation/kbabel_punctuationtool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/punctuation/kbabel_punctuationtool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -33,7 +33,6 @@
 Name[tg]=Тафтиши пунктуатсия барои KBabel
 Name[tr]=KBabel için Noktalama denetimi
 Name[uk]=Перевірка пунктуації для KBabel
-Name[xx]=xxPunctuation Validation for KBabelxx
 Name[zh_CN]=KBabel 的标点检查器
 ValidationString=accelerator
 X-KDE-Library=kbabel_punctuationtool
@@ -53,6 +52,7 @@
 Comment[fi]=Tarkista pilkutus
 Comment[fr]=Vérifie la ponctuation
 Comment[ga]=Seiceáil Poncaíocht
+Comment[he]=בודק ניקוד
 Comment[hi]=विरामचिह्न जांच करें
 Comment[hu]=Az írásjelek ellenőrzése
 Comment[is]=Athuga greinamerki
@@ -73,7 +73,6 @@
 Comment[tg]=Тафтиш кардани пунктуатсия
 Comment[tr]=Noktalama Denetimi
 Comment[uk]=Перевірити пунктуацію
-Comment[xx]=xxCheck Punctuationxx
 Comment[zh_CN]=检查标点
 Shortcuts=Ctrl+P
 ServiceTypes=KBabelValidator,KDataTool

Property changes on: kbabel/datatools/punctuation
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.libs
.deps


Index: kbabel/datatools/regexp/kbabel_regexptool.desktop
===================================================================
--- kbabel/datatools/regexp/kbabel_regexptool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/regexp/kbabel_regexptool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -8,8 +8,11 @@
 Name[el]=Γραμματική καταλανικών
 Name[es]=Gramática catalana
 Name[et]=Katalaani grammatika
+Name[eu]=Katalanaren gramatika
 Name[fr]=Grammaire du catalan
 Name[ga]=Gramadach na Catalóinise
+Name[he]=תחברי קטאלני
+Name[hu]=Katalán nyelvtan
 Name[is]=Katalónsk málfræði
 Name[it]=Grammatica catalana
 Name[ja]=カタロニア文節
@@ -24,7 +27,6 @@
 Name[sv]=Katalansk grammatik
 Name[tr]=Katalan Dil Bilgisi
 Name[uk]=Каталонська граматика
-Name[xx]=xxCatalan Grammarxx
 Name[zh_CN]=Catalan 语法
 ValidationString=external script checking
 X-KDE-Library=kbabel_regexptool
@@ -37,7 +39,9 @@
 Comment[el]=Έλεγχος μεταφρασμένων μηνυμάτων με ένα σύνολο κανονικών εκφράσεων
 Comment[es]=Comprobar mensajes traducidos mediante un juego de expresiones regulares
 Comment[et]=Tõlgitud teate kontroll regulaaravaldistega
+Comment[eu]=Egiaztatu itzulitako mezuak espresio erregular sorta batekin
 Comment[fr]=Vérifie les messages traduits avec un jeu d'expressions rationnelles
+Comment[hu]=A lefordított üzenetek ellenőrzése reguláris kifejezésekkel
 Comment[is]=Athuga þýdd skilaboð með reglulegum segðum
 Comment[it]=Controlla i messaggi tradotti con un insieme di espressioni regolari
 Comment[ja]=正規表現を用いて翻訳メッセージを検証
@@ -51,7 +55,6 @@
 Comment[sv]=Kontrollera översatta meddelanden med en uppsättning reguljära uttryck
 Comment[tr]=Bir Düzgün Anlatım grubu ile birlikte çevrilen mesajları denetle
 Comment[uk]=Перевірити перекладені фрази за допомогою набору формальних виразів
-Comment[xx]=xxCheck Translated Messages with a set of Regular Expressionsxx
 Comment[zh_CN]=用一组正则表达式检查已翻译消息
 ServiceTypes=KDataTool,KBabelValidator
 DataType=CatalogItem
Index: kbabel/datatools/regexp/main.cc
===================================================================
--- kbabel/datatools/regexp/main.cc	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/regexp/main.cc	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -150,7 +150,7 @@
 
 	QDomNode n = e.firstChild();
 	if ( n.isNull() ) {
-		_error = i18n( "'item' first child is not a node" );
+		_error = i18n( "First child of 'item' is not a node" );
 		return;
 	}
 

Property changes on: kbabel/datatools/regexp
___________________________________________________________________
Name: svn:ignore
   - *.moc
.libs
Makefile
Makefile.in

   + *.moc
.libs
.deps
Makefile
Makefile.in


Index: kbabel/datatools/whitespace/kbabel_whitespacetool.desktop
===================================================================
--- kbabel/datatools/whitespace/kbabel_whitespacetool.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/datatools/whitespace/kbabel_whitespacetool.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -32,7 +32,6 @@
 Name[tg]=Тафтиши сатр, ки мисли фосила барои KBabel, тарҷума шудааст
 Name[tr]=KBabel için Ayırma Boşluğu gibi Çevrilen Dizge Denetimi
 Name[uk]=Перевірка фраз, перекладених як пропуски, для KBabel
-Name[xx]=xxString Translated as Whitespace Validator for KBabelxx
 Name[zh_CN]=KBabel 的字符串译为空格的检查器
 ValidationString=whitespace checking
 X-KDE-Library=kbabel_whitespacetool
@@ -51,6 +50,7 @@
 Comment[eu]=Zurigune itzulpenak
 Comment[fi]=Välilyöntikäännökset
 Comment[fr]=Traductions en espaces
+Comment[he]=תרגומים של תווים נקיים
 Comment[hi]=व्हाइट-स्पेस अनुवाद
 Comment[hu]=Az üres fordítások kiszűrése
 Comment[is]=Þýðingar bila
@@ -72,7 +72,6 @@
 Comment[tg]=Тарҷумаҳои холӣ
 Comment[tr]=Ayırma Boşluğu Çevirileri
 Comment[uk]=Порожні переклади
-Comment[xx]=xxWhitespace Translationsxx
 Comment[zh_CN]=空白翻译
 ServiceTypes=KDataTool,KBabelValidator
 DataType=CatalogItem

Property changes on: kbabel/datatools/whitespace
___________________________________________________________________
Name: svn:ignore
   - *.lo
*.o
Makefile
Makefile.in
   + Makefile
Makefile.in
*.moc
.deps
.libs


Index: kbabel/catalogmanager/libcvs/cvsdialog.cpp
===================================================================
--- kbabel/catalogmanager/libcvs/cvsdialog.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/catalogmanager/libcvs/cvsdialog.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -117,8 +117,8 @@
     layout->addWidget( m_encodingComboBox );
     QStringList encodingList;
     // The last encoding will be added at the top of the list, when the seetings will be read.
-    encodingList << i18n( "Descriptive encoding name", "Recommended (%1)" ).arg( "UTF-8" );
-    encodingList << i18n( "Descriptive encoding name", "Locale (%1)" ).arg( QTextCodec::codecForLocale()->mimeName() );
+    encodingList << i18n( "Descriptive encoding name", "Recommended ( %1 )" ).arg( "UTF-8" );
+    encodingList << i18n( "Descriptive encoding name", "Locale ( %1 )" ).arg( QTextCodec::codecForLocale()->mimeName() );
     encodingList += KGlobal::charsets()->descriptiveEncodingNames();
     m_encodingComboBox->insertStringList( encodingList );
     
@@ -403,7 +403,7 @@
       logedit->setText( m_squeezedLogMessages.first( ) );
 
     m_encoding = config->readEntry( "CVSEncoding", "UTF-8" );
-    m_encodingComboBox->insertItem( i18n( "Descriptive encoding name", "Last choice (%1)" ).arg( m_encoding ), 0);
+    m_encodingComboBox->insertItem( i18n( "Descriptive encoding name", "Last choice ( %1 )" ).arg( m_encoding ), 0);
   }
 }
 
Index: kbabel/catalogmanager/catalogmanager.cpp
===================================================================
--- kbabel/catalogmanager/catalogmanager.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/catalogmanager/catalogmanager.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -657,7 +657,7 @@
 	kapp->updateRemoteUserTimestamp ("kbabel");
 
         if( !client->send("kbabel","KBabelIFace", callfunc, data) )
-            KMessageBox::error(this, i18n("Can not send a message to KBabel.\n"
+            KMessageBox::error(this, i18n("Cannot send a message to KBabel.\n"
                                           "Please check your installation of KDE."));
     }
 }
@@ -690,7 +690,7 @@
 	kapp->updateRemoteUserTimestamp ("kbabel");
 
         if( !client->send("kbabel","KBabelIFace", callfunc, data) )
-            KMessageBox::error(this, i18n("Can not send a message to KBabel.\n"
+            KMessageBox::error(this, i18n("Cannot send a message to KBabel.\n"
                                           "Please check your installation of KDE."));
     }
 }
@@ -721,7 +721,7 @@
 	kapp->updateRemoteUserTimestamp ("kbabel");
 
         if( !client->send("kbabel","KBabelIFace", callfunc, data) )
-            KMessageBox::error(this, i18n("Can not send a message to KBabel.\n"
+            KMessageBox::error(this, i18n("Cannot send a message to KBabel.\n"
                                           "Please check your installation of KDE."));
     }
 }
@@ -751,7 +751,7 @@
 	kapp->updateRemoteUserTimestamp ("kbabel");
 
         if( !client->send("kbabel","KBabelIFace", callfunc, data) )
-            KMessageBox::error(this, i18n("Can not send a message to KBabel.\n"
+            KMessageBox::error(this, i18n("Cannot send a message to KBabel.\n"
                                           "Please check your installation of KDE."));
     }
 }
@@ -781,7 +781,7 @@
 	kapp->updateRemoteUserTimestamp ("kbabel");
 
         if( !client->send("kbabel","KBabelIFace", callfunc, data) )
-            KMessageBox::error(this, i18n("Can not send a message to KBabel.\n"
+            KMessageBox::error(this, i18n("Cannot send a message to KBabel.\n"
                                           "Please check your installation of KDE."));
     }
 }
@@ -801,7 +801,7 @@
 	kapp->updateRemoteUserTimestamp ("kbabel");
 
         if( !client->send("kbabel","KBabelIFace", "spellcheck(QStringList)", data) )
-            KMessageBox::error(this, i18n("Can not send a message to KBabel.\n"
+            KMessageBox::error(this, i18n("Cannot send a message to KBabel.\n"
                                           "Please check your installation of KDE."));
     }
 }
@@ -821,7 +821,7 @@
 	kapp->updateRemoteUserTimestamp ("kbabel");
 
         if( !client->send("kbabel","KBabelIFace", "spellcheck(QStringList)", data) )
-            KMessageBox::error(this, i18n("Can not send a message to KBabel.\n"
+            KMessageBox::error(this, i18n("Cannot send a message to KBabel.\n"
                                           "Please check your installation of KDE."));
     }
 }
@@ -1194,7 +1194,7 @@
     {
         oldproject = QString();
     }
-    QString file = KFileDialog::getOpenFileName(oldproject, i18n("*|All Files"), this);
+    const QString file = KFileDialog::getOpenFileName(oldproject, QString::null, this);
     if (file.isEmpty())
     {
         return;
Index: kbabel/catalogmanager/future.cpp
===================================================================
--- kbabel/catalogmanager/future.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/catalogmanager/future.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -2,24 +2,8 @@
 
 // Misc. messages already existing in the kbabel-svn branch
 i18n("SVN");
-i18n("SVN Dialog");
 i18n( "CVS/SVN Status" );
-i18n( "No version control" );
 
-// Messages for support local/remome SVN status (remote = "svn stat -u")
-i18n( "Status (Local)" );
-i18n( "Status (Local) for Marked" );
-i18n( "Status (Remote)" );
-i18n( "Status (Remote) for Marked" );
-i18n( "Get remote status for the following files:" );
-i18n( "Get local status for the following files:" );
-
-// Messages for "svn info"
-i18n( "Show Information" );
-i18n( "Show Information for Marked" );
-i18n( "Get information for the following files:" );
-i18n( "&Get Information" );
-
 // Messages for further SVN functions
 i18n( "Resolved" );
 i18n( "Resolved for Marked" );
@@ -28,20 +12,6 @@
 i18n( "Cleanup" );
 i18n( "Cleanup for Marked" );
 
-// Messages for fixing bug #66605 in CVS support
-i18n( "Descriptive encoding name", "Last choice ( %1 )" );
-i18n( "Descriptive encoding name", "Recommended ( %1 )" );
-i18n( "Descriptive encoding name", "Locale ( %1 )" );
-i18n( "Cannot find encoding: %1" );
-i18n( "E&ncoding:" );
-i18n( "The commit log message cannot be encoded in the selected encoding: %1.\nDo you want to continue?" );
-
 // Messages that will probably not be needed
 i18n( "No repository" );
 
-// Messages for the SVN/CVS handler dialogs
-i18n( "The commit log message is empty. Do you want to continue?" );
-i18n( "The process could not be started." );
-i18n( "Cannot open temporary file for writing. Aborting.");
-i18n( "Cannot write to temporary file. Aborting." );
-
Index: kbabel/catalogmanager/main.cpp
===================================================================
--- kbabel/catalogmanager/main.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/catalogmanager/main.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -182,13 +182,13 @@
 {
     KLocale::setMainCatalogue("kbabel");
     KAboutData about("catalogmanager",I18N_NOOP("KBabel - Catalog Manager"),VERSION,
-                     I18N_NOOP("An advanced catalog manager for KBabel, PO file editor"),KAboutData::License_GPL,
-                     I18N_NOOP("(c) 1999,2000,2001,2002,2003 The KBabel developers"),0,"http://i18n.kde.org/tools/kbabel");
+                     I18N_NOOP("An advanced catalog manager for KBabel"),KAboutData::License_GPL,
+                     I18N_NOOP("(c) 1999,2000,2001,2002,2003,2004,2005,2006 The KBabel developers"),0,"http://i18n.kde.org/tools/kbabel");
 
     about.addAuthor("Matthias Kiefer",I18N_NOOP("Original author"),"kiefer@kde.org");
     about.addAuthor("Stanislav Visnovsky",I18N_NOOP("Current maintainer, porting to KDE3/Qt3.")
                     ,"visnovsky@kde.org");
-    about.addAuthor("Nicolas Goutte", 0, "goutte@kde.org");
+    about.addAuthor("Nicolas Goutte", I18N_NOOP("Current maintainer"), "goutte@kde.org");
 
     about.addCredit("Claudiu Costin",I18N_NOOP("Wrote documentation and sent "
                                                "many bug reports and suggestions for improvements.")
Index: kbabel/catalogmanager/catalogmanager.desktop
===================================================================
--- kbabel/catalogmanager/catalogmanager.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/catalogmanager/catalogmanager.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -7,7 +7,7 @@
 Name[cs]=Správce katalogů
 Name[da]=KBabel kataloghåndtering
 Name[de]=KBabel-Katalogmanager
-Name[el]=KBabel διαχειριστής καταλόγων
+Name[el]=Διαχειριστής καταλόγων του KBabel
 Name[en_GB]=KBabel Catalogue Manager
 Name[es]=Administrador de catálogos de KBabel
 Name[et]=Kataloogihaldur
@@ -15,6 +15,7 @@
 Name[fi]=KBabel luettelon hallinta
 Name[fr]=Gestionnaire de catalogues de KBabel
 Name[ga]=KBabel - Bainisteoir na gCatalóg
+Name[he]=KBabel - מנהל הקטלוגים
 Name[hu]=KBabel listakezelő
 Name[is]=KBabel Þýðingarstjóri
 Name[it]=Gestore dei cataloghi di KBabel
@@ -32,7 +33,6 @@
 Name[sv]=Kbabel kataloghanterare
 Name[tr]=KBabel Katalog Yöneticisi
 Name[uk]=Менеджер каталогів KBabel
-Name[xx]=xxKBabel Catalog Managerxx
 Name[zh_CN]=KBabel 目录管理器
 GenericName=Translation Tool Catalog Manager
 GenericName[bg]=Инструмент за превод
@@ -48,10 +48,12 @@
 GenericName[fi]=Käännöstyökalun luettelon hallinta
 GenericName[fr]=Gestionnaire de catalogues de traduction
 GenericName[ga]=Uirlis Aistriúcháin - Bainisteoir na gCatalóg
+GenericName[he]=מנהל הקטלוגים של כלי התרגום
 GenericName[hu]=Fordítássegítő
 GenericName[is]=Þýðingarforrit - Þýðingarstjóri
 GenericName[it]=Gestore dei cataloghi di uno strumento di traduzione
 GenericName[ja]=翻訳ツール
+GenericName[lt]=Vertimo įrankio katalogo tvarkytuvė
 GenericName[nb]=Oversettingsverktøy
 GenericName[nl]=Vertaalhulpmiddel catalogusbeheer
 GenericName[pa]=ਅਨੁਵਾਦ ਸੰਦ ਲਈ ਸੂਚੀ ਪ੍ਰਬੰਧਕ
@@ -65,7 +67,6 @@
 GenericName[sv]=Översättningsverktyg kataloghanterare
 GenericName[tr]=Çeviri Aracı Katalog Yöneticisi
 GenericName[uk]=Менеджер каталогів засобу для перекладів
-GenericName[xx]=xxTranslation Tool Catalog Managerxx
 GenericName[zh_CN]=翻译工具目录管理器
 Exec=catalogmanager %i %m -caption "%c" %U
 Icon=catalogmanager
Index: kbabel/catalogmanager/catalogmanagerview.cpp
===================================================================
--- kbabel/catalogmanager/catalogmanagerview.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/catalogmanager/catalogmanagerview.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -69,8 +69,8 @@
 #include <kio/netaccess.h>
 #include <kprogress.h>
 #include <kwin.h>
-#include <ktar.h>
 #include <kdeversion.h>
+#include <ktempfile.h>
 
 #include <qfileinfo.h>
 #include <qdir.h>
@@ -489,18 +489,18 @@
     // test validity of list items
     QStringList testedList;
     QStringList::const_iterator it;
-    for( it=newMarkerList.begin() ; it!=newMarkerList.end() ; ++it )
+    for( it=newMarkerList.constBegin() ; it!=newMarkerList.constEnd() ; ++it )
 	if( _fileList[(*it)] != 0 ) testedList.append( (*it) );
 
     // apply new list
-    for( it=_markerList.begin() ; it!=_markerList.end() ; ++it )
+    for( it=_markerList.constBegin() ; it!=_markerList.constEnd() ; ++it )
     {
 	CatManListItem* item = _fileList[(*it)];
 	if( item ) item->setMarked(false);
     }
 
     _markerList = testedList;
-    for( it=_markerList.begin() ; it!=_markerList.end() ; ++it )
+    for( it=_markerList.constBegin() ; it!=_markerList.constEnd() ; ++it )
     {
 	CatManListItem* item = _fileList[(*it)];
 	if( item ) item->setMarked(true);
@@ -511,52 +511,90 @@
 
 void CatalogManagerView::saveMarks()
 {
-    const KURL url = KFileDialog::getSaveURL( QString(), "*.marklist", this );
-    if( url.isEmpty() ) return;
+    const KURL url2 = KFileDialog::getSaveURL( QString(), "*.marklist", this );
+    if( url2.isEmpty() ) return;
 
-    if ( KIO::NetAccess::exists( url, false, this ) )
+    // ### FIXME: why is the file dialog not doing this?
+    if ( KIO::NetAccess::exists( url2, false, this ) )
     {
         if(KMessageBox::warningContinueCancel(this,QString("<qt>%1</qt>").arg(i18n("The file %1 already exists. "
-	            "Do you want to overwrite it?").arg(url.prettyURL())),i18n("Warning"),i18n("&Overwrite"))==KMessageBox::Cancel)
+	            "Do you want to overwrite it?").arg(url2.prettyURL())),i18n("Warning"),i18n("&Overwrite"))==KMessageBox::Cancel)
 	{
 	    return;
 	}
     }
 
-    QString filename;
-    if( url.isLocalFile() ) filename=url.path(0);
-    else filename=kapp->tempSaveName( url.path(0) );
+#if KDE_IS_VERSION( 3, 4, 92 )
+    // Support for partially remote KIO slave like media:
+    const KURL url ( KIO::NetAccess::mostLocalURL( url2, this ) );
+#else
+    const KURL url ( url2 );
+#endif
+    kdDebug() << "Saving marks: " << url2.prettyURL() << " most-local: " << url.prettyURL() << endl;
+    
+    QFile* file = 0;
+    KTempFile* tempFile = 0;
+    QTextStream* stream = 0;
+    bool error = false;
 
-    bool error=false;
-
-    QFile f(filename);
-    if( f.open(IO_WriteOnly) )
+    const bool localFile = url.isLocalFile();
+    if ( localFile )
     {
-	QTextStream s( &f );
-	s << "[Markers]" << endl;
-	for( QStringList::const_iterator it = _markerList.begin(); it!=_markerList.end() ; ++it )
-	    s << (*it) << endl;
-	f.close();
+        // We have a local file
+        file = new QFile( url.path() );
+        if ( file->open (IO_WriteOnly) )
+        {
+            stream = new QTextStream( file );
+        }
+        else
+        {
+            error = true;
+        }
     }
     else
     {
-	error=true;
-        KMessageBox::error(this,
-	    i18n("An error occurred while trying to write to file:\n%1\n").arg(url.prettyURL()));
+        tempFile = new KTempFile();
+        tempFile->setAutoDelete(true);
+        stream = tempFile->textStream();
+        error = !stream;
     }
+    if ( !error )
+    {
+        // ### TODO: try to get a better file format for KDE4 (XML?), one working with real relative paths (no / at start) and working with UTF-8
+        *stream << "[Markers]" << endl;
+        for( QStringList::const_iterator it = _markerList.constBegin(); it!=_markerList.constEnd() ; ++it )
+            *stream << (*it) << endl;
+    }
+    if ( error )
+    {
+        // ### KDE4 FIXME: strip the final \n of the message
+        KMessageBox::error( this,
+            i18n( "An error occurred while trying to write to file:\n%1\n" ).arg( url.prettyURL()) );
+    }
+    else if ( !localFile )
+    {
+        tempFile->close();
+        if( !KIO::NetAccess::upload( tempFile->name(), url, this ) )
+        {
+            // ### KDE4 FIXME: strip the final \n of the message
+            KMessageBox::error(this,
+                i18n("An error occurred while trying to upload the file:\n%1\n").arg(url.prettyURL()));
+        }
+    }
 
-    if( !error && !url.isLocalFile())
+    // We have finished so clean up
+    if ( localFile )
     {
-	if( !KIO::NetAccess::upload( filename, url ) )
-	{
-    	    KMessageBox::error(this,
-		i18n("An error occurred while trying to upload the file:\n%1\n").arg(url.prettyURL()));
-	}
+        delete stream;
+        file->close();
+        delete file;
     }
-
-    if( !url.isLocalFile() ) QFile::remove(filename);
-
-   checkSelected();
+    else
+    {
+        delete tempFile;
+    }
+   
+    checkSelected();
 }
 
 void CatalogManagerView::slotMarkPattern( )
@@ -590,7 +628,7 @@
   rx.setCaseSensitive(markPatternDialog->isCaseSensitive( ));
 
   QStringList fileList = item->allChildrenList(true);
-  for (QStringList::const_iterator it = fileList.begin( ); it != fileList.end( ); ++it) {
+  for (QStringList::const_iterator it = fileList.constBegin( ); it != fileList.constEnd( ); ++it) {
     CatManListItem * i = _fileList[*it];
 
     QString matchName;
@@ -667,7 +705,7 @@
 
    QStringList markedDoList;
    QStringList::const_iterator it;
-   for( it = doList.begin(); it != doList.end(); ++it )
+   for( it = doList.constBegin(); it != doList.constEnd(); ++it )
    {
          CatManListItem* item = _fileList[(*it)];
 	 if( item->marked() ) markedDoList.append(item->package());
@@ -690,7 +728,7 @@
       int totalUntranslated=0;
 
       QStringList::const_iterator it;
-      for( it = childrenList.begin(); it != childrenList.end(); ++it )
+      for( it = childrenList.constBegin(); it != childrenList.constEnd(); ++it )
       {
          CatManListItem* item = _fileList[(*it)];
 
@@ -800,12 +838,12 @@
          }
          case Msgfmt::NoExecutable:
          {
-            KMessageBox::sorry(this,i18n("Can not execute msgfmt. Please make sure you have msgfmt in your PATH!"));
+            KMessageBox::sorry(this,i18n("Cannot execute msgfmt. Please make sure that you have msgfmt in your PATH."));
             break;
          }
 	 case Msgfmt::Unsupported:
 	 {
-    	    KMessageBox::sorry(this,i18n("You can use gettext tools only for checking GNU PO files."));
+    	    KMessageBox::sorry(this,i18n("You can use gettext tools only for checking PO files."));
 	    break;
 	 }
       }
@@ -889,12 +927,12 @@
          }
          case Msgfmt::NoExecutable:
          {
-            KMessageBox::sorry(this,i18n("Cannot execute msgfmt. Please make sure you have msgfmt in your PATH."));
+            KMessageBox::sorry(this,i18n("Cannot execute msgfmt. Please make sure that you have msgfmt in your PATH."));
             break;
          }
 	 case Msgfmt::Unsupported:
 	 {
-    	    KMessageBox::sorry(this,i18n("You can use gettext tools only for checking GNU PO files."));
+    	    KMessageBox::sorry(this,i18n("You can use gettext tools only for checking PO files."));
 	    break;
 	 }
       }
@@ -909,7 +947,7 @@
     {
 	QStringList s = current->allChildrenList(true);
 	QStringList::const_iterator it;
-	for( it = s.begin() ; it != s.end(); ++it )
+	for( it = s.constBegin() ; it != s.constEnd(); ++it )
 	{
 	    CatManListItem *item = _fileList[(*it)];
 	    if( item ) result.append( item );
@@ -932,7 +970,7 @@
     QPtrList<CatManListItem> result;
 
     QStringList::const_iterator it;
-    for( it = _markerList.begin() ; it != _markerList.end(); ++it )
+    for( it = _markerList.constBegin() ; it != _markerList.constEnd(); ++it )
     {
 	CatManListItem *item = _fileList[(*it)];
 	result.append( item );
@@ -951,7 +989,7 @@
     QStringList childrenList = item->allChildrenList(true);
 
     QStringList::const_iterator it;
-    for (it = childrenList.begin(); it != childrenList.end(); ++it) {
+    for (it = childrenList.constBegin(); it != childrenList.constEnd(); ++it) {
       CatManListItem* i = _fileList[(*it)];
       if (i->hasPo()) {
 	filesToSend << i->poFile();
@@ -972,7 +1010,7 @@
 
   QStringList filesToSend;
   QStringList::const_iterator it;
-  for (it = _markerList.begin(); it != _markerList.end(); ++it) {
+  for (it = _markerList.constBegin(); it != _markerList.constEnd(); ++it) {
     CatManListItem* i = _fileList[(*it)];
     if (i->hasPo()) {
       filesToSend << i->poFile();
@@ -989,7 +1027,7 @@
         QStringList childrenList = item->allChildrenList(true);
 
         QStringList::const_iterator it;
-        for (it = childrenList.begin(); it != childrenList.end(); ++it) {
+        for (it = childrenList.constBegin(); it != childrenList.constEnd(); ++it) {
           CatManListItem* i = _fileList[(*it)];
           if (i->hasPo()) {
 	    filesToPackage << i->poFile();
@@ -1013,7 +1051,7 @@
 
     QStringList filesToPackage;
     QStringList::const_iterator it;
-    for (it = _markerList.begin(); it != _markerList.end(); ++it) {
+    for (it = _markerList.constBegin(); it != _markerList.constEnd(); ++it) {
       CatManListItem* i = _fileList[(*it)];
       if (i->hasPo()) {
         filesToPackage << i->poFile();
@@ -1086,7 +1124,7 @@
     if ( _markerList.count( ) == 0 ) return;
     QStringList fileList;
     QStringList::const_iterator it;
-    for ( it = _markerList.begin( ); it != _markerList.end( ); ++it ) {
+    for ( it = _markerList.constBegin( ); it != _markerList.constEnd( ); ++it ) {
       CatManListItem * i = _fileList[(*it)];
       if ( templates && i->hasPot( ) )
         fileList << i->potFile( );
@@ -1197,7 +1235,7 @@
         if ( _markerList.count( ) == 0 ) return;
         QStringList fileList;
         QStringList::const_iterator it;
-        for ( it = _markerList.begin( ); it != _markerList.end( ); ++it ) {
+        for ( it = _markerList.constBegin( ); it != _markerList.constEnd( ); ++it ) {
             CatManListItem * i = _fileList[(*it)];
             if ( templates && i->hasPot( ) )
                 fileList << i->potFile( );
@@ -1251,7 +1289,7 @@
    emit prepareFindProgressBar(childrenList.size());
 
    QStringList::const_iterator it;
-   for( it = childrenList.begin(); it != childrenList.end(); ++it )
+   for( it = childrenList.constBegin(); it != childrenList.constEnd(); ++it )
    {
 	 CatManListItem* item = _fileList[(*it)];
 
@@ -1302,7 +1340,7 @@
 		const QString foundItemFile = itemFile;
 
 		it++;
-		while( it != childrenList.end() )
+		while( it != childrenList.constEnd() )
 		{
         	    CatManListItem *item = _fileList[(*it)];
 
@@ -1350,8 +1388,8 @@
 
 bool CatalogManagerView::hasMatchingWords( QStringList &itemWords, QStringList &searchWords)
 {
-    for( QStringList::const_iterator it1 = searchWords.begin() ; it1 != searchWords.end() ; ++it1 )
-	for( QStringList::const_iterator it2 = itemWords.begin() ; it2 != itemWords.end() ; ++it2 )
+    for( QStringList::const_iterator it1 = searchWords.constBegin() ; it1 != searchWords.constEnd() ; ++it1 )
+	for( QStringList::const_iterator it2 = itemWords.constBegin() ; it2 != itemWords.constEnd() ; ++it2 )
 	    if( *it1 == *it2
 		|| (*it1).contains(*it2)
 		|| (*it2).contains(*it1) ) return true;
@@ -1510,7 +1548,7 @@
       const QStringList contentList = i->allChildrenList(true);
 
       QStringList::const_iterator it;
-      for( it = contentList.begin(); it != contentList.end(); ++it )
+      for( it = contentList.constBegin(); it != contentList.constEnd(); ++it )
       {
          CatManListItem* item = _fileList[(*it)];
 
@@ -1544,7 +1582,7 @@
       const QStringList contentList=i->contentsList(true);
 
       QStringList::const_iterator it;
-      for( it = contentList.begin(); it != contentList.end(); ++it )
+      for( it = contentList.constBegin(); it != contentList.constEnd(); ++it )
       {
          CatManListItem* item = _fileList[(*it)];
 
@@ -1884,7 +1922,7 @@
 
       QStringList::const_iterator it;
 
-      for (  it = entryList.begin(); it != entryList.end() && !_stop ; ++it )
+      for (  it = entryList.constBegin(); it != entryList.constEnd() && !_stop ; ++it )
       {
 	  if( _stop ) return false;
 
@@ -1913,7 +1951,7 @@
 
       entryList=dir.entryList(QDir::Dirs,QDir::Name);
 
-      for (  it = entryList.begin(); it != entryList.end() && !_stop ; ++it )
+      for (  it = entryList.constBegin(); it != entryList.constEnd() && !_stop ; ++it )
       {
           kapp->processEvents(100);
 
@@ -1985,7 +2023,7 @@
 
       QStringList::const_iterator it;
 
-      for (  it = entryList.begin(); it != entryList.end(); ++it )
+      for (  it = entryList.constBegin(); it != entryList.constEnd(); ++it )
       {
           if( _stop ) return;
 
@@ -2016,7 +2054,7 @@
 
       entryList=dir.entryList(QDir::Dirs,QDir::Name);
 
-      for (  it = entryList.begin(); it != entryList.end(); ++it )
+      for (  it = entryList.constBegin(); it != entryList.constEnd(); ++it )
       {
           kapp->processEvents(100);
 
@@ -2069,7 +2107,7 @@
       dir.setPath(poBaseDir+relDir);
       entryList=dir.entryList("*.po",QDir::Files,QDir::Name);
 
-      for (  it = entryList.begin(); it != entryList.end(); ++it )
+      for (  it = entryList.constBegin(); it != entryList.constEnd(); ++it )
       {
           havePoFiles=true;
 
@@ -2100,7 +2138,7 @@
 
       entryList=dir.entryList(QDir::Dirs,QDir::Name);
 
-      for (  it = entryList.begin(); it != entryList.end(); ++it )
+      for (  it = entryList.constBegin(); it != entryList.constEnd(); ++it )
       {
           kapp->processEvents(100);
 
@@ -2157,7 +2195,7 @@
       if(contentList.count()>0)
       {
           QStringList::const_iterator it;
-          for( it = contentList.begin(); it != contentList.end(); ++it )
+          for( it = contentList.constBegin(); it != contentList.constEnd(); ++it )
           {
              QFileInfo po(poBaseDir+(*it));
              QFileInfo pot(potBaseDir+(*it));
@@ -2354,7 +2392,7 @@
 
          CatManListItem* item;
          QStringList::const_iterator it;
-         for( it = childList.begin();it !=  childList.end(); ++it )
+         for( it = childList.constBegin();it !=  childList.constEnd(); ++it )
          {
             item=_fileList[(*it)];
             if(item)
@@ -2417,8 +2455,8 @@
 
    _dirCommandsMenu->clear();
    int counter=0;
-   for ( QStringList::const_iterator it = _settings.dirCommandNames.begin()
-                        ; it != _settings.dirCommandNames.end(); ++it )
+   for ( QStringList::const_iterator it = _settings.dirCommandNames.constBegin()
+                        ; it != _settings.dirCommandNames.constEnd(); ++it )
    {
       _dirCommandsMenu->insertItem((*it),counter);
       counter++;
@@ -2428,8 +2466,8 @@
 
    _fileCommandsMenu->clear();
    counter=0;
-   for ( QStringList::const_iterator it = _settings.fileCommandNames.begin()
-                        ; it != _settings.fileCommandNames.end(); ++it )
+   for ( QStringList::const_iterator it = _settings.fileCommandNames.constBegin()
+                        ; it != _settings.fileCommandNames.constEnd(); ++it )
    {
       _fileCommandsMenu->insertItem((*it),counter);
       counter++;
@@ -2560,7 +2598,7 @@
 	QStringList childList = thisItem->allChildrenList();
 
 	QStringList::const_iterator it;
-	for( it = childList.begin();it !=  childList.end(); ++it )
+	for( it = childList.constBegin();it !=  childList.constEnd(); ++it )
     {
 		if(!_fileList.remove((*it)))
 			_dirList.remove((*it));
@@ -2866,7 +2904,7 @@
     {
 	QStringList s = current->allChildrenList(true);
 	QStringList::const_iterator it;
-	for( it = s.begin() ; it != s.end(); ++it )
+	for( it = s.constBegin() ; it != s.constEnd(); ++it )
 	{
 	    CatManListItem *item = _fileList[(*it)];
 	    result.append( item->poFile() );
@@ -2884,7 +2922,7 @@
     QStringList result;
 
     QStringList::const_iterator it;
-    for( it = _markerList.begin() ; it != _markerList.end(); ++it )
+    for( it = _markerList.constBegin() ; it != _markerList.constEnd(); ++it )
     {
 	CatManListItem *item = _fileList[(*it)];
 	result.append( item->poFile() );
@@ -2926,7 +2964,7 @@
 void CatalogManagerView::updateFiles( const QStringList& files )
 {
   QStringList::ConstIterator it;
-  for ( it = files.begin( ); it != files.end( ); ++it ) {
+  for ( it = files.constBegin( ); it != files.constEnd( ); ++it ) {
     updateFile( *it, true );
   }
 }
@@ -2949,7 +2987,7 @@
     {
 	const QStringList s = current->allChildrenList(true);
 	QStringList::const_iterator it;
-	for( it = s.begin() ; it != s.end(); ++it )
+	for( it = s.constBegin() ; it != s.constEnd(); ++it )
 	{
 	    CatManListItem *item = _fileList[(*it)];
 	    if( item && item->hasPo() ) result.append( item->package() );
@@ -2976,8 +3014,8 @@
 
     if( !t )
     {
-	KMessageBox::error( this, i18n("Can not instantiate a validation tool.\n"
-	"Please, check your installation."), i18n("Validation Tool Error") );
+	KMessageBox::error( this, i18n("Cannot instantiate a validation tool.\n"
+	"Please check your installation."), i18n("Validation Tool Error") );
 	return;
     }
 
@@ -3046,7 +3084,7 @@
 {
     QStringList newMarkers;
 
-    for( QStringList::const_iterator it = _markerList.begin(); it != _markerList.end(); ++it ) {
+    for( QStringList::const_iterator it = _markerList.constBegin(); it != _markerList.constEnd(); ++it ) {
         if( _fileList[ (*it) ] )
 	    newMarkers.append( (*it) );
     }
Index: kbabel/catalogmanager/validateprogress.cpp
===================================================================
--- kbabel/catalogmanager/validateprogress.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/catalogmanager/validateprogress.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -96,7 +96,7 @@
     if( !t )
     {
 	KMessageBox::error( this, i18n("Cannot instantiate a validation tool.\n"
-	"Please, check your installation."), i18n("Validation Tool Error") );
+	"Please check your installation."), i18n("Validation Tool Error") );
 	return;
     }
 
Index: kbabel/filters/gettext/kbabel_gettext_import.desktop
===================================================================
--- kbabel/filters/gettext/kbabel_gettext_import.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/filters/gettext/kbabel_gettext_import.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -37,7 +37,6 @@
 Name[tg]=Филтри воридоти хабарҳо GNU Gettext
 Name[tr]=KBabel GNU Gettext İçe Aktarma Süzgeci
 Name[uk]=Фільтр імпорту GNU Gettext для KBabel
-Name[xx]=xxKBabel GNU Gettext Import Filterxx
 Name[zh_CN]=KBabel GNU Gettext 导入过滤器
 X-KDE-Library=kbabel_gettextimport
 X-KDE-Import=application/x-gettext
Index: kbabel/filters/gettext/kbabel_gettext_export.desktop
===================================================================
--- kbabel/filters/gettext/kbabel_gettext_export.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/filters/gettext/kbabel_gettext_export.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -37,7 +37,6 @@
 Name[tg]=Филтри содироти хабарҳо GNU Gettext
 Name[tr]=KBabel GNU Gettext Dışa Aktarma Süzgeci
 Name[uk]=Фільтр експорту GNU Gettext для KBabel
-Name[xx]=xxKBabel GNU Gettext Export Filterxx
 Name[zh_CN]=KBabel GNU Gettext 导出过滤器
 X-KDE-Library=kbabel_gettextexport
 X-KDE-Export=application/x-gettext
Index: kbabel/filters/xliff/kbabel_xliff_export.desktop
===================================================================
--- kbabel/filters/xliff/kbabel_xliff_export.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/filters/xliff/kbabel_xliff_export.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -31,7 +31,6 @@
 Name[sv]=Kbabel exportfilter för XLIFF
 Name[tr]=KBabel XLIFF Dışa Aktarma Süzgeci
 Name[uk]=Фільтр експорту XLIFF для KBabel
-Name[xx]=xxKBabel XLIFF Export Filterxx
 Name[zh_CN]=KBabel XLIFF 导出过滤器
 X-KDE-Library=kbabel_xliffexport
 X-KDE-Export=application/x-xliff
Index: kbabel/filters/xliff/kbabel_xliff_import.desktop
===================================================================
--- kbabel/filters/xliff/kbabel_xliff_import.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/filters/xliff/kbabel_xliff_import.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -31,7 +31,6 @@
 Name[sv]=Kbabel importfilter för XLIFF
 Name[tr]=KBabel XLIFF İçe Aktarma Süzgeci
 Name[uk]=Фільтр імпорту XLIFF для KBabel
-Name[xx]=xxKBabel XLIFF Import Filterxx
 Name[zh_CN]=KBabel XLIFF 导入过滤器
 X-KDE-Library=kbabel_xliffimport
 X-KDE-Import=application/x-xliff
Index: kbabel/filters/linguist/kbabel_linguist_import.desktop
===================================================================
--- kbabel/filters/linguist/kbabel_linguist_import.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/filters/linguist/kbabel_linguist_import.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -38,7 +38,6 @@
 Name[tg]=Филтри воридоти хабарҳои лингвистӣ
 Name[tr]=KBabel Linguist İçe Aktarma Süzgeci
 Name[uk]=Фільтр імпорту Linguist для KBabel
-Name[xx]=xxKBabel Linguist Import Filterxx
 Name[zh_CN]=KBabel Linguist 导入过滤器
 X-KDE-Library=kbabel_linguistimport
 X-KDE-Import=application/x-linguist
Index: kbabel/filters/linguist/kbabel_linguist_export.desktop
===================================================================
--- kbabel/filters/linguist/kbabel_linguist_export.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/filters/linguist/kbabel_linguist_export.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -38,7 +38,6 @@
 Name[tg]=Филтри содироти хабарҳои лингвистӣ
 Name[tr]=KBabel Linguist Dışa Aktarma Süzgeci
 Name[uk]=Фільтр експорту Linguist для KBabel
-Name[xx]=xxKBabel Linguist Export Filterxx
 Name[zh_CN]=KBabel Linguist 导出过滤器
 X-KDE-Library=kbabel_linguistexport
 X-KDE-Export=application/x-linguist
Index: kbabel/addons/preview/pothumbnail.desktop
===================================================================
--- kbabel/addons/preview/pothumbnail.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/addons/preview/pothumbnail.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -55,7 +55,6 @@
 Name[ven]=Khathalogo dza mulaedza
 Name[vi]=Mục lục các thông điệp 
 Name[xh]=Umyalezo wemifanekiso esencwadini
-Name[xx]=xxMessage Catalogsxx
 Name[zh_CN]=消息目录
 Name[zh_TW]=訊息類別
 Name[zu]=Umyalezo Wemifanekiso esencwadini
Index: kbabel/addons/kfile-plugins/kfile_po.desktop
===================================================================
--- kbabel/addons/kfile-plugins/kfile_po.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbabel/addons/kfile-plugins/kfile_po.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -47,7 +47,6 @@
 Name[tr]=Katalog Bilgisi
 Name[uk]=Інформація каталогу
 Name[xh]=Ulwazi Lwencwadi yemifanekiso
-Name[xx]=xxCatalog Informationxx
 Name[zh_CN]=目录信息
 Name[zh_TW]=類別資訊
 ServiceTypes=KFilePlugin
Index: umbrello/uml.directory
===================================================================
--- umbrello/uml.directory	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/uml.directory	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1,335 +0,0 @@
-[IconPosition::.deps]
-X=28
-Y=5
-
-[IconPosition::.kdbgrc.uml]
-X=360
-Y=7
-
-[IconPosition::Makefile]
-X=194
-Y=437
-
-[IconPosition::Makefile.am]
-X=272
-Y=437
-
-[IconPosition::Makefile.in]
-X=362
-Y=437
-
-[IconPosition::actor.cpp]
-X=453
-Y=5
-
-[IconPosition::actor.h]
-X=547
-Y=5
-
-[IconPosition::actorwidget.cpp]
-X=7
-Y=77
-
-[IconPosition::actorwidget.h]
-X=94
-Y=77
-
-[IconPosition::association.cpp]
-X=181
-Y=77
-
-[IconPosition::association.h]
-X=268
-Y=77
-
-[IconPosition::assocpage.cpp]
-X=356
-Y=77
-
-[IconPosition::assocpage.h]
-X=443
-Y=77
-
-[IconPosition::assocpropdlg.cpp]
-X=528
-Y=77
-
-[IconPosition::assocpropdlg.h]
-X=6
-Y=149
-
-[IconPosition::attribute.cpp]
-X=97
-Y=149
-
-[IconPosition::attribute.h]
-X=191
-Y=149
-
-[IconPosition::classattpage.cpp]
-X=268
-Y=149
-
-[IconPosition::classattpage.h]
-X=355
-Y=149
-
-[IconPosition::classgenpage.cpp]
-X=443
-Y=149
-
-[IconPosition::classgenpage.h]
-X=530
-Y=149
-
-[IconPosition::classopspage.cpp]
-X=9
-Y=221
-
-[IconPosition::classopspage.h]
-X=96
-Y=221
-
-[IconPosition::classoptionspage.cpp]
-X=180
-Y=221
-
-[IconPosition::classoptionspage.h]
-X=267
-Y=221
-
-[IconPosition::classpropdlg.cpp]
-X=355
-Y=221
-
-[IconPosition::classpropdlg.h]
-X=442
-Y=221
-
-[IconPosition::concept.cpp]
-X=531
-Y=221
-
-[IconPosition::concept.h]
-X=16
-Y=293
-
-[IconPosition::conceptwidget.cpp]
-X=95
-Y=293
-
-[IconPosition::conceptwidget.h]
-X=182
-Y=293
-
-[IconPosition::diagramprintpage.cpp]
-X=267
-Y=293
-
-[IconPosition::diagramprintpage.h]
-X=354
-Y=293
-
-[IconPosition::floatingtext.cpp]
-X=441
-Y=293
-
-[IconPosition::floatingtext.h]
-X=531
-Y=293
-
-[IconPosition::hi16-app-uml.png]
-X=7
-Y=365
-
-[IconPosition::hi32-app-uml.png]
-X=94
-Y=365
-
-[IconPosition::infowidget.cpp]
-X=181
-Y=365
-
-[IconPosition::infowidget.h]
-X=272
-Y=365
-
-[IconPosition::listpopupmenu.cpp]
-X=355
-Y=365
-
-[IconPosition::listpopupmenu.h]
-X=442
-Y=365
-
-[IconPosition::lo16-app-uml.png]
-X=529
-Y=365
-
-[IconPosition::lo32-app-uml.png]
-X=7
-Y=437
-
-[IconPosition::main.cpp]
-X=106
-Y=437
-
-[IconPosition::messagewidget.cpp]
-X=441
-Y=437
-
-[IconPosition::messagewidget.h]
-X=528
-Y=437
-
-[IconPosition::mylistview.cpp]
-X=7
-Y=509
-
-[IconPosition::mylistview.h]
-X=97
-Y=509
-
-[IconPosition::mylistviewitem.cpp]
-X=183
-Y=509
-
-[IconPosition::mylistviewitem.h]
-X=270
-Y=509
-
-[IconPosition::notemultilineedit.cpp]
-X=354
-Y=509
-
-[IconPosition::notemultilineedit.h]
-X=441
-Y=509
-
-[IconPosition::notewidget.cpp]
-X=531
-Y=509
-
-[IconPosition::notewidget.h]
-X=9
-Y=581
-
-[IconPosition::objectwidget.cpp]
-X=94
-Y=581
-
-[IconPosition::objectwidget.h]
-X=181
-Y=581
-
-[IconPosition::operation.cpp]
-X=267
-Y=581
-
-[IconPosition::operation.h]
-X=361
-Y=581
-
-[IconPosition::ot.h]
-X=463
-Y=581
-
-[IconPosition::parmpropdlg.cpp]
-X=530
-Y=581
-
-[IconPosition::parmpropdlg.h]
-X=8
-Y=653
-
-[IconPosition::pics]
-X=115
-Y=5
-
-[IconPosition::pixmaps]
-X=195
-Y=5
-
-[IconPosition::selectopdlg.cpp]
-X=94
-Y=653
-
-[IconPosition::selectopdlg.h]
-X=181
-Y=653
-
-[IconPosition::templates]
-X=279
-Y=5
-
-[IconPosition::uml.cpp]
-X=283
-Y=653
-
-[IconPosition::uml.desktop]
-X=359
-Y=655
-
-[IconPosition::uml.h]
-X=463
-Y=653
-
-[IconPosition::umldoc.cpp]
-X=534
-Y=653
-
-[IconPosition::umldoc.h]
-X=19
-Y=725
-
-[IconPosition::umlobject.cpp]
-X=96
-Y=725
-
-[IconPosition::umlobject.h]
-X=186
-Y=725
-
-[IconPosition::umlui.rc]
-X=283
-Y=725
-
-[IconPosition::umlview.cpp]
-X=357
-Y=725
-
-[IconPosition::umlview.h]
-X=451
-Y=725
-
-[IconPosition::umlwidget.cpp]
-X=530
-Y=725
-
-[IconPosition::umlwidget.h]
-X=11
-Y=797
-
-[IconPosition::usecase.cpp]
-X=95
-Y=797
-
-[IconPosition::usecasewidget.cpp]
-X=268
-Y=797
-
-[IconPosition::usecasewidget.h]
-X=355
-Y=797
-
-[IconPosition::worktoolbar.cpp]
-X=442
-Y=797
-
-[IconPosition::worktoolbar.h]
-X=529
-Y=797
-
-[IconPosition::x-uml.desktop]
-X=6
-Y=869
Index: umbrello/umbrello/classifier.cpp
===================================================================
--- umbrello/umbrello/classifier.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/classifier.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -775,7 +775,7 @@
             genElement.appendChild(gElem);
         }
         if (genElement.hasChildNodes())
-            qElement.appendChild( genElement );
+            classifierElement.appendChild( genElement );
     }
 
     // save attributes
Index: umbrello/umbrello/umbrello.desktop
===================================================================
--- umbrello/umbrello/umbrello.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umbrello.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -9,7 +9,6 @@
 Name=Umbrello
 Name[hi]=अम्बरैलो
 Name[ta]=  அம்ரல்லோ
-Name[xx]=xxUmbrelloxx
 GenericName=UML Modeller
 GenericName[bs]=UML modeler
 GenericName[ca]=Modelador UML
@@ -42,7 +41,6 @@
 GenericName[tg]=Воситаи UML моделкунонӣ
 GenericName[tr]=UML Modelleyici
 GenericName[uk]=Засіб моделювання UML
-GenericName[xx]=xxUML Modellerxx
 GenericName[zh_CN]=UML 建模工具
 MimeType=application/x-uml
 Categories=Qt;KDE;Development;
Index: umbrello/umbrello/model_utils.cpp
===================================================================
--- umbrello/umbrello/model_utils.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/model_utils.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -346,13 +346,12 @@
     if (pos == -1)
         return PS_Illegal_MethodName;
     desc.m_name = pat.cap(1);
-    // Remove possible empty parentheses ()
-    m.remove( QRegExp("\\s*\\(\\s*\\)") );
     desc.m_pReturnType = NULL;
-    pat = QRegExp( ":\\s*(\\w[\\w\\. ]*)$" );
+    pat = QRegExp("\\) *:(.*)$");
     pos = pat.search(m);
     if (pos != -1) {  // return type is optional
         QString retType = pat.cap(1);
+        retType = retType.stripWhiteSpace();
         if (retType != "void") {
             UMLObject *pRetType = owningScope->findTemplate(retType);
             if (pRetType == NULL) {
@@ -363,6 +362,8 @@
             desc.m_pReturnType = pRetType;
         }
     }
+    // Remove possible empty parentheses ()
+    m.remove( QRegExp("\\s*\\(\\s*\\)") );
     desc.m_args.clear();
     pat = QRegExp( "\\((.*)\\)" );
     pos = pat.search(m);
Index: umbrello/umbrello/javaimport.h
===================================================================
--- umbrello/umbrello/javaimport.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 0)
+++ umbrello/umbrello/javaimport.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -0,0 +1,43 @@
+#ifndef JAVAIMPORT_H
+#define JAVAIMPORT_H
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ *  copyright (C) 2006                                                     *
+ *  Umbrello UML Modeller Authors <uml-devel@ uml.sf.net>                  *
+ ***************************************************************************/
+
+#include "nativeimportbase.h"
+
+/**
+ * Java code import
+ * @author Oliver Kellogg
+ * Bugs and comments to uml-devel@lists.sf.net or http://bugs.kde.org
+ */
+class JavaImport : public NativeImportBase {
+public:
+    JavaImport();
+    virtual ~JavaImport();
+
+    /**
+     * Implement abstract operation from NativeImportBase.
+     */
+    void parseFile(QString file);
+
+    /**
+     * Implement abstract operation from NativeImportBase.
+     */
+    void fillSource(QString word);
+
+protected:
+    QString joinTypename();
+    bool m_isStatic;
+};
+
+#endif
+

Property changes on: umbrello/umbrello/javaimport.h
___________________________________________________________________
Name: svn:executable
   + *

Index: umbrello/umbrello/umlrole.cpp
===================================================================
--- umbrello/umbrello/umlrole.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umlrole.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -55,14 +55,6 @@
     return m_Multi;
 }
 
-QString UMLRole::getName() const {
-    return m_Name;
-}
-
-QString UMLRole::getDoc() const {
-    return m_Doc;
-}
-
 void UMLRole::setObject (UMLObject *obj) {
     // because we will get the id of this role from the parent
     // object, we CANT allow UMLRoles to take other UMLRoles as
@@ -89,16 +81,6 @@
     emit modified();
 }
 
-void UMLRole::setName( const QString &roleName ) {
-    m_Name = roleName;
-    emit modified();
-}
-
-void UMLRole::setDoc( const QString &doc ) {
-    m_Doc = doc;
-    emit modified();
-}
-
 Uml::Role_Type UMLRole::getRole() {
     return m_role;
 }
@@ -294,15 +276,17 @@
     // the component roles/linked items needs to be done in order to get things
     // right. *sigh* -b.t.
 
-    if (m_role == Uml::A) {  // setting association type from the role (A)
-        QString aggregation = element.attribute("aggregation", "none");
-        if (aggregation == "composite")
-            m_pAssoc->setAssocType(Uml::at_Composition);
-        else if (aggregation == "shared")
-            m_pAssoc->setAssocType(Uml::at_Aggregation);
-        /* else
-                m_pAssoc->setAssocType(Uml::at_Association);  */
-    }
+    // Setting association type from the role (A)
+    // Determination of the "aggregation" attribute used to be done only
+    // when (m_role == Uml::A) but some XMI writers (e.g. StarUML) place
+    // the aggregation attribute at role B.
+    // The role end with the aggregation unequal to "none" wins.
+    QString aggregation = element.attribute("aggregation", "none");
+    if (aggregation == "composite")
+        m_pAssoc->setAssocType(Uml::at_Composition);
+    else if (aggregation == "shared"       // UML1.3
+          || aggregation == "aggregate")   // UML1.4
+        m_pAssoc->setAssocType(Uml::at_Aggregation);
 
     if (!element.hasAttribute("isNavigable")) {
         /* Backward compatibility mode: In Umbrello version 1.3.x the
Index: umbrello/umbrello/associationwidget.cpp
===================================================================
--- umbrello/umbrello/associationwidget.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/associationwidget.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1562,13 +1562,13 @@
     /*
       the distance D between points (x2, y2) and (x3, y3) has the following formula:
 
-           ---     ------------------------------
-      D =     \   /        2         2
-           \ /   (x3 - x2)  +  (y3 - y2)
+          ---     ------------------------------
+      D =    \   /         2             2
+              \ / (x3 - x2)  +  (y3 - y2)
 
       D, x2 and y2 are known and line P2P3 is perpendicular to line (x1,y1)(x2,y2), so if the
       line P1P2 has the formula y = m*x + b,
-      then        (x1 - x2)
+      then      (x1 - x2)
           m =  -----------    , because it is perpendicular to line P1P2
                 (y2 - y1)
 
@@ -1577,28 +1577,28 @@
 
       then P3 = (x3, m*x3 + b)
 
-       2             2      2
+       2            2            2
       D  = (x3 - x2)  + (y3 - y2)
 
-       2     2           2      2                2
-      D  = x3    - 2*x3*x2 + x2   + y3   - 2*y3*y2  + y2
+       2     2               2     2               2
+      D  = x3  - 2*x3*x2 + x2  + y3  - 2*y3*y2 + y2
 
-       2       2       2       2                  2
-      D    - x2    - y2    = x3    - 2*x3*x2  + y3   - 2*y3*y2
+       2     2     2     2               2
+      D  - x2  - y2  = x3  - 2*x3*x2 + y3  - 2*y3*y2
 
 
 
-       2       2       2       2                          2
-      D    - x2    - y2    = x3    - 2*x3*x2  + (m*x3 + b)  - 2*(m*x3 + b)*y2
+       2     2     2     2                       2
+      D  - x2  - y2  = x3  - 2*x3*x2 + (m*x3 + b)  - 2*(m*x3 + b)*y2
 
-       2       2       2                2       2       2
-      D    - x2    - y2     + 2*b*y2 - b   =  (m  + 1)*x3     + (-2*x2 + 2*m*b -2*m*y2)*x3
+       2     2     2                   2        2       2
+      D  - x2  - y2  + 2*b*y2 - b  = (m  + 1)*x3  + (-2*x2 + 2*m*b -2*m*y2)*x3
 
-       2      2       2       2
+              2       2       2              2
       C  = - D    + x2    + y2   - 2*b*y2 + b
 
-       2
-      A  = (m    + 1)
+             2
+      A  = (m  + 1)
 
       B  = (-2*x2 + 2*m*b -2*m*y2)
 
@@ -1607,37 +1607,37 @@
       A * x3 + B * x3 - C = 0
 
 
-                         ---------------
-             -B +  ---  /  2
-                      \/  B   - 4*A*C
-      sol_1  = --------------------------------
-                       2*A
+                           ---------------
+                     ---  /  2
+                -B +    \/  B   - 4*A*C
+      sol_1 = --------------------------------
+                        2*A
 
 
-                         ---------------
-      sol_2  =   -B -  ---  /  2
-                      \/  B   - 4*A*C
-           --------------------------------
-                       2*A
+                           ---------------
+                     ---  /  2
+                -B -    \/  B   - 4*A*C
+      sol_2 = --------------------------------
+                        2*A
 
       then in the distance formula we have only one variable x3 and that is easy
       to calculate
     */
-    int x1 = P1.y();
-    int y1 = P1.x();
-    int x2 = P2.y();
-    int y2 = P2.x();
+    if (P1.x() == P2.x()) {
+        return QPoint((int)(P2.x() + Distance), P2.y());
+    }
+    const int x1 = P1.y();
+    const int y1 = P1.x();
+    const int x2 = P2.y();
+    const int y2 = P2.x();
 
-    if(x2 == x1) {
-        return QPoint((int)(x2+ Distance), y2);
-    }
     float slope = ((float)x1 - (float)x2) / ((float)y2 - (float)y1);
     float b = (y2 - slope*x2);
     float A = (slope * slope) + 1;
-    float B = (2*slope*b) - (2*x2)  - (2*slope*y2);
+    float B = (2*slope*b) - (2*x2) - (2*slope*y2);
     float C = (b*b) - (Distance*Distance) + (x2*x2) + (y2*y2) - (2*b*y2);
     float t = B*B - 4*A*C;
-    if(t < 0) {
+    if (t < 0) {
         return QPoint(-1, -1);
     }
     float sol_1 = ((-1* B) + sqrt(t) ) / (2*A);
@@ -1799,63 +1799,66 @@
 
     if (text) {
         constrainTextPos(x, y, textW, textH, role);
-        if (x != p.x() || y != p.y()) {
-            // kdDebug() << "AssociationWidget::calculateTextPosition(" 
-            //   << text->getName() << ") textrole " << role
-            //   << ": oldpoint=(" << p.x() << "," << p.y() << ")"
-            //   << ", newPoint=(" << x << "," << y << ")" << endl;
-            text->setX(x);
-            text->setY(y);
-        }
     }
     p = QPoint( x, y );
     return p;
 }
 
+QPoint AssociationWidget::midPoint(QPoint p0, QPoint p1) {
+    QPoint midP;
+    if (p0.x() < p1.x())
+        midP.setX(p0.x() + (p1.x() - p0.x()) / 2);
+    else
+        midP.setX(p1.x() + (p0.x() - p1.x()) / 2);
+    if (p0.y() < p1.y())
+        midP.setY(p0.y() + (p1.y() - p0.y()) / 2);
+    else
+        midP.setY(p1.y() + (p0.y() - p1.y()) / 2);
+    return midP;
+}
+
 void AssociationWidget::constrainTextPos(int &textX, int &textY,
                                          int textWidth, int textHeight,
                                          Uml::Text_Role tr) {
-    const int CORRIDOR_HALFWIDTH = 30;
+    const int textCenterX = textX + textWidth / 2;
+    const int textCenterY = textY + textHeight / 2;
     const uint lastSegment = m_LinePath.count() - 1;
     QPoint p0, p1;
-    bool atSideA = false, atSideB = false;
     switch (tr) {
         case tr_RoleAName:
         case tr_MultiA:
         case tr_ChangeA:
             p0 = m_LinePath.getPoint(0);
             p1 = m_LinePath.getPoint(1);
-            atSideA = true;
+            // If we are dealing with a single line then tie the
+            // role label to the proper half of the line, i.e.
+            // the role label must be closer to the "other"
+            // role object.
+            if (lastSegment == 1)
+                p1 = midPoint(p0, p1);
             break;
         case tr_RoleBName:
         case tr_MultiB:
         case tr_ChangeB:
             p0 = m_LinePath.getPoint(lastSegment - 1);
             p1 = m_LinePath.getPoint(lastSegment);
-            atSideB = true;
+            if (lastSegment == 1)
+                p0 = midPoint(p0, p1);
             break;
         case tr_Name:
+        case tr_Coll_Message:  // CHECK: collab.msg texts seem to be tr_Name
+        case tr_State:         // CHECK: is this used?
             // Find the linepath segment to which the (textX,textY) is closest
             // and constrain to the corridor of that segment (see farther below)
             {
-                const int textCenterX = textX + textWidth / 2;
-                const int textCenterY = textY + textHeight / 2;
                 int minDistSquare = 100000;  // utopian initial value
                 int lpIndex = 0;
                 for (uint i = 0; i < lastSegment; i++) {
                     p0 = m_LinePath.getPoint(i);
                     p1 = m_LinePath.getPoint(i + 1);
-                    QPoint midPoint;
-                    if (p0.x() < p1.x())
-                        midPoint.setX(p0.x() + (p1.x() - p0.x()) / 2);
-                    else
-                        midPoint.setX(p1.x() + (p0.x() - p1.x()) / 2);
-                    if (p0.y() < p1.y())
-                        midPoint.setY(p0.y() + (p1.y() - p0.y()) / 2);
-                    else
-                        midPoint.setY(p1.y() + (p0.y() - p1.y()) / 2);
-                    const int deltaX = textCenterX - midPoint.x();
-                    const int deltaY = textCenterY - midPoint.y();
+                    QPoint midP = midPoint(p0, p1);
+                    const int deltaX = textCenterX - midP.x();
+                    const int deltaY = textCenterY - midP.y();
                     const int cSquare = deltaX * deltaX + deltaY * deltaY;
                     if (cSquare < minDistSquare) {
                         minDistSquare = cSquare;
@@ -1872,85 +1875,85 @@
             return;
             break;
     }
-    if (p0.x() >= p1.x() - 1 && p0.x() <= p1.x() + 1) {
-        // vertical line
-        // CAUTION: This is calculated in Qt coordinates!
-        ////////////////////////// constrain horizontally /////////////////////////
-        const int lineX = p0.x();
-        if (textX + textWidth < lineX - CORRIDOR_HALFWIDTH)  // constrain at left
-            textX = lineX - CORRIDOR_HALFWIDTH - textWidth;
-        else if (textX > lineX + CORRIDOR_HALFWIDTH)         // constrain at right
-            textX = lineX + CORRIDOR_HALFWIDTH;
-        ////////////////////////// constrain vertically ///////////////////////////
-        // pre-constrain the corridor to the appropriate half:
-        // This is only done for simple (i.e. non multi-segment) linepaths.
-        // With multi-segment linepaths, the user probably wants the freedom to
-        // place role related labels anywhere within the start and end segment.
-        if (lastSegment == 1) {
-            if (atSideA) {
-                if (p0.y() < p1.y())
-                    p1.setY(p0.y() + (p1.y() - p0.y()) / 2);
-                else
-                    p1.setY(p0.y() - (p0.y() - p1.y()) / 2);
-            } else if (atSideB) {
-                if (p0.y() > p1.y())
-                    p0.setY(p1.y() + (p0.y() - p1.y()) / 2);
-                else
-                    p0.setY(p1.y() - (p1.y() - p0.y()) / 2);
-            }
-        }
-        // swap points so that p0 contains the one with the smaller Y
-        if (p0.y() > p1.y()) {
-            QPoint tmp = p0;
-            p0 = p1;
-            p1 = tmp;
-        }
-        if (textY + textHeight < p0.y())  // constrain at top
-            textY = p0.y() - textHeight;
-        else if (textY > p1.y())          // constrain at bottom
-            textY = p1.y();
+    /* Constraint:
+       The midpoint between p0 and p1 is taken to be the center of a circle
+       with radius D/2 where D is the distance between p0 and p1.
+       The text center needs to be within this circle else it is constrained
+       to the nearest point on the circle.
+     */
+    p0 = swapXY(p0);    // go to the natural coordinate system
+    p1 = swapXY(p1);    // with (0,0) in the lower left corner
+    QPoint midP = midPoint(p0, p1);
+    // If (textX,textY) is not inside the circle around midP then
+    // constrain (textX,textY) to the nearest point on that circle.
+    const int x0 = p0.x();
+    const int y0 = p0.y();
+    const int x1 = p1.x();
+    const int y1 = p1.y();
+    double r = sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0)) / 2;
+    if (textWidth > r)
+        r = textWidth;
+    // swap textCenter{X,Y} to convert from Qt coord.system.
+    const QPoint origTextCenter(textCenterY, textCenterX);
+    const int relX = abs(origTextCenter.x() - midP.x());
+    const int relY = abs(origTextCenter.y() - midP.y());
+    const double negativeWhenInsideCircle = relX * relX + relY * relY - r * r;
+    if (negativeWhenInsideCircle <= 0.0) {
         return;
     }
-    if (p0.y() >= p1.y() - 1 && p0.y() <= p1.y() + 1) {
-        // horizontal line
-        // CAUTION: This is calculated in Qt coordinates!
-        ////////////////////////// constrain vertically /////////////////////////////
-        const int lineY = p0.y();
-        if (textY + textHeight < lineY - CORRIDOR_HALFWIDTH)  // constrain at top
-            textY = lineY - CORRIDOR_HALFWIDTH - textHeight;
-        else if (textY > lineY + CORRIDOR_HALFWIDTH)          // constrain at bottom
-            textY = lineY + CORRIDOR_HALFWIDTH;
-        ////////////////////////// constrain horizontally //////////////////////////
-        // pre-constrain the corridor to the appropriate half:
-        // This is only done for simple (i.e. non multi-segment) linepaths.
-        // With multi-segment linepaths, the user probably wants the freedom to
-        // place role related labels anywhere within the start and end segment.
-        if (lastSegment == 1) {
-            if (atSideA) {
-                if (p0.x() < p1.x())
-                    p1.setX(p0.x() + (p1.x() - p0.x()) / 2);
-                else
-                    p1.setX(p0.x() - (p0.x() - p1.x()) / 2);
-            } else if (atSideB) {
-                if (p0.x() < p1.x())
-                    p0.setX(p1.x() - (p1.x() - p0.x()) / 2);
-                else
-                    p0.setX(p1.x() + (p0.x() - p1.x()) / 2);
-            }
-        }
-        // swap points so that p0 contains the one with the smaller X
-        if (p0.x() > p1.x()) {
-            QPoint tmp = p0;
-            p0 = p1;
-            p1 = tmp;
-        }
-        if (textX + textWidth < p0.x())   // constrain at left
-            textX = p0.x() - textWidth;
-        else if (textX > p1.x())          // constrain at right
-            textX = p1.x();
+    /*
+     The original constraint was to snap the text position to the
+     midpoint but that creates unpleasant visual jitter:
+    textX = midP.y() - textWidth / 2;   // go back to Qt coord.sys.
+    textY = midP.x() - textHeight / 2;  // go back to Qt coord.sys.
+
+     Rather, we project the text position onto the closest point
+     on the circle:
+
+     Circle equation:
+       relX^2 + relY^2 - r^2 = 0   , or in other words
+       relY^2 = r^2 - relX^2       , or
+       relY = sqrt(r^2 - relX^2)
+     Line equation:
+       relY = a * relX + b
+         We can omit "b" because relX and relY are already relative to
+         the circle origin, therefore we can also write:
+       a = relY / relX
+     To obtain the point of intersection between the circle of radius r
+     and the line connecting the circle origin with the point (relX, relY),
+     we equate the relY:
+       a * x = sqrt(r^2 - x^2)     , or in other words
+       a^2 * x^2 = r^2 - x^2       , or
+       x^2 * (a^2 + 1) = r^2       , or
+       x^2 = r^2 / (a^2 + 1)       , or
+       x = sqrt(r^2 / (a^2 + 1))
+     and then
+       y = a * x
+     The resulting x and y are relative to the circle origin so we just add
+     the circle origin (X,Y) to obtain the constrained (textX,textY).
+     */
+    // Handle the special case, relX = 0.
+    if (relX == 0) {
+        if (origTextCenter.y() > midP.y())
+            textX = midP.y() + (int)r;   // go back to Qt coord.sys.
+        else
+            textX = midP.y() - (int)r;   // go back to Qt coord.sys.
+        textX -= textWidth / 2;
         return;
     }
-    // @todo deal with slopes
+    const double a = (double)relY / (double)relX;
+    const double x = sqrt(r*r / (a*a + 1));
+    const double y = a * x;
+    if (origTextCenter.x() > midP.x())
+        textY = midP.x() + (int)x;   // go back to Qt coord.sys.
+    else
+        textY = midP.x() - (int)x;   // go back to Qt coord.sys.
+    textY -= textHeight / 2;
+    if (origTextCenter.y() > midP.y())
+        textX = midP.y() + (int)y;   // go back to Qt coord.sys.
+    else
+        textX = midP.y() - (int)y;   // go back to Qt coord.sys.
+    textX -= textWidth / 2;
 }
 
 void AssociationWidget::calculateNameTextSegment() {
Index: umbrello/umbrello/umlwidget.cpp
===================================================================
--- umbrello/umbrello/umlwidget.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umlwidget.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -103,6 +103,7 @@
     m_pObject = other.m_pObject;
     m_pView = other.m_pView;
     m_pMenu = other.m_pMenu;
+    m_bResizable = other.m_bResizable;
     m_bResizing = other.m_bResizing;
     m_nPressOffsetX = other.m_nPressOffsetX;
     m_nPressOffsetY = other.m_nPressOffsetY;
@@ -344,8 +345,9 @@
     m_nOldH = height();
     const int m = 10;
     //see if clicked on bottom right corner
-    if( (m_nOldX + m_nPressOffsetX) >= (getX() + width() - m) &&
-        (m_nOldY + m_nPressOffsetY) >= (getY() + height() - m) && me->button() == Qt::LeftButton) {
+    if( m_bResizable && me->button() == Qt::LeftButton &&
+        (m_nOldX + m_nPressOffsetX) >= (getX() + width() - m) &&
+        (m_nOldY + m_nPressOffsetY) >= (getY() + height() - m)) {
         m_bResizing = true;
         m_pView->setCursor(WidgetBase::m_Type == Uml::wt_Message ?
                            KCursor::sizeVerCursor() : KCursor::sizeFDiagCursor());
@@ -446,6 +448,7 @@
     for (int i = 0; i < (int)FT_INVALID; ++i)
         m_pFontMetrics[(UMLWidget::FontType)i] = 0;
 
+    m_bResizable = true;
     m_bResizing = false;
     m_bMouseOver = false;
 
@@ -675,7 +678,7 @@
     update();
 }
 
-void UMLWidget::drawSelected(QPainter * p, int offsetX, int offsetY, bool resizeable) {
+void UMLWidget::drawSelected(QPainter * p, int offsetX, int offsetY) {
     int w = width();
     int h = height();
     int s = 4;
@@ -685,7 +688,7 @@
     p -> fillRect(offsetX + w - s, offsetY, s, s, brush);
 
     // Draw the resize anchor in the lower right corner.
-    if (resizeable) {
+    if (m_bResizable) {
         brush.setColor(Qt::red);
         const int right = offsetX + w;
         const int bottom = offsetY + h;
Index: umbrello/umbrello/classparser/cpptree2uml.cpp
===================================================================
--- umbrello/umbrello/classparser/cpptree2uml.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/classparser/cpptree2uml.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -406,7 +406,7 @@
     QString text = typeSpec->text();
     kdDebug() << "CppTree2Uml::parseElaboratedTypeSpecifier: text is " << text << endl;
     text.remove(QRegExp("^class\\s+"));
-    UMLObject *o = Import_Utils::createUMLObject( Uml::ot_Class, text );
+    UMLObject *o = Import_Utils::createUMLObject(Uml::ot_Class, text, m_currentNamespace[m_nsCnt]);
     flushTemplateParams( static_cast<UMLClassifier*>(o) );
 }
 
Index: umbrello/umbrello/floatingtext.cpp
===================================================================
--- umbrello/umbrello/floatingtext.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/floatingtext.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -57,6 +57,7 @@
     m_Type = Uml::wt_Text;
     // initialize non-saved (i.e. volatile) data
     m_pLink = NULL;
+    UMLWidget::m_bResizable = false;
 }
 
 FloatingText::~FloatingText() {
Index: umbrello/umbrello/forkjoinwidget.cpp
===================================================================
--- umbrello/umbrello/forkjoinwidget.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/forkjoinwidget.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -52,11 +52,7 @@
     }
 }
 
-void ForkJoinWidget::drawSelected(QPainter * p, int offsetX, int offsetY, bool resizeable) {
-    if (! resizeable) {
-        UMLWidget::drawSelected(p, offsetX, offsetY, false);
-        return;
-    }
+void ForkJoinWidget::drawSelected(QPainter *, int /*offsetX*/, int /*offsetY*/) {
 }
 
 void ForkJoinWidget::constrain(int& width, int& height) {
Index: umbrello/umbrello/messagewidget.cpp
===================================================================
--- umbrello/umbrello/messagewidget.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/messagewidget.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -41,6 +41,7 @@
         y -= m_pOw[Uml::B]->getHeight() / 2;
         m_pOw[Uml::B]->setY(y);
     }
+    UMLWidget::m_bResizable = (m_pOw[Uml::A] == m_pOw[Uml::B]);
 
     calculateWidget();
     y = y < getMinHeight() ? getMinHeight() : y;
@@ -213,7 +214,7 @@
     }
 
     if (m_bSelected)
-        drawSelected(&p, offsetX, offsetY, m_pOw[Uml::A] == m_pOw[Uml::B]);
+        drawSelected(&p, offsetX, offsetY);
 }
 
 void MessageWidget::drawCreation(QPainter& p, int offsetX, int offsetY) {
@@ -242,11 +243,11 @@
     }
 
     if (m_bSelected)
-        drawSelected(&p, offsetX, offsetY, false);
+        drawSelected(&p, offsetX, offsetY);
 }
 
 int MessageWidget::onWidget(const QPoint & p) {
-    if (m_sequenceMessageType == Uml::sequence_message_asynchronous) {
+    if (m_sequenceMessageType != Uml::sequence_message_synchronous) {
         return UMLWidget::onWidget(p);
     }
     // Synchronous message:
@@ -335,7 +336,7 @@
     emit sigMessageMoved();
 }
 
-void MessageWidget::resizeEvent(QResizeEvent */*re*/) {
+void MessageWidget::resizeEvent(QResizeEvent* /*re*/) {
 }
 
 void MessageWidget::calculateWidget() {
@@ -349,12 +350,20 @@
 }
 
 void MessageWidget::slotWidgetMoved(Uml::IDType id) {
-    if(m_pOw[Uml::A] -> getLocalID() == id || m_pOw[Uml::B] -> getLocalID() == id) {
-        m_nY = getY();
-        m_nY = m_nY < getMinHeight()?getMinHeight():m_nY;
-        m_nY = m_nY > getMaxHeight()?getMaxHeight():m_nY;
-        calculateWidget();
+    const Uml::IDType idA = m_pOw[Uml::A]->getLocalID();
+    const Uml::IDType idB = m_pOw[Uml::B]->getLocalID();
+    if (idA != id && idB != id) {
+        kdDebug() << "MessageWidget::slotWidgetMoved(" << ID2STR(id)
+            << "): ignoring for idA=" << ID2STR(idA)
+            << ", idB=" << ID2STR(idB) << endl;
+        return;
     }
+    m_nY = getY();
+    if (m_nY < getMinHeight())
+        m_nY = getMinHeight();
+    if (m_nY > getMaxHeight())
+        m_nY = getMaxHeight();
+    calculateWidget();
     if( !m_pFText )
         return;
     if( m_pView -> getSelectCount() > 1 )
@@ -514,7 +523,7 @@
     int x1 = m_pOw[Uml::A]->getX();
     int x2 = m_pOw[Uml::B]->getX();
     int w1 = m_pOw[Uml::A]->getWidth() / 2;
-    int w2 =  m_pOw[Uml::B]->getWidth() / 2;
+    int w2 = m_pOw[Uml::B]->getWidth() / 2;
     x1 += w1;
     x2 += w2;
 
@@ -546,8 +555,8 @@
 
     int x1 = m_pOw[Uml::A]->getX();
     int x2 = m_pOw[Uml::B]->getX();
-    int w1 = m_pOw[Uml::A] -> getWidth() / 2;
-    int w2 =  m_pOw[Uml::B] -> getWidth() / 2;
+    int w1 = m_pOw[Uml::A]->getWidth() / 2;
+    int w2 = m_pOw[Uml::B]->getWidth() / 2;
     x1 += w1;
     x2 += w2;
 
@@ -579,8 +588,8 @@
 
     int x1 = m_pOw[Uml::A]->getX();
     int x2 = m_pOw[Uml::B]->getX();
-    int w1 = m_pOw[Uml::A] -> getWidth() / 2;
-    int w2 =  m_pOw[Uml::B] -> getWidth();
+    int w1 = m_pOw[Uml::A]->getWidth() / 2;
+    int w2 = m_pOw[Uml::B]->getWidth();
     x1 += w1;
     if (x1 > x2)
         x2 += w2;
@@ -597,6 +606,7 @@
     x += 1;
     widgetWidth -= 2;
     m_nPosX = x;
+    m_nY = m_pOw[Uml::B]->getY() + m_pOw[Uml::B]->getHeight() / 2;
     setSize(widgetWidth, widgetHeight);
 }
 
@@ -725,17 +735,9 @@
     return (height - this->height());
 }
 
-void MessageWidget::mousePressEvent(QMouseEvent* me) {
-    // resize only applies to asynchronous messages between different objects
-    if ( m_sequenceMessageType == Uml::sequence_message_asynchronous &&
-            m_pOw[Uml::A] != m_pOw[Uml::B] ) {
-        return;
-    }
-    UMLWidget::mousePressEvent(me);
-}
-
 void MessageWidget::setWidget(ObjectWidget * ow, Uml::Role_Type role) {
     m_pOw[role] = ow;
+    UMLWidget::m_bResizable = (m_pOw[Uml::A] == m_pOw[Uml::B]);
 }
 
 ObjectWidget* MessageWidget::getWidget(Uml::Role_Type role) {
@@ -803,6 +805,7 @@
         << ID2STR(bId) << " is not an ObjectWidget" << endl;
         return false;
     }
+    UMLWidget::m_bResizable = (m_pOw[Uml::A] == m_pOw[Uml::B]);
 
     UMLClassifier *c = dynamic_cast<UMLClassifier*>( pWB->getUMLObject() );
     if (c) {
Index: umbrello/umbrello/Makefile.am
===================================================================
--- umbrello/umbrello/Makefile.am	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/Makefile.am	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -52,6 +52,7 @@
 idlimport.cpp \
 import_utils.cpp \
 infowidget.cpp \
+javaimport.cpp \
 kstartuplogo.cpp \
 linepath.cpp \
 linkwidget.cpp \
Index: umbrello/umbrello/umlobject.h
===================================================================
--- umbrello/umbrello/umlobject.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umlobject.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -175,7 +175,7 @@
      * Returns an empty string if no stereotype object is set.
      *
      * @param includeAdornments Include surrounding angled brackets
-     *                          "" and "".
+     *                          "«" and "»".
      * @return  Returns the classes stereotype name.
      */
     QString getStereotype(bool includeAdornments = false);
Index: umbrello/umbrello/linepath.cpp
===================================================================
--- umbrello/umbrello/linepath.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/linepath.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -810,15 +810,13 @@
 QColor LinePath::getLineColor() {
     if( !m_pAssociation )
         return Qt::black;
-    UMLView * view =  (UMLView *)m_pAssociation -> parent();
-    return view -> getLineColor();
+    return m_pAssociation -> getLineColor();
 }
 
 uint LinePath::getLineWidth() {
     if( !m_pAssociation )
         return 0;
-    UMLView * view =  (UMLView *)m_pAssociation -> parent();
-    int viewLineWidth = view->getLineWidth();
+    int viewLineWidth = m_pAssociation -> getLineWidth();
     if ( viewLineWidth >= 0 && viewLineWidth <= 10 )
         return viewLineWidth;
     else {
Index: umbrello/umbrello/operation.h
===================================================================
--- umbrello/umbrello/operation.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/operation.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -184,6 +184,16 @@
     bool isLifeOperation();
 
     /**
+     * Sets whether this operation is a query (C++ "const".)
+     */
+    void setConst(bool b);
+
+    /**
+     * Returns whether this operation is a query (C++ "const".)
+     */
+    bool getConst() const;
+
+    /**
      * Saves to the <UML:Operation> XMI element.
      */
     void saveToXMI( QDomDocument & qDoc, QDomElement & qElement );
@@ -196,6 +206,7 @@
 
 private:
     UMLAttributeList m_List;
+    bool m_bConst;
 };
 
 #endif
Index: umbrello/umbrello/javaimport.cpp
===================================================================
--- umbrello/umbrello/javaimport.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 0)
+++ umbrello/umbrello/javaimport.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -0,0 +1,340 @@
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ *  copyright (C) 2006                                                     *
+ *  Umbrello UML Modeller Authors <uml-devel@ uml.sf.net>                  *
+ ***************************************************************************/
+
+// own header
+#include "javaimport.h"
+
+#include <stdio.h>
+// qt/kde includes
+#include <qfile.h>
+#include <qtextstream.h>
+#include <qstringlist.h>
+#include <qregexp.h>
+#include <kdebug.h>
+// app includes
+#include "import_utils.h"
+#include "uml.h"
+#include "umldoc.h"
+#include "umlpackagelist.h"
+#include "package.h"
+#include "classifier.h"
+#include "enum.h"
+#include "operation.h"
+#include "attribute.h"
+
+JavaImport::JavaImport() : NativeImportBase("//") {
+    m_isStatic = false;
+}
+
+JavaImport::~JavaImport() {
+}
+
+/// Catenate possible template arguments/array dimensions to the end of the type name.
+/// Currently this function does not advance() to the next token. (TBC should it?)
+QString JavaImport::joinTypename() {
+    QString typeName = m_source[m_srcIndex];
+    const uint srcLength = m_source.count();
+    QString next = m_source[m_srcIndex + 1];
+    if (next == "<") {
+        m_srcIndex++;
+        typeName += '<';
+        while (m_srcIndex < srcLength) {
+            next = advance();
+            typeName += next;
+            if (next == ">")
+                break;
+        }
+        next = m_source[m_srcIndex + 1];
+    }
+    if (next == "[") {
+        m_srcIndex++;
+        typeName += '[';
+        while (m_srcIndex < srcLength) {
+            next = advance();
+            typeName += next;
+            if (next == "]")
+                break;
+        }
+    }
+    return typeName;
+}
+
+void JavaImport::fillSource(QString word) {
+    QString lexeme;
+    const uint len = word.length();
+    bool inString = false;
+    for (uint i = 0; i < len; i++) {
+        const QChar& c = word[i];
+        if (c == '"') {
+            lexeme += c;
+            if (i == 0 || word[i - 1] != '\\') {
+                if (inString) {
+                    m_source.append(lexeme);
+                    lexeme = QString::null;
+                }
+                inString = !inString;
+            }
+        } else if (inString ||
+                   c.isLetterOrNumber() || c == '_' || c == '.') {
+            lexeme += c;
+        } else {
+            if (!lexeme.isEmpty()) {
+                m_source.append(lexeme);
+                lexeme = QString::null;
+            }
+            m_source.append(QString(c));
+        }
+    }
+    if (!lexeme.isEmpty())
+        m_source.append(lexeme);
+}
+
+void JavaImport::parseFile(QString filename) {
+    if (filename.contains('/')) {
+        QString path = filename;
+        path.remove( QRegExp("/[^/]+$") );
+        kdDebug() << "JavaImport::parseFile: adding path " << path << endl;
+        Import_Utils::addIncludePath(path);
+    }
+    if (! QFile::exists(filename)) {
+        if (filename.startsWith("/")) {
+            kdError() << "JavaImport::parseFile(" << filename << "): cannot find file" << endl;
+            return;
+        }
+        bool found = false;
+        QStringList includePaths = Import_Utils::includePathList();
+        for (QStringList::Iterator pathIt = includePaths.begin();
+                                   pathIt != includePaths.end(); ++pathIt) {
+            QString path = (*pathIt);
+            if (! path.endsWith("/")) {
+                path.append("/");
+            }
+            if (QFile::exists(path + filename)) {
+                filename.prepend(path);
+                found = true;
+                break;
+            }
+        }
+        if (! found) {
+            kdError() << "JavaImport::parseFile(" << filename << "): cannot find file" << endl;
+            return;
+        }
+    }
+    QFile file(filename);
+    if (! file.open(IO_ReadOnly)) {
+        kdError() << "JavaImport::parseFile(" << filename << "): cannot open file" << endl;
+        return;
+    }
+    // Scan the input file into the QStringList m_source.
+    m_srcIndex = 0;
+    QTextStream stream(&file);
+    while (! stream.atEnd()) {
+        QString line = stream.readLine();
+        scan(line);
+    }
+    file.close();
+    // Parse the QStringList m_source.
+    m_klass = NULL;
+    m_currentAccess = Uml::Visibility::Public;
+    m_isStatic = m_isAbstract = false;
+    m_scopeIndex = 0;
+    m_scope[0] = NULL;
+    const uint srcLength = m_source.count();
+    for (m_srcIndex = 0; m_srcIndex < srcLength; m_srcIndex++) {
+        const QString& keyword = m_source[m_srcIndex];
+        //kdDebug() << '"' << keyword << '"' << endl;
+        if (keyword.startsWith(m_singleLineCommentIntro)) {
+            m_comment = keyword.mid(2);
+            continue;
+        }
+        if (keyword == "package") {
+            const QString& qualifiedName = advance();
+            QStringList names = QStringList::split(".", qualifiedName);
+            for (QStringList::Iterator nameIt = names.begin(); nameIt != names.end(); ++nameIt) {
+                QString name = (*nameIt);
+                UMLObject *ns = Import_Utils::createUMLObject(Uml::ot_Package,
+                                name, m_scope[m_scopeIndex], m_comment);
+                m_scope[++m_scopeIndex] = static_cast<UMLPackage*>(ns);
+            }
+            if (advance() != ";") {
+                kdError() << "importJava: unexpected: " << m_source[m_srcIndex] << endl;
+                skipStmt();
+            }
+            m_comment = QString::null;
+            continue;
+        }
+        if (keyword == "class" || keyword == "interface") {
+            const QString& name = advance();
+            UMLObject *ns = Import_Utils::createUMLObject(Uml::ot_Class,
+                            name, m_scope[m_scopeIndex], m_comment);
+            m_scope[++m_scopeIndex] = m_klass = static_cast<UMLClassifier*>(ns);
+            m_klass->setAbstract(m_isAbstract);
+            m_klass->setStatic(m_isStatic);
+            m_isAbstract = m_isStatic = false;
+            m_comment = QString::null;
+            if (advance() == ";")   // forward declaration
+                continue;
+            if (m_source[m_srcIndex] == "extends") {
+                const QString& baseName = advance();
+                Import_Utils::createGeneralization(m_klass, baseName);
+                advance();
+            }
+            if (m_source[m_srcIndex] == "implements") {
+                while (m_srcIndex < srcLength - 1 && advance() != "{") {
+                    const QString& baseName = m_source[m_srcIndex];
+                    Import_Utils::createGeneralization(m_klass, baseName);
+                    if (advance() != ",")
+                        break;
+                }
+            }
+            if (m_source[m_srcIndex] != "{") {
+                kdError() << "importJava: ignoring excess chars at " << name << endl;
+                skipStmt("{");
+            }
+            continue;
+        }
+        if (keyword == "enum") {
+            const QString& name = advance();
+            UMLObject *ns = Import_Utils::createUMLObject(Uml::ot_Enum,
+                            name, m_scope[m_scopeIndex], m_comment);
+            UMLEnum *enumType = static_cast<UMLEnum*>(ns);
+            advance();  // skip name
+            while (m_srcIndex < srcLength - 1 && advance() != "}") {
+                Import_Utils::addEnumLiteral(enumType, m_source[m_srcIndex]);
+                if (advance() != ",")
+                    break;
+            }
+            m_comment = QString::null;
+            continue;
+        }
+        if (keyword == "static") {
+            m_isStatic = true;
+            continue;
+        }
+        if (keyword == "abstract") {
+            m_isAbstract = true;
+            continue;
+        }
+        if (keyword == "public") {
+            m_currentAccess = Uml::Visibility::Public;
+            continue;
+        }
+        if (keyword == "protected") {
+            m_currentAccess = Uml::Visibility::Protected;
+            continue;
+        }
+        if (keyword == "private") {
+            m_currentAccess = Uml::Visibility::Private;
+            continue;
+        }
+        if (keyword == "final" ||
+            keyword == "native" ||
+            keyword == "synchronized" ||
+            keyword == "transient" ||
+            keyword == "volatile") {
+            //@todo anything to do here?
+            continue;
+        }
+        if (keyword == "import") {
+            skipStmt();
+            continue;
+        }
+        if (keyword == "}") {
+            if (m_scopeIndex)
+                m_klass = dynamic_cast<UMLClassifier*>(m_scope[--m_scopeIndex]);
+            else
+                kdError() << "importJava: too many }" << endl;
+            continue;
+        }
+        // At this point, we expect `keyword' to be a type name
+        // (of a member of class or interface, or return type
+        // of an operation.) Up next is the name of the attribute
+        // or operation.
+        if (! keyword.contains( QRegExp("^\\w") )) {
+            kdError() << "importJava: ignoring " << keyword << endl;
+            skipStmt();
+            continue;
+        }
+        QString typeName = joinTypename();
+        QString name;
+        if (typeName == m_klass->getName()) {
+            // Constructor.
+            name = typeName;
+            typeName = QString::null;
+        } else {
+            name = advance();
+        }
+        if (name.contains( QRegExp("\\W") )) {
+            kdError() << "importJava: expecting name in " << name << endl;
+            skipStmt();
+            continue;
+        }
+        // At this point we need a class.
+        if (m_klass == NULL) {
+            kdError() << "importJava: no class set for " << name << endl;
+            continue;
+        }
+        QString nextToken = advance();
+        if (nextToken == "(") {
+            // operation
+            UMLOperation *op = Import_Utils::makeOperation(m_klass, name);
+            m_srcIndex++;
+            while (m_srcIndex < srcLength && m_source[m_srcIndex] != ")") {
+                QString typeName = joinTypename();
+                QString parName = advance();
+                UMLAttribute *att = Import_Utils::addMethodParameter(op, typeName, parName);
+                if (advance() != ",")
+                    break;
+                m_srcIndex++;
+            }
+            Import_Utils::insertMethod(m_klass, op, Uml::Visibility::Public, typeName,
+                                       m_isStatic, m_isAbstract, false /*isFriend*/,
+                                       false /*isConstructor*/, m_comment);
+            m_isAbstract = m_isStatic = false;
+            m_comment = QString::null;
+            skipStmt("{");
+            int braceNesting = 0;
+            while (m_srcIndex < srcLength) {
+                nextToken = advance();
+                if (nextToken == "}") {
+                    if (braceNesting <= 0)
+                        break;
+                    braceNesting--;
+                } else if (nextToken == "{") {
+                    braceNesting++;
+                }
+            }
+            m_comment = QString::null;
+            continue;
+        }
+        // At this point we know it's some kind of attribute declaration.
+        while (1) {
+            while (nextToken != "," && nextToken != ";") {
+                name += nextToken;  // add possible array dimensions to `name'
+                nextToken = advance();
+            }
+            UMLObject *o = Import_Utils::insertAttribute(m_klass, m_currentAccess, name, typeName, m_comment);
+            UMLAttribute *attr = static_cast<UMLAttribute*>(o);
+            if (nextToken != ",")
+                break;
+            name = advance();
+            nextToken = advance();
+        }
+        m_currentAccess = Uml::Visibility::Public;
+        if (m_source[m_srcIndex] != ";") {
+            kdError() << "importJava: ignoring trailing items at " << name << endl;
+            skipStmt();
+        }
+        m_comment = QString::null;
+    }
+}
+
+

Property changes on: umbrello/umbrello/javaimport.cpp
___________________________________________________________________
Name: svn:executable
   + *

Index: umbrello/umbrello/umlview.h
===================================================================
--- umbrello/umbrello/umlview.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umlview.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -403,7 +403,14 @@
      */
     AssociationWidget * findAssocWidget(Uml::Association_Type at,
                                         UMLWidget *pWidgetA, UMLWidget *pWidgetB);
+
+
     /**
+        calls findAssocWidget on three possible types:
+        Uml::at_Aggregation << Uml::at_Composition << Uml::at_Containment
+        */
+    AssociationWidget * findAssocWidget(UMLWidget *pWidgetA, UMLWidget *pWidgetB);
+    /**
      * Remove a widget from view.
      *
      * @param o  The widget to remove.
Index: umbrello/umbrello/uml.cpp
===================================================================
--- umbrello/umbrello/uml.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/uml.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -51,6 +51,7 @@
 #include "cppimport.h"
 #include "idlimport.h"
 #include "adaimport.h"
+#include "javaimport.h"
 #include "docwindow.h"
 #include "codegenerator.h"
 #include "generatorinfo.h"
@@ -1420,6 +1421,8 @@
     QString preselectedExtension;
     if (m_activeLanguage == "IDL") {
         preselectedExtension = i18n("*.idl|IDL Files (*.idl)");
+    } else if (m_activeLanguage == "Java") {
+        preselectedExtension = i18n("*.java|Java Files (*.java)");
     } else if (m_activeLanguage == "Ada") {
         preselectedExtension = i18n("*.ads *.ada|Ada Files (*.ads *.ada)");
     } else {
@@ -1432,6 +1435,8 @@
     const QString& firstFile = fileList.first();
     if (firstFile.endsWith(".idl"))
         classImporter = new IDLImport();
+    else if (firstFile.endsWith(".java"))
+        classImporter = new JavaImport();
     else if (firstFile.contains( QRegExp("\\.ad[sba]$") ))
         classImporter = new AdaImport();
     else
Index: umbrello/umbrello/umlwidget.h
===================================================================
--- umbrello/umbrello/umlwidget.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umlwidget.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -533,7 +533,7 @@
      * @param offsetX The x-coordinate for drawing.
      * @param offsetY The y-coordinate for drawing.
      */
-    virtual void drawSelected(QPainter * p, int offsetX, int offsetY, bool resizeable = true);
+    virtual void drawSelected(QPainter * p, int offsetX, int offsetY);
 
     /**
      * Overrides default method.
@@ -654,7 +654,7 @@
     int            m_nOldX, m_nOldY, m_nPosX, m_origZ;
     ListPopupMenu *m_pMenu;
     UMLDoc        *m_pDoc;  ///< shortcut for UMLApp::app()->getDocument()
-    bool           m_bResizing;
+    bool           m_bResizable, m_bResizing;
     int            m_nPressOffsetX, m_nPressOffsetY;
     int            m_nOldH, m_nOldW;
     QFontMetrics  *m_pFontMetrics[FT_INVALID];
Index: umbrello/umbrello/umlobject.cpp
===================================================================
--- umbrello/umbrello/umlobject.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umlobject.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -325,7 +325,7 @@
         return "";
     QString name = m_pStereotype->getName();
     if (includeAdornments)
-        name = "" + name + "";
+        name = QString::fromUtf8("«") + name + QString::fromUtf8("»");
     return name;
 }
 
@@ -471,6 +471,16 @@
     }
     qElement.setAttribute( "xmi.id", ID2STR(m_nId) );
     qElement.setAttribute( "name", m_Name );
+    if (m_BaseType != Uml::ot_Operation &&
+            m_BaseType != Uml::ot_Role &&
+            m_BaseType != Uml::ot_Attribute) {
+        Uml::IDType nmSpc;
+        if (m_pUMLPackage)
+            nmSpc = m_pUMLPackage->getID();
+        else
+            nmSpc = UMLApp::app()->getDocument()->getModelID();
+        qElement.setAttribute( "namespace", ID2STR(nmSpc) );
+    }
     if (! m_Doc.isEmpty())
         qElement.setAttribute( "comment", m_Doc );  //CHECK: uml13.dtd compliance
 #ifdef XMI_FLAT_PACKAGES
Index: umbrello/umbrello/umldoc.h
===================================================================
--- umbrello/umbrello/umldoc.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umldoc.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -432,6 +432,12 @@
     QString getName() const;
 
     /**
+     * Return the m_modelID (currently this a fixed value:
+     * Umbrello supports only a single document.)
+     */
+    Uml::IDType getModelID() const;
+
+    /**
      * Used to give a unique ID to any sort of object.
      *
      * @return  A new unique ID.
@@ -931,6 +937,7 @@
     int m_uniqueID;
 
     QString m_Name; ///< name of this model as stored in the <UML:Model> tag
+    Uml::IDType m_modelID; ///< xmi.id of this model in the <UML:Model>
     int m_count;   ///< auxiliary counter for the progress bar
     bool m_modified;
     KURL m_doc_url;
Index: umbrello/umbrello/entity.cpp
===================================================================
--- umbrello/umbrello/entity.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/entity.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -167,7 +167,8 @@
 }
 
 int UMLEntity::entityAttributes() {
-    return m_List.count();
+    UMLClassifierListItemList entityAttributes = getFilteredList(Uml::ot_EntityAttribute);
+    return entityAttributes.count();
 }
 
 
Index: umbrello/umbrello/umldoc.cpp
===================================================================
--- umbrello/umbrello/umldoc.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umldoc.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -90,6 +90,7 @@
 
 UMLDoc::UMLDoc() {
     m_Name = i18n("UML Model");
+    m_modelID = "m1";
     m_currentView = 0;
     m_uniqueID = 0;
     m_count = 0;
@@ -1494,6 +1495,10 @@
     return m_Name;
 }
 
+Uml::IDType UMLDoc::getModelID() const {
+    return m_modelID;
+}
+
 void UMLDoc::saveToXMI(QIODevice& file, bool saveSubmodelFiles /* = false */) {
     QDomDocument doc;
 
@@ -1570,6 +1575,7 @@
     QDomElement contentNS = doc.createElement( "UML:Namespace.contents" );
 
     QDomElement objectsElement = doc.createElement( "UML:Model" );
+    objectsElement.setAttribute( "xmi.id", ID2STR(m_modelID) );
     objectsElement.setAttribute( "name", m_Name );
     objectsElement.setAttribute( "isSpecification", "false" );
     objectsElement.setAttribute( "isAbstract", "false" );
Index: umbrello/umbrello/associationwidget.h
===================================================================
--- umbrello/umbrello/associationwidget.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/associationwidget.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -724,6 +724,11 @@
     static float perpendicularProjection(QPoint P1, QPoint P2, QPoint P3, QPoint& ResultingPoint);
 
     /**
+     * Return the mid point between p0 and p1
+     */
+    static QPoint midPoint(QPoint p0, QPoint p1);
+
+    /**
      * Calculates the position of the text widget depending on the role
      * that widget is playing.
      * Returns the point at which to put the widget.
Index: umbrello/umbrello/attribute.cpp
===================================================================
--- umbrello/umbrello/attribute.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/attribute.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -188,7 +188,8 @@
     } else {
         attributeElement.setAttribute( "type", ID2STR(m_pSecondary->getID()) );
     }
-    attributeElement.setAttribute( "initialValue", m_InitialValue );
+    if (! m_InitialValue.isEmpty())
+        attributeElement.setAttribute( "initialValue", m_InitialValue );
     qElement.appendChild( attributeElement );
 }
 
Index: umbrello/umbrello/codegenerators/cppwriter.cpp
===================================================================
--- umbrello/umbrello/codegenerators/cppwriter.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/codegenerators/cppwriter.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1196,6 +1196,9 @@
         }
         str += " )";
 
+        if (op->getConst())
+            str += " const";
+
         // method body : only gets IF its not in a header
         if (isHeaderMethod && !INLINE_OPERATION_METHODS)
             str +=";"; // terminate now
Index: umbrello/umbrello/codegenerators/cppsourcecodeoperation.cpp
===================================================================
--- umbrello/umbrello/codegenerators/cppsourcecodeoperation.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/codegenerators/cppsourcecodeoperation.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -93,11 +93,15 @@
 
     // if a property has a friend stereotype, the operation should
     // not be a class name
-    QString startText;
+    QString startText = returnType + " ";
+
     if (!o->getStereotype().isEmpty() && o->getStereotype(false) == "friend")
-        startText = returnType + " " + methodName + " ("+paramStr+") {";
-    else
-        startText = returnType + " " + className + "::" + methodName + " ("+paramStr+") {";
+        startText += className + "::";
+    startText += methodName + " ("+paramStr+")";
+    if (o->getConst())
+        startText += " const";
+    startText += " {";
+
     setStartMethodText(startText);
 
     // Only write this out if its a child of an interface OR is abstract.
Index: umbrello/umbrello/codegenerators/tclwriter.cpp
===================================================================
--- umbrello/umbrello/codegenerators/tclwriter.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/codegenerators/tclwriter.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -217,7 +217,7 @@
     }
     // check on enum classes
     if (!classifierInfo->isInterface) {
-        // use tcl-list for enums
+        // use tcl-list for enum's
         if (c->getBaseType() == Uml::ot_Enum) {
             UMLClassifierListItemList litList =
                 c->getFilteredList(Uml::ot_EnumLiteral);
Index: umbrello/umbrello/codegenerators/simplecodegenerator.cpp
===================================================================
--- umbrello/umbrello/codegenerators/simplecodegenerator.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/codegenerators/simplecodegenerator.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -37,6 +37,7 @@
 #include "../codedocument.h"
 #include "../operation.h"
 #include "../umldoc.h"
+#include "../uml.h"
 
 // Constructors/Destructors
 //
@@ -102,7 +103,7 @@
         name = concept->getFullyQualifiedName("-");
     }
 
-    if (ext != ".idl" && ext != ".java" && ext != ".pm" && ext != ".py") {
+    if (! UMLApp::app()->activeLanguageIsCaseSensitive()) {
         package = package.lower();
         name = name.lower();
     }
Index: umbrello/umbrello/codegenerators/cppheadercodeoperation.cpp
===================================================================
--- umbrello/umbrello/codegenerators/cppheadercodeoperation.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/codegenerators/cppheadercodeoperation.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -149,6 +149,8 @@
     // virtual functions
     start = (inlinePolicy ? " {" : ";");
     end = (inlinePolicy ? "}" : "");
+    if (pOp->getConst())
+        prototype += " const";
     if (interface || pOp->getAbstract()) {
        // constructor can't be virtual or abstract
        if (!pOp->isLifeOperation()) {
Index: umbrello/umbrello/messagewidget.h
===================================================================
--- umbrello/umbrello/messagewidget.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/messagewidget.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -326,11 +326,6 @@
     int onWidget(const QPoint & p);
 
     /**
-     * Overrides the standard operation.
-     */
-    virtual void mousePressEvent(QMouseEvent *me);
-
-    /**
      * Saves to the <messagewidget> XMI element.
      */
     void saveToXMI( QDomDocument & qDoc, QDomElement & qElement );
Index: umbrello/umbrello/dialogs/assocgenpage.cpp
===================================================================
--- umbrello/umbrello/dialogs/assocgenpage.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/dialogs/assocgenpage.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -17,6 +17,7 @@
 
 // qt includes
 #include <qlayout.h>
+#include <qcombobox.h>
 
 // kde includes
 #include <klocale.h>
@@ -33,7 +34,7 @@
 
     m_pAssociationWidget = assoc;
     m_pWidget = 0;
-    m_pTypeLE = 0;
+    m_pTypeCB = 0;
     m_pAssocNameLE = 0;
     m_pUmldoc = d;
 
@@ -77,25 +78,51 @@
     m_pDoc = new QMultiLineEdit(docGB);
     docLayout -> addWidget(m_pDoc);
     m_pDoc-> setText(m_pAssociationWidget-> getDoc());
+    Uml::Association_Type currentType =  m_pAssociationWidget->getAssocType();
+    QString currentTypeAsString = UMLAssociation::typeAsString(currentType);
+    QLabel *pTypeL = new QLabel(i18n("Type:"), nameGB);
+    nameLayout->addWidget(pTypeL, 1, 0);
 
-    // Association Type
-    QLabel *pTypeL = NULL;
-    Dialog_Utils::makeLabeledEditField( nameGB, nameLayout, 1,
-                                    pTypeL, i18n("Type:"),
-                                    m_pTypeLE,
-                                    UMLAssociation::typeAsString(m_pAssociationWidget->getAssocType()) );
-    m_pTypeLE->setEnabled(false);
+    /* Here is a list of all the supported choices for changing
+       association types */
+    m_AssocTypes.clear();
+    m_AssocTypes <<  Uml::at_Aggregation
+        << Uml::at_Composition << Uml::at_Containment;
 
+    bool found=false;
+    m_AssocTypeStrings.clear();
+    for (int i=0; i<m_AssocTypes.size(); ++i) {
+        if (m_AssocTypes[i] == currentType) found=true;
+        QString typeStr = UMLAssociation::typeAsString(m_AssocTypes[i]);
+        m_AssocTypeStrings << typeStr;
+    }
+    
+    if (!found) {
+        m_AssocTypes.clear();
+        m_AssocTypes << currentType;
+        m_AssocTypeStrings.clear();
+        m_AssocTypeStrings << currentTypeAsString;
+    }
+    
+    m_pTypeCB = new QComboBox(nameGB);
+    pTypeL->setBuddy(m_pTypeCB);
+    m_pTypeCB->insertStringList(m_AssocTypeStrings);
+    m_pTypeCB->setCurrentText(currentTypeAsString);
     m_pDoc->setWordWrap(QMultiLineEdit::WidgetWidth);
+    nameLayout->addWidget(m_pTypeCB, 1, 1);
+    
 
 }
 
 
 void AssocGenPage::updateObject() {
 
+
     if(m_pAssociationWidget) {
         QString name = m_pAssocNameLE -> text();
-
+        int comboBoxItem = m_pTypeCB->currentItem();
+        Uml::Association_Type newType = m_AssocTypes[comboBoxItem];
+        m_pAssociationWidget->setAssocType(newType);
         m_pAssociationWidget->setName(m_pAssocNameLE->text());
         m_pAssociationWidget->setDoc(m_pDoc->text());
 
Index: umbrello/umbrello/dialogs/settingsdlg.cpp
===================================================================
--- umbrello/umbrello/dialogs/settingsdlg.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/dialogs/settingsdlg.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -311,7 +311,7 @@
     case Settings::page_UI:
         m_UiWidgets.useFillColorCB -> setChecked( true );
         m_UiWidgets.fillColorB -> setColor( QColor( 255, 255, 192 ) );
-        m_UiWidgets.lineColorB -> setColor( red );
+        m_UiWidgets.lineColorB -> setColor( Qt::red );
         m_UiWidgets.lineWidthB -> setValue( 0 );
         break;
 
@@ -386,7 +386,7 @@
 }
 
 void SettingsDlg::slotLineBClicked() {
-    m_UiWidgets.lineColorB -> setColor( red );
+    m_UiWidgets.lineColorB -> setColor( Qt::red );
 }
 
 void SettingsDlg::slotFillBClicked() {
Index: umbrello/umbrello/dialogs/umloperationdialog.cpp
===================================================================
--- umbrello/umbrello/dialogs/umloperationdialog.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/dialogs/umloperationdialog.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -86,11 +86,14 @@
     genLayout -> addWidget(m_pStereoTypeCB, 1, 1);
 
     m_pAbstractCB = new QCheckBox( i18n("&Abstract operation"), m_pGenGB );
-    m_pAbstractCB -> setChecked( m_pOperation -> getAbstract() );
+    m_pAbstractCB -> setChecked( m_pOperation->getAbstract() );
+    genLayout -> addWidget( m_pAbstractCB, 2, 0 );
     m_pStaticCB = new QCheckBox( i18n("Classifier &scope (\"static\")"), m_pGenGB );
-    m_pStaticCB -> setChecked( m_pOperation -> getStatic() );
-    genLayout -> addWidget( m_pAbstractCB, 2, 0 );
+    m_pStaticCB -> setChecked( m_pOperation->getStatic() );
     genLayout -> addWidget( m_pStaticCB, 2, 1 );
+    m_pQueryCB = new QCheckBox( i18n("&Query (\"const\")"), m_pGenGB );
+    m_pQueryCB -> setChecked( m_pOperation->getConst() );
+    genLayout -> addWidget( m_pQueryCB, 2, 2 );
 
     topLayout -> addWidget( m_pGenGB );
 
@@ -485,6 +488,8 @@
     else
         m_pOperation->setTypeName(typeName);
 
+    m_pOperation->setStereotype( m_pStereoTypeCB->currentText() );
+
     bool isAbstract = m_pAbstractCB->isChecked();
     m_pOperation -> setAbstract( isAbstract );
     if (isAbstract) {
@@ -495,8 +500,8 @@
          */
         classifier->setAbstract(true);
     }
-    m_pOperation -> setStatic( m_pStaticCB -> isChecked() );
-    m_pOperation -> setStereotype( m_pStereoTypeCB->currentText() );
+    m_pOperation->setStatic( m_pStaticCB->isChecked() );
+    m_pOperation->setConst( m_pQueryCB->isChecked() );
 
     return true;
 }
Index: umbrello/umbrello/dialogs/umloperationdialog.h
===================================================================
--- umbrello/umbrello/dialogs/umloperationdialog.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/dialogs/umloperationdialog.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -99,6 +99,7 @@
     QLineEdit * m_pNameLE;
     QCheckBox * m_pAbstractCB;
     QCheckBox * m_pStaticCB;
+    QCheckBox * m_pQueryCB;
     QPushButton* m_pDeleteButton;
     QPushButton* m_pPropertiesButton;
     KArrowButton* m_pUpButton;
Index: umbrello/umbrello/dialogs/assocgenpage.h
===================================================================
--- umbrello/umbrello/dialogs/assocgenpage.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/dialogs/assocgenpage.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -24,6 +24,7 @@
 #include <qmultilineedit.h>
 #include <qradiobutton.h>
 #include <qcheckbox.h>
+#include <qvaluelist.h>
 
 //my class includes
 #include "../umlobject.h"
@@ -31,6 +32,9 @@
 #include "../umldoc.h"
 #include "../associationwidget.h"
 
+class QComboBox;
+
+
 /**
  * Displays properties of a UMLObject in a dialog box.  This is not usually directly
  * called.  The class @ref AssocPropDlg will set this up for you.
@@ -64,7 +68,14 @@
     void updateObject();
 
 private:
-    QLineEdit * m_pAssocNameLE, *m_pTypeLE;
+    QLineEdit * m_pAssocNameLE;
+    QComboBox *m_pTypeCB;
+
+    /* Choices for the QComboBox, and we store ints and strings
+       so we can translate both ways */
+    QValueList<Uml::Association_Type> m_AssocTypes;
+    QStringList m_AssocTypeStrings;
+        
     QMultiLineEdit * m_pDoc;
 
     AssociationWidget *m_pAssociationWidget;
Index: umbrello/umbrello/widgetbase.cpp
===================================================================
--- umbrello/umbrello/widgetbase.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/widgetbase.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -82,9 +82,9 @@
 
 void WidgetBase::saveToXMI( QDomDocument & /*qDoc*/, QDomElement & qElement ) {
     if (m_bUsesDiagramLineColour) {
-        qElement.setAttribute( "linecolour", "none" );
+        qElement.setAttribute( "linecolor", "none" );
     } else {
-        qElement.setAttribute( "linecolour", m_LineColour.name() );
+        qElement.setAttribute( "linecolor", m_LineColour.name() );
     }
     if (m_bUsesDiagramLineWidth) {
         qElement.setAttribute( "linewidth", "none" );
@@ -94,20 +94,25 @@
 }
 
 bool WidgetBase::loadFromXMI( QDomElement & qElement ) {
-    QString lineColour = qElement.attribute( "linecolour", "none" );
+    // first load from "linecolour" and then overwrite with the "linecolor"
+    // attribute if that one is present. The "linecolour" name was a "typo" in
+    // earlier versions of Umbrello
+    QString lineColor = qElement.attribute( "linecolour", "none" );
+    lineColor = qElement.attribute( "linecolor", lineColor );
+
     QString lineWidth = qElement.attribute( "linewidth", "none" );
-    if (lineColour != "none") {
-        m_LineColour = QColor(lineColour);
+    if (lineColor != "none") {
+        setLineColor( QColor(lineColor) );
         m_bUsesDiagramLineColour = false;
     } else if (m_Type != Uml::wt_Box && m_pView != NULL) {
-        m_LineColour = m_pView->getLineColor();
+        setLineColor( m_pView->getLineColor() );
         m_bUsesDiagramLineColour = true;
     }
     if (lineWidth != "none") {
-        m_LineWidth = lineWidth.toInt();
+        setLineWidth( lineWidth.toInt() );
         m_bUsesDiagramLineWidth = false;
     } else if ( m_pView ) {
-        m_LineWidth = m_pView->getLineWidth();
+        setLineWidth( m_pView->getLineWidth() );
         m_bUsesDiagramLineWidth = true;
     }
     return true;
Index: umbrello/umbrello/umlrole.h
===================================================================
--- umbrello/umbrello/umlrole.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umlrole.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -67,20 +67,6 @@
     QString getMultiplicity() const;
 
     /**
-     * Returns the name assigned to the role.
-     *
-     * @return  The name assigned to the role.
-     */
-    QString getName() const;
-
-    /**
-     * Returns the documentation for the role.
-     *
-     * @return  The documentation text for the role.
-     */
-    QString getDoc() const;
-
-    /**
      * Sets the UMLObject playing the role in the association.
      *
      * @param obj               Pointer to the UMLObject of role.
@@ -101,20 +87,6 @@
      */
     void setMultiplicity ( const QString &multi );
 
-    /**
-     * Sets the name of the role.
-     *
-     * @param roleName  The name of role.
-     */
-    void setName( const QString &roleName );
-
-    /**
-     *  Sets the documentation on the role.
-     *
-     *  @param doc              The string with the documentation.
-     */
-    void setDoc( const QString &doc );
-
     UMLAssociation * getParentAssociation ();
 
     // Sets the m_SecondaryId
@@ -152,13 +124,10 @@
     /** do some initialization at construction time */
     void init (UMLAssociation * parent, UMLObject * parentObj, Uml::Role_Type r);
 
-    QString m_Doc;
     UMLAssociation * m_pAssoc;
     Uml::Role_Type m_role;
-    QString m_Name;
     QString m_Multi;
     Uml::Changeability_Type m_Changeability;
-
 };
 
 #endif
Index: umbrello/umbrello/notewidget.cpp
===================================================================
--- umbrello/umbrello/notewidget.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/notewidget.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -205,6 +205,7 @@
 }
 
 void NoteWidget::mouseReleaseEvent( QMouseEvent * me ) {
+    UMLWidget::mouseReleaseEvent( me );
     if (m_bResizing) {
         drawText();
         UMLWidget::mouseReleaseEvent(me);
Index: umbrello/umbrello/activitywidget.cpp
===================================================================
--- umbrello/umbrello/activitywidget.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/activitywidget.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -27,8 +27,8 @@
 ActivityWidget::ActivityWidget(UMLView * view, ActivityType activityType, Uml::IDType id )
         : UMLWidget(view, id)
 {
-    m_ActivityType = activityType;
     UMLWidget::setBaseType( Uml::wt_Activity );
+    setActivityType( activityType );
     updateComponentSize();
 }
 
@@ -115,6 +115,7 @@
 
 void ActivityWidget::setActivityType( ActivityType activityType ) {
     m_ActivityType = activityType;
+    UMLWidget::m_bResizable = (m_ActivityType == Normal);
 }
 
 void ActivityWidget::slotMenuSelection(int sel) {
@@ -195,7 +196,7 @@
     m_Text = qElement.attribute( "activityname", "" );
     m_Doc = qElement.attribute( "documentation", "" );
     QString type = qElement.attribute( "activitytype", "1" );
-    m_ActivityType = (ActivityType)type.toInt();
+    setActivityType( (ActivityType)type.toInt() );
     return true;
 }
 
Index: umbrello/umbrello/import_utils.cpp
===================================================================
--- umbrello/umbrello/import_utils.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/import_utils.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -117,8 +117,9 @@
         int isConst = name.contains(QRegExp("^const "));
         name.remove(QRegExp("^const\\s+"));
         QString typeName(name);
-        int isPointer = typeName.contains('*');
-        int isRef = typeName.contains('&');
+        const int isAdorned = typeName.contains( QRegExp("[^\\w: ]") );
+        const int isPointer = typeName.contains('*');
+        const int isRef = typeName.contains('&');
         typeName.remove(QRegExp("[^\\w: ].*$"));
         UMLObject *origType = umldoc->findUMLObject(typeName, Uml::ot_UMLObject, parentPkg);
         if (origType == NULL) {
@@ -163,13 +164,13 @@
                 bPutAtGlobalScope = true;
             }
             Uml::Object_Type t = type;
-            if (type == Uml::ot_UMLObject || isConst || isRef || isPointer)
+            if (type == Uml::ot_UMLObject || isAdorned)
                 t = Uml::ot_Class;
             origType = umldoc->createUMLObject(t, typeName, parentPkg);
             bNewUMLObjectWasCreated = true;
             kapp->processEvents();
         }
-        if (isConst || isPointer || isRef) {
+        if (isConst || isAdorned) {
             // Create the full given type (including adornments.)
             if (isConst)
                 name.prepend("const ");
@@ -187,7 +188,8 @@
                 kdError() << "createUMLObject(" << name << "): "
                 << "origType " << typeName << " is not a UMLClassifier"
                 << endl;
-            dt->setIsReference();
+            if (isRef || isPointer)
+                dt->setIsReference();
             /*
             if (isPointer) {
                 UMLObject *pointerDecl = umldoc->createUMLObject(Uml::ot_Datatype, type);
@@ -200,7 +202,10 @@
             o = origType;
         }
     } else if (parentPkg && !bPutAtGlobalScope) {
+        if (o->getUMLPackage())
+            o->getUMLPackage()->removeObject(o);
         o->setUMLPackage(parentPkg);
+        parentPkg->addObject(o);
     }
     QString strippedComment = formatComment(comment);
     if (! strippedComment.isEmpty()) {
Index: umbrello/umbrello/x-umbrello.desktop
===================================================================
--- umbrello/umbrello/x-umbrello.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/x-umbrello.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -39,5 +39,4 @@
 Comment[tg]=Файли моделкунонии UML Umbrello
 Comment[tr]=Umbrello UML Modelleyici Dosyası
 Comment[uk]=Файл моделювання UML Umbrello
-Comment[xx]=xxUmbrello UML Modeller Filexx
 Comment[zh_CN]=Umbrello UML 建模工具文件
Index: umbrello/umbrello/main.cpp
===================================================================
--- umbrello/umbrello/main.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/main.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -45,7 +45,7 @@
 int main(int argc, char *argv[]) {
     KAboutData aboutData( "umbrello", I18N_NOOP("Umbrello UML Modeller"),
                           UMBRELLO_VERSION, description, KAboutData::License_GPL,
-                          I18N_NOOP("(c) 2001 Paul Hensgen, (c) 2002-2005 Umbrello UML Modeller Authors"), 0,
+                          I18N_NOOP("(c) 2001 Paul Hensgen, (c) 2002-2006 Umbrello UML Modeller Authors"), 0,
                           "http://uml.sf.net/");
     aboutData.addAuthor("Paul Hensgen",0, "phensgen@users.sourceforge.net");
     aboutData.addAuthor(I18N_NOOP("Umbrello UML Modeller Authors"), 0, "uml-devel@lists.sourceforge.net");
Index: umbrello/umbrello/forkjoinwidget.h
===================================================================
--- umbrello/umbrello/forkjoinwidget.h	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/forkjoinwidget.h	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -79,7 +79,7 @@
      * Although the ForkJoinWidget supports resizing, we suppress the
      * resize corner because it is too large for this very slim widget.
      */
-    void drawSelected(QPainter * p, int offsetX, int offsetY, bool resizeable = true);
+    void drawSelected(QPainter * p, int offsetX, int offsetY);
 
     /**
     * Overrides the function from UMLWidget.
Index: umbrello/umbrello/operation.cpp
===================================================================
--- umbrello/umbrello/operation.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/operation.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -271,6 +271,14 @@
     return (isConstructorOperation() || isDestructorOperation());
 }
 
+void UMLOperation::setConst(bool b) {
+    m_bConst = b;
+}
+
+bool UMLOperation::getConst() const {
+    return m_bConst;
+}
+
 bool UMLOperation::showPropertiesDialogue(QWidget* parent) {
     UMLOperationDialog dialogue(parent, this);
     return dialogue.exec();
@@ -278,6 +286,7 @@
 
 void UMLOperation::saveToXMI( QDomDocument & qDoc, QDomElement & qElement ) {
     QDomElement operationElement = UMLObject::save("UML:Operation", qDoc);
+    operationElement.setAttribute( "isQuery", m_bConst ? "true" : "false" );
     QDomElement featureElement = qDoc.createElement( "UML:BehavioralFeature.parameter" );
     if (m_pSecondary) {
         QDomElement retElement = qDoc.createElement("UML:Parameter");
@@ -287,7 +296,6 @@
         retElement.setAttribute( "kind", "return" );
         featureElement.appendChild( retElement );
     } else {
-        //operationElement.setAttribute( "type", m_SecondaryId );
         kdDebug() << "UMLOperation::saveToXMI: m_SecondaryId is "
         << m_SecondaryId << endl;
     }
@@ -331,6 +339,12 @@
             }
         }
     }
+    QString isQuery = element.attribute( "isQuery", "" );
+    if (!isQuery.isEmpty()) {
+        // We need this extra test for isEmpty() because load() might have been
+        // called again by the processing for BehavioralFeature.parameter (see below)
+        m_bConst = (isQuery == "true");
+    }
     QDomNode node = element.firstChild();
     if (node.isComment())
         node = node.nextSibling();
Index: umbrello/umbrello/entitywidget.cpp
===================================================================
--- umbrello/umbrello/entitywidget.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/entitywidget.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -104,8 +104,16 @@
     for (entityattribute = list.first(); entityattribute; entityattribute = list.next()) {
         QString text = entityattribute->getName();
         p.setPen( QPen(Qt::black) );
+        UMLEntityAttribute* casted = dynamic_cast<UMLEntityAttribute*>( entityattribute );
+        if( casted && casted->getIndexType() == Uml::Primary )
+        {
+            font.setUnderline( true );
+            p.setFont( font );
+            font.setUnderline( false );
+        }
         p.drawText(offsetX + ENTITY_MARGIN, offsetY + y,
                    fontMetrics.width(text), fontHeight, Qt::AlignVCenter, text);
+        p.setFont( font );
         y+=fontHeight;
     }
 
Index: umbrello/umbrello/umlview.cpp
===================================================================
--- umbrello/umbrello/umlview.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/umbrello/umlview.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -801,6 +801,8 @@
     return 0;
 }
 
+
+
 AssociationWidget * UMLView::findAssocWidget( Uml::IDType id ) {
     AssociationWidget *obj;
     AssociationWidgetListIt it( m_AssociationList );
@@ -814,6 +816,21 @@
     return 0;
 }
 
+AssociationWidget * UMLView::findAssocWidget(UMLWidget *pWidgetA, UMLWidget *pWidgetB) {
+    static QValueList<Association_Type> assocTypes;
+    if (assocTypes.isEmpty()) {
+        assocTypes << Uml::at_Aggregation
+        << Uml::at_Composition << Uml::at_Containment;
+    }
+    AssociationWidget* retval = NULL;
+    for (int i=0; i<assocTypes.size(); ++i) {
+        retval = findAssocWidget(assocTypes[i], pWidgetA, pWidgetB);
+        if (retval != NULL) return retval;
+    }
+    return retval;
+}
+
+
 AssociationWidget * UMLView::findAssocWidget(Association_Type at,
         UMLWidget *pWidgetA, UMLWidget *pWidgetB) {
     AssociationWidget *assoc;
@@ -2586,12 +2603,11 @@
         UMLWidget *w = findWidget( attrType->getID() );
         AssociationWidget *aw = NULL;
         // if the attribute type has a widget representation on this view
-        if (w &&
-                // if the AssocWidget does not already exist then
-                ((aw = findAssocWidget(assocType, widget, w)) == NULL ||
-                 aw->getRoleName(Uml::B) != attr->getName()) &&
-                // if the current diagram type permits compositions
-                AssocRules::allowAssociation(assocType, widget, w, false)) {
+        if (w) {
+           aw = findAssocWidget(widget, w) ;
+           if ( ( aw == NULL || aw->getRoleName(Uml::B) != attr->getName() ) &&
+              // if the current diagram type permits compositions
+                AssocRules::allowAssociation(assocType, widget, w, false) ) {
             // Create a composition AssocWidget, or, if the attribute type is
             // stereotyped <<CORBAInterface>>, create a UniAssociation widget.
             if (attrType->getStereotype() == "CORBAInterface")
@@ -2608,18 +2624,20 @@
             a->setActivated(true);
             if (! addAssociation(a))
                 delete a;
+           }
         }
         // if the attribute type is a UMLDatatype then
         if (attrType->getBaseType() == ot_Datatype) {
             UMLDatatype *dt = static_cast<UMLDatatype*>(attrType);
             // if the UMLDatatype is a reference (pointer) type
             if (dt->isReference()) {
+                Uml::Association_Type assocType = Uml::at_Composition;
                 UMLClassifier *c = dt->originType();
                 UMLWidget *w = c ? findWidget( c->getID() ) : 0;
                 // if the referenced type has a widget representation on this view
-                if (w &&
-                        // if the AssocWidget does not already exist then
-                        findAssocWidget(at_Aggregation, widget, w) == NULL &&
+                if (w) {
+                   aw = findAssocWidget(widget, w);
+                   if (aw == NULL &&
                         // if the current diagram type permits aggregations
                         AssocRules::allowAssociation(at_Aggregation, widget, w, false)) {
                     // create an aggregation AssocWidget from the ClassifierWidget
@@ -2635,6 +2653,7 @@
                     a->setActivated(true);
                     if (! addAssociation(a))
                         delete a;
+                   }
                 }
             }
         }
Index: umbrello/VERSION
===================================================================
--- umbrello/VERSION	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/VERSION	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1 +1 @@
-1.5
+1.5.1
Index: umbrello/ChangeLog
===================================================================
--- umbrello/ChangeLog	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/ChangeLog	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1,3 +1,8 @@
+Version 1.5.1
+
+* Bugs fixed / wishes implemented (see http://bugs.kde.org)
+109963 117791 117875 117990 118570 118719
+
 Version 1.5
 
 * Association classes
Index: umbrello/THANKS
===================================================================
--- umbrello/THANKS	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ umbrello/THANKS	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -46,11 +46,13 @@
 martin <mv123q3 @hotmail.com>
 Rene Meyer <Rene.Meyer @sturmit.de>
 Laurent Montel <montel @kde.org>
+Tom Morris <tfmorris @gmail.com>
 Lutz Mueller <lutz.mueller @gmx.de>
 Heiko Nardmann <heiko.nardmann @onlinehome.de>
 Dimitri Ognibene <ognibened @yahoo.it>
 Carsten Pfeiffer <pfeiffer @kde.org>
 Ivan Porres <iporres @abo.fi>
+Maciej Puzio <maciek @work.swmed.edu>
 Ruediger Ranft <kdebugs @rranft1.mail.htwm.de>
 John Ratke <jratke @comcast.net>
 Daniel Richard G. <skunk @iskunk.org>
Index: scripts/kdesvn-build
===================================================================
--- scripts/kdesvn-build	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kdesvn-build	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -288,9 +288,9 @@
     "build-dir"           => "build",
     "build-system-only"   => "",
     "checkout-only"       => "",
-    "configure-flags"     => "--enable-debug=full",
+    "configure-flags"     => "--enable-debug",
     "colorful-output"     => 1, # Use color by default.
-    "cxxflags"            => "-g -pipe",
+    "cxxflags"            => "-pipe",
     "debug"               => "",
     "debug-level"         => INFO,
     "dest-dir"            => '${MODULE}', # single quotes used on purpose!
Index: scripts/fixfsfaddr.sed
===================================================================
--- scripts/fixfsfaddr.sed	(.../tags/KDE/3.5.0/kdesdk)	(revision 0)
+++ scripts/fixfsfaddr.sed	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -0,0 +1,28 @@
+#! /usr/bin/sed
+
+# Copyright 2005 Nicolas GOUTTE <goutte@kde.org>
+# License LGPL V2+
+
+# The script helps to fix the FSF address
+# Use:
+#   find . -name .svn -prune , type f | xargs fgrep -l "Free Software Foundation" | xargs sed -i -f fixfsfaddr.sed
+# Note: you should check the changes before committing them.
+
+# Implementation note: we need to replace phrase by phrase, as 
+# the wrapping of the FSF address is at different places.
+
+# Current FSF address: 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301
+
+# Old address: 59 Temple Place, Suite 330, Boston, MA  02111-1307
+s/59 Temple Place,/51 Franklin Street,/
+s/59 Temple Place -/51 Franklin Street,/
+s/Suite 330,/Fifth Floor,/
+s/02111-1307/02110-1301/
+
+# Very old address: 675 Mass Ave, Cambridge, MA  02139
+s/675 Mass Ave/51 Franklin Street, Fifth Floor/
+s/Cambridge/Boston/
+s/02139/02110-1301/
+# Warning: the last two replaces seem to match the address of the MIT too.
+# Typo in KDE: Franklin Steet
+s/Franklin Steet/Franklin Street/
Index: scripts/kdesvn-buildrc-sample
===================================================================
--- scripts/kdesvn-buildrc-sample	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kdesvn-buildrc-sample	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -31,13 +31,13 @@
 
 # This controls the configure flags passed to every module (except qt-copy) by
 # default.  If you have module-specific configure flags, they will be placed
-# after these flags to allow the module setting to override them.
-	configure-flags --enable-debug=full
+# after these flags to allow the module setting to override the global setting.
+	configure-flags --enable-debug
 
 # These are the compilation flags to use by default when compiling KDE.
-# The -march option also supports pentium4, athlon-xp, etc.  See the gcc man
-# page for more information.
-	cxxflags -g -pipe -march=i686
+# gcc supports a -march option in order to generate specific code for pentium4, athlon-xp,
+# etc.  See the gcc man page for more information.
+	cxxflags -pipe
 
 # These are the default options passed to the make command.  The default tries
 # to build with 2 parallel compiles.  If you are using distcc or have SMP, you
Index: scripts/licensecheck
===================================================================
--- scripts/licensecheck	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/licensecheck	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -2,7 +2,7 @@
 #
 # License checker for source files
 
-# This should kept in sync with CVSROOT/loginfo.pl
+# This should kept in sync with kde-common/svn/hooks/post-commit.pl
 sub checklicense($)
 {
    my ($text) = @_;
@@ -18,22 +18,27 @@
    $license = "";
    $massave = "";
 
+   $gl = " (v2)" if ($text =~ /version 2 as published by the Free Software Foundation/);
    $gl = " (v2+)" if ($text =~ /either version 2 of the License, or .at your option. any later version/);
    $gl = " (v2.1)" if ($text =~ /version 2\.1 as published by the Free Software Foundation/);
+   $gl = " (v2.1+)" if ($text =~ /either version 2\.1 of the License, or .at your option. any later version/);
    $qte = " (+Qt exception)" if ($text =~ /([Pp]ermission is given|[pP]ermission is also granted|[pP]ermission) to link (the code of )?this program with (any edition of )?(Qt|the Qt library)/);
-   $massave = " (wrong address)" if ($text =~ /675 Mass Ave/i);
+   $massave = " (wrong address)" if ($text =~ /(?:675 Mass Ave|59 Temple Place|51 Franklin Steet|02139|02111-1307)/i); # "51 Franklin Street, 02110-1301" is the right FSF address
 
    $license="GENERATED FILE" if ($text =~ /(All changes made in this file will be lost|DO NOT EDIT|DO NOT delete this file|[Gg]enerated by)/);
-   $license="LGPL$gl$massave $license" if ($text =~ /This (program|library) is free software you can redistribute it and.?or modify it under the terms of the GNU (Library|Lesser) General Public License/);
-   $license="GPL$gl$qte$massave $license" if ($text =~ /is free software you can redistribute it and.?or modify it under the terms of the GNU General Public License/);
+   $license="LGPL$gl$massave $license" if ($text =~ /is free software.? you can redistribute it and.?or modify it under the terms of the GNU (Library|Lesser) General Public License/);
+   $license="GPL$gl$qte$massave $license" if ($text =~ /is free software.? you can redistribute it and.?or modify it under the terms of the GNU General Public License/);
+   ### FIXME if the license matches the next regexp, it will probably match the following one too.
    $license="QPL (part of Qt) $license" if ($text =~ /This file is part of the .*Qt GUI Toolkit. This file may be distributed under the terms of the Q Public License as defined/);
    $license="QPL $license" if ($text =~ /may be distributed under the terms of the Q Public License as defined by Trolltech AS/);
    $license="X11 (BSD like) $license" if($text =~ /Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files .the Software., to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and.?or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED AS IS/);
+   $license="BSD $license" if ($text =~ /THIS SOFTWARE IS PROVIDED BY THE AUTHOR AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE/);
    $license="MPL 1.1 $license" if ($text =~ /subject to the Mozilla Public License Version 1.1/);
    $license="no copyright $license" if ($text !~ /copyright/i);
    $license="UNKNOWN" if(!length($license));
 
    $license =~ s/ $//;
+
    return "$license";
 }
 
Index: scripts/kde-emacs/kde-emacs-vars.el
===================================================================
--- scripts/kde-emacs/kde-emacs-vars.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs-vars.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -15,8 +15,8 @@
 ;; 									    ;;
 ;; You should have received a copy of the GNU General Public License	    ;;
 ;; along with this program; if not, write to the Free Software		    ;;
-;; Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA		    ;;
-;; 02111-1307, USA.							    ;;
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA		    ;;
+;; 02110-1301, USA.							    ;;
 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 
 (defconst kde-emacs-version "0.2"
Index: scripts/kde-emacs/kde-emacs-bindings.el
===================================================================
--- scripts/kde-emacs/kde-emacs-bindings.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs-bindings.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -14,8 +14,8 @@
 ;;
 ;; You should have received a copy of the GNU Lesser General Public
 ;; License along with this library; if not, write to the Free Software
-;; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-;; 02111-1307  USA
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+;; 02110-1301  USA
 
 ; currently no binding for header-protection and add-file-to-makefile-am,
 ; you need to call them from M-x
Index: scripts/kde-emacs/kde-emacs-general.el
===================================================================
--- scripts/kde-emacs/kde-emacs-general.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs-general.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -14,8 +14,8 @@
 ;;
 ;; You should have received a copy of the GNU Lesser General Public
 ;; License along with this library; if not, write to the Free Software
-;; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-;; 02111-1307  USA
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+;; 02110-1301  USA
 
 ;;; Commentary:
 ;;
Index: scripts/kde-emacs/kde-emacs-utils.el
===================================================================
--- scripts/kde-emacs/kde-emacs-utils.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs-utils.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -14,8 +14,8 @@
 ;;
 ;; You should have received a copy of the GNU Lesser General Public
 ;; License along with this library; if not, write to the Free Software
-;; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-;; 02111-1307  USA
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+;; 02110-1301  USA
 
 
 (require 'kde-emacs-vars)
@@ -80,7 +80,7 @@
 	(let ((pos (c-safe-scan-lists (point) -1 1)))
 	; +1 added here so that the regexp in the while matches the { too.
 	  (goto-char (if pos (+ pos 1) (point-min))))
-	(while (re-search-backward "^[ ]*\\(class\\|namespace\\)[ \t][^};]*{" nil t)
+	(while (re-search-backward "^[ ]*\\(class\\|namespace\\|struct\\)[ \t][^};]*{" nil t)
 	  (save-excursion
 	    (forward-word 1)
 	   (when (looking-at "[ \t]*[A-Z_]*_EXPORT[A-Z_]*[ \t]")
@@ -136,6 +136,8 @@
        (setq function (replace-match " " t t function)))
   (and (string-match "^\\(virtual\\>\\)?[ \t]*" function)
        (setq function (replace-match "" t t function)))
+  (and (string-match "^\\(explicit\\>\\)?[ \t]*" function)
+       (setq function (replace-match "" t t function)))
   (and (string-match "^\\(static\\>\\)?[ \t]*" function)
        (setq function (replace-match "" t t function)))
   (while (string-match "  +" function) ; simplifyWhiteSpace
@@ -218,11 +220,15 @@
                  (setq function (match-string 2 a))
                  (kde-switch-cpp-h)
                  (goto-char 0)
+		 ; Look for beginning of class ("\\s-+" means whitespace including newlines)
                  (re-search-forward
 		  (concat "\\(class\\|struct\\|namespace\\)\\s-+"
-			  class "[^;]+{") nil t)
+			  "\\([A-Z_]+_EXPORT[A-Z_]*\\)?\\s-+"  ; allow for optional EXPORT macro
+			  class "\\b"                          ; the classname - with word separator
+			  "[^;]+{"                             ; the optional inheritance and the '{'
+			  ) nil t)
                  ;; TODO keep looking, until we find a match that's not inside a comment
-                 (re-search-forward (concat "[ \t]+" (regexp-quote function) "[ \t]*(") nil t)))))
+                 (re-search-forward (concat "\\b" (kde-function-regexp-quote function) "[ \t]*(") nil t)))))
     (if (string-match "\\.h$" n)
         (progn
 	  (let ((mup (method-under-point))
@@ -238,7 +244,7 @@
 	    (setq sig (kde-remove-newline (kde-function-impl-sig namespace class function)))
 	    (if (string-match "(.*" sig) ; remove args
 		(setq sig (replace-match "" nil t sig)))
-	    (setq found (re-search-forward (concat "^[^()]*" (regexp-quote sig) "[ \t]*(") nil t) )
+	    (setq found (re-search-forward (concat "^[^()]*" (kde-function-regexp-quote sig) "[ \t]*(") nil t) )
 
         (if (not found)
             (progn
@@ -249,14 +255,14 @@
               
               (if (string-match "(.*" sig) ; remove args
                   (setq sig (replace-match "" nil t sig)))
-              (re-search-forward (concat "^[^()]*" (regexp-quote sig) "[ \t]*(") nil t) ) )
+              (re-search-forward (concat "^[^()]*" (kde-function-regexp-quote sig) "[ \t]*(") nil t) ) )
 	    )))))
 
 (defun kde-remove-newline (str) 
-  (let ((res str))
-    (while (string-match "\n" res )
-    (setq res (replace-match " " nil t res)))
-  res))
+    (replace-in-string str "\n" " "))
+; quote for use as regexp, but replace spaces with "any whitespace"
+(defun kde-function-regexp-quote (str)
+  (replace-in-string (regexp-quote str) "[ \n\t]" "[ \n\t]"))
 
 ; Initial implementation by Arnt Gulbransen
 ; Current maintainer: David Faure
@@ -272,6 +278,7 @@
 	 (insertion-string (kde-function-impl-sig namespace class function))
 	 (msubstr nil)
 	 (start nil)
+	 (newcppfile nil)
 	 )
     (setq insertion-string 
 	  (concat insertion-string "\n{\n"
@@ -283,12 +290,25 @@
     ; move to next method, to be ready for next call
     (backward-char)                ; in case we're after the ';'
     (re-search-forward ";" nil t)  ; end of this method decl
-    (re-search-forward ";" nil t)  ; end of next method decl
+    (let ((moveToNext t))
+      (while moveToNext
+	(re-search-forward ";" nil t)  ; end of next method decl
+	(save-excursion
+	  (forward-char -2) ; -1 goes to ';' itself, so go before that
+	  (while (looking-at "[ \t0=]")
+	    (forward-char -1))
+	  (forward-char 1)
+          ; move to next method again if we're at a pure virtual method
+	  (setq moveToNext (looking-at "[ \t]*=[ \t]*0;"))
+	  )
+	)
+      )
 
+    (setq newcppfile (not (cdr (kde-file-get-cpp-h))))
     (if (string-match "\\.h$" file)
 	(kde-switch-cpp-h)
       )
-    (goto-char (point-max))
+    (goto-char (point-max))    
     (kde-comments-begin)
     (kde-skip-blank-lines)
     (setq msubstr (buffer-substring (point-at-bol) (point-at-eol)))
@@ -303,6 +323,8 @@
 	  (insert "\n")
 	  (forward-line 1)
 	  ))
+    (when newcppfile
+      (insert "\n"))
     (insert insertion-string)
     (forward-char -3)
     (c-indent-defun)   
@@ -316,20 +338,31 @@
       (fume-rescan-buffer))
     ))
 
+(defun add-file-to-buildsystem ()
+  "Add the current (C++) file to either Makefile.am or a .pro file, whichever exists."
+  ; Author: David
+  (interactive)
+  (if (file-readable-p "Makefile.am")
+      (add-file-to-makefile-am)
+    ; else: find a .pro file and add it there
+    (let* ((files (directory-files "." nil ".pro$" nil t))
+	   (projfile (car files)))
+      (if projfile
+	  (add-file-to-project projfile "^SOURCES[ \t]*") ; could be SOURCES= or SOURCES+=
+	; else: error
+	(error "No build system file found")
+	)))
+  )
 
-; Adds the current file to Makefile.am.
-; Written by David.
-(defun add-file-to-makefile-am ()
-  "add the current file to the _SOURCES tag in the Makefile.am"
-  (interactive)
-  (let ((file (buffer-name))
-        (makefile "Makefile.am"))
+; internal helper for add-file-to-*
+(defun add-file-to-project (makefile searchString)
+  (let ((file (buffer-name)))
     (if (not (file-readable-p makefile))
-	(error "Makefile.am not found!")
+	(error (concat makefile " not found!"))
       )
     (find-file makefile)
     (goto-char (point-min))
-    (if (re-search-forward "_SOURCES" nil t)
+    (if (re-search-forward searchString nil t)
 	(progn
 	  (end-of-line)
           ; check if line ends with '\' [had to read make-mode.el to find this one!]
@@ -338,12 +371,18 @@
 	  (insert " ")
 	  (insert file)
 	  )
-      (error "_SOURCES not found")
-      )
-    )
+      (error (concat searchString " not found"))
+      ))
   )
 
+(defun add-file-to-makefile-am ()
+  "Add the current file to the first _SOURCES line in the Makefile.am"
+  ; Author: David
+  (interactive)
+  (add-file-to-project "Makefile.am" "_SOURCES")
+  )
 
+
 ; Inserts a kdDebug statement showing the name of the current method.
 ; You need to create the empty line first.
 (defun insert-kdDebug ()
@@ -826,16 +865,29 @@
 (defun qt-open-header ()
   "Open the Qt header file for the class under point"
   (interactive)
-  (let* ((file (getenv "QTDIR"))
+  (let* ((qtinc (concat (getenv "QTDIR") "/include/"))
 	(class (thing-at-point 'word))
 	(f nil)
-	(files (directory-files (concat file "/include") t nil "dirsonly"))
+	(file nil)
+	(files nil)
 	)
     (save-excursion
-      (dolist (f files nil)
-	(if (file-readable-p (concat f "/" class) )
-	    (setq file (concat f "/" class))))
-      (qt-follow-includes file)
+      ; The Qt3 case: the includes are directly in $QTDIR/include/, lowercased
+      (setq f (concat qtinc (downcase class) ".h" ))
+      (if (file-readable-p f)
+	  (setq file f)
+        ; For some Qt3/e classes: add _qws
+	(setq f (concat qtinc (downcase class) "_qws.h" ))
+	(if (file-readable-p f)
+	    (setq file f)
+        ; The Qt4 case: the includes are in $QTDIR/include/QSomething/, in original case
+	  (setq files (directory-files qtinc t nil "dirsonly"))
+	  (dolist (f files nil)
+	    (if (file-readable-p (concat f "/" class) )
+		(setq file (concat f "/" class))))
+	  ))
+      (and file
+	   (qt-follow-includes file))
       )
   ))
 
Index: scripts/kde-emacs/kde-emacs.el
===================================================================
--- scripts/kde-emacs/kde-emacs.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -15,8 +15,8 @@
 ;;
 ;; You should have received a copy of the GNU Lesser General Public
 ;; License along with this library; if not, write to the Free Software
-;; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-;; 02111-1307  USA
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+;; 02110-1301  USA
 
 ;;; Installation:
 ;;
Index: scripts/kde-emacs/dirvars.el
===================================================================
--- scripts/kde-emacs/dirvars.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/dirvars.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -21,8 +21,8 @@
 
 ;; You should have received a copy of the GNU General Public License
 ;; along with GNU Emacs; see the file COPYING.  If not, write to
-;; the Free Software Foundation, Inc., 59 Temple Place - Suite 330,
-;; Boston, MA 02111-1307, USA.
+;; the Free Software Foundation, Inc., 51 Franklin Steet, Fifth Floor,
+;; Boston, MA 02110-1301, USA.
 
 ;;; Commentary:
 
Index: scripts/kde-emacs/kde-emacs-compat.el
===================================================================
--- scripts/kde-emacs/kde-emacs-compat.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs-compat.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -16,8 +16,8 @@
 ;;
 ;; You should have received a copy of the GNU General Public License
 ;; along with this program; if not, write to the Free Software
-;; Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-;; 02111-1307, USA.
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+;; 02110-1301, USA.
 
 (require 'kde-emacs-vars)
 
Index: scripts/kde-emacs/kde-emacs-semantic.el
===================================================================
--- scripts/kde-emacs/kde-emacs-semantic.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs-semantic.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -14,8 +14,8 @@
 ;;
 ;; You should have received a copy of the GNU Lesser General Public
 ;; License along with this library; if not, write to the Free Software
-;; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-;; 02111-1307  USA
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+;; 02110-1301  USA
 
 ;;; Commentary:
 ;; Package provides four interactive functions:
Index: scripts/kde-emacs/kde-emacs-doc.el
===================================================================
--- scripts/kde-emacs/kde-emacs-doc.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs-doc.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -14,8 +14,8 @@
 ;;
 ;; You should have received a copy of the GNU Lesser General Public
 ;; License along with this library; if not, write to the Free Software
-;; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-;; 02111-1307  USA
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+;; 02110-1301  USA
 ;;
 ;;
 ;;; Documentation :
@@ -54,8 +54,8 @@
  
 You should have received a copy of the GNU Lesser General Public
 License along with this library; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-02111-1307  USA"
+Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+02110-1301  USA"
   "GNU LGPL license header.")
 
 (defvar GPL "This program is free software; you can redistribute it and/or
@@ -70,8 +70,8 @@
 
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-02111-1307, USA."
+Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+02110-1301, USA."
   "GNU GPL license header.")
 
 (defvar FDL "Permission is granted to copy, distribute and/or modify this document
Index: scripts/kde-emacs/kde-emacs-core.el
===================================================================
--- scripts/kde-emacs/kde-emacs-core.el	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kde-emacs/kde-emacs-core.el	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -14,8 +14,8 @@
 ;;
 ;; You should have received a copy of the GNU Lesser General Public
 ;; License along with this library; if not, write to the Free Software
-;; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-;; 02111-1307  USA
+;; Foundation, Inc., 51 Franklin Steet, Fifth Floor, Boston, MA
+;; 02110-1301  USA
 
 (require 'kde-emacs-vars)
 ;*---------------------------------------------------------------------*/
Index: scripts/README
===================================================================
--- scripts/README	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/README	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1,35 +1,121 @@
 
 Stuff in this directory:
 
+=== DEBUGGING SUPPORT
+
 adddebug        Modifies the Makefile to add debug info (-g)
 
-add_trace	Modifies a source file to add a trace as the first line
+add_trace.pl	Modifies a source file to add a trace as the first line
 		of every method, using kdDebug, and showing args values.
 
-authors2xml	Extract author information from C++ files and print it out
-		in DocBook format as a list
+kDebug2kdDebug.sh Script to convert old KDE debugging statements to their
+		modern equivalents.
 
+extend_dmalloc	Script to run gdb on return-addresses
+
+kdekillall	Kills the process "kdeinit: <process> with signal <signal>
+
+=== PROGRAMMING SUPPORT
+
 cheatmake	Helper for saving time when recompiling, skipping files that
 		haven't changed in a meaningful way (e.g. if you only change
 		a comment...)
 
-check_licenses	
+check_licenses	Old license checker for source files
+                (Use licensecheck instead)
 
 licensecheck	Simple license checker for source files
 
+create_makefile Create the Makefile in a directory containing a Makefile.am
+                Saves time compared to re-running configure completely 
+
+create_makefiles The recursive version of it - needs create_makefile.
+
+fixheaders      Adds header files as it recognices make error output
+
+fixkdeincludes	Tries to reduce the number of includes in KDE source files
+
+fixuifiles	Fixes up Qt Designer .ui files (version, accels, generated names)
+		To use before any commit of a .ui file.
+
+fixfsfaddr.sed  Script for sed to fix old FSF addresses
+
+includemocs	Adds missing "#include foobar.moc" lines
+
+kdedoc		Open a kde help page in kfm/konqueror
+
+qtdoc		Open a qt help page in kfm/konqueror
+
+kde-spellcheck.pl A script to check source code for misspelings and optionally
+		correct them.
+
+=== MODERNIZATION SCRIPTS
+
+rc2kcfgxt.pl	Reads an existing KConfig rc file and creates a best-guess
+		version of a KConfigXT XML file.
+
+kdelnk2desktop.py Converts old-style .kdelnk files to their modern .desktop
+		equivalents.
+
+=== USEFUL DATA FOR EXTERNAL PROGRAMS
+
+kde-devel-emacs.el An emacs file that contains many helpful functions and keybindings
+		A must for anyone using [X]Emacs to develop KDE/Qt/C++ applications.
+
+kde-devel-gdb	A gdb macro definition file, to e.g. print QStrings from gdb.
+
+kde-devel-vim.vim A vim script that contains many helpful functions and keybindings
+		for vim-using KDE developers.
+
+kde.supp	Some valgrind suppressions handy for ignoring stuff we don't
+		care about when valgrinding kde applications
+
+completions/	Contains useful scripts to enhance the auto-complete feature of some shells.
+
+=== INFORMATION EXTRACTION
+
+alldcop.rb	Shows an pseudo-XML representation of the DCOP interfaces for
+		currently-running KDE applications.  Does not require
+		Korundum.
+
+authors2xml.pl	Extract author information from C++ files and print it out
+		in DocBook format as a list
+
 makeobj		Script around make which basicly checks if it's in srcdir
 		or in builddir and changes to the right directory for
 		calling /usr/bin/make
 
-colorcvs
+extractrc	Extract text tags from designer's UI files and XML GUI-RC files
 
-create_makefile Create the Makefile in a directory containing a Makefile.am
-                Saves time compared to re-running configure completely 
+extractattr	Same as extractrc, but for use by Scripty.
 
-create_makefiles The recursive version of it - needs create_makefile.
+findmissingcrystal Looks at Crystal icons to find ones which are still
+		unchanged from kdeclassic.
 
+zonetab2pot.py  Reads timezone list as its first argument or from
+		/usr/share/zoneinfo/zone.tab, and converts it to a PO file
+		template.
+
+kdemangen.pl	Script to use the output from a KDE application's --author and
+		--help-all output to automatically generate a man page for the
+		application.
+
+png2mng.pl	Script to convert a series of numbered .png files into a .mng
+		animation.
+
+package_crystalsvg Script to package all svg files recursively from the current
+		directory.
+
+=== SOURCE CONTROL UTILITIES (CVS and Subversion)
+=== All CVS utilities have a corresponding svn version.
+
+colorcvs        Colorizes cvs commands.
+
 create_cvsignore Create a .cvsignore file (using the contents of Makefile.am)
 
+cvs-clean	Recursively wipes out everything not registered in the CVS
+		server, starting from the current directory.
+
 cvs2dist	Create a standalone source distribution tarball for an app
 		in a KDE CVS module.
 
@@ -40,10 +126,11 @@
 
 cvsblame	Bonsai-like cvs annotate 
 
-cvschanged	Check for edited or merged files in a checked out CVS module,
-		without connecting to the CVS server.
+cvscheck	Offline check for status of files in a checked-out module.
 
-cvscheck	Offline check for status of files in a checked-out
+cvsgettags	List the available CVS tags for a given set of files, or
+		recursively for all files and directories.  No equivalent for
+		svn.
 
 noncvslist	List all files in a checked out CVS module that are unknown to
 		to the CVS server.
@@ -53,13 +140,6 @@
 cxxmetric	Counts lines of code, comments and blank space in C and C++
 		source files.
 
-fixheaders      Adds header files as it recognices make error output
-
-fixkdeincludes	Tries to reduce the number of includes in KDE source files
-
-fixuifiles	Fixes up Qt Designer .ui files (version, accels, generated names)
-		To use before any commit of a .ui file.
-
 cvslastchange   launches "cvs diff -u" to display the last applied changes for a
                 given file. HEAD branch only.
 
@@ -75,57 +155,28 @@
 
 cvsforwardport  Forwardport the last commit in a branch to HEAD
 
-gendebug        Generate C++/Qt code for printing debug output.
-
 pruneemptydirs	Detects stale source dirs in a CVS tree
 
-kde-build       Updates and recompiles a local CVS tree
+cvslastreferenced Goes through the whole history of a file to find all modifications
+                referencing a specific string.  It's useful if you want to know
+                when a function has been removed/modified/added to a file if a
+                recent cvs annotate doesn't reference it anymore. 
 
+=== KDE BUILD SCRIPTS
+
+kde-build       Updates and recompiles a local CVS or Subversion tree
+
 build-progress.sh Displays the progress of kde-build, times needed to complete each
 		step. And sets the titlebar of the terminal to the directory that
 		make is processing 
 
-extractrc	Extract text tags from designer's UI files and XML GUI-RC files
+kdesvn-build	Updates and recompiles a local Subversion tree.
 
+=== OTHERS
+
 gettext.patch	Patch for gettext-0.10.35 to give xgettext the functionality to
 		extract scoped messages
 
-includemocs	Adds missing "#include foobar.moc" lines
-
-kde-devel-emacs.el An emacs file that contains many helpful functions and keybindings
-		A must for anyone using [X]Emacs to develop KDE/Qt/C++ applications.
-
-kde-devel-gdb	A gdb macro definition file, to e.g. print QStrings from gdb.
-
-extend_dmalloc	Script to run gdb on return-addresses
-
-kde-devel-vim.vim 
-
-kde.supp	Some valgrind suppressions handy for ignoring stuff we don't
-		care about when valgrinding kde applications
-
-kdecompile	Python script for compiling and installing a KDE package
-
-kdedoc		Open a kde help page in kfm/konqueror
-
-qtdoc		Open a qt help page in kfm/konqueror
-
-kdekillall	Kills the process "kdeinit: <process> with signal <signal>
-
-kdelnk2desktop
-
-zone		Reads timezone list as its first argument or from
-		/usr/share/zoneinfo/zone.tab, and converts it to a PO file
-		 template
-
-rc2kcfgxt.pl	Reads an existing KConfig rc file and creates a best-guess
-		version of a KConfigXT XML file.
-
-cvslastreferenced Goes through the whole history of a file to find all modifications
-                referencing a specific string.  It's useful if you want to know
-                when a function has been removed/modified/added to a file if a
-                recent cvs annotate doesn't reference it anymore. 
-
 ----------------
 Looking to add a script?
 
Index: scripts/kdemangen.pl
===================================================================
--- scripts/kdemangen.pl	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scripts/kdemangen.pl	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -58,7 +58,7 @@
     my $ret = "";
     foreach( split /\n/, $options )
       {
-	if( /^  (--?[[:alpha:]]+, )?(--[[:alpha:]-]*)( <[[:alpha:] ]*>| [[:alpha:]]*)? *(.*)$/ )
+	if( /^  (--?[[:alpha:]]+, )?(--[[:alpha:]-]*|-[[:alpha:]])( <[[:alpha:] ]*>| [[:alpha:]]*)? *(.*)$/ )
 	  {
 	    my $short;
 	    my $long;
@@ -218,7 +218,7 @@
 my $description = $shortdescription;
 if( -r "control" )
   {
-    $description = `cat control | sed -ne '/Package: $appname\$/,/^\$/p' | egrep -v '^\\w*:.*\$' | sed -e 's/^ //' | sed -e 's/^\\.//'`;
+    $description = `cat control | sed -ne '/^Description:/,/^\$/p' | egrep -v '^\\w*:.*\$' | sed -e 's/^ //' | sed -e 's/^\\.//'`;
 # leads to problems in some cases :(
 #    $description =~ s/KDE ?/\n.SM KDE\n/g;
   }
Index: kompare/komparepart/komparepart.desktop
===================================================================
--- kompare/komparepart/komparepart.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kompare/komparepart/komparepart.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -16,7 +16,6 @@
 Name[ta]=கோம்பெர் உறுப்பு
 Name[tg]=Қисмати утилитҳои баробаркунии файлҳо
 Name[th]=ส่วนเปรียบเทียบ
-Name[xx]=xxKomparePartxx
 Name[zu]=Ingxenye yeKompare
 MimeType=text/x-diff
 ServiceTypes=Kompare/ViewPart,KParts/ReadWritePart,KParts/ReadOnlyPart
Index: kompare/kompare.desktop
===================================================================
--- kompare/kompare.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kompare/kompare.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -12,7 +12,6 @@
 Name[ta]=கோம்பெர்
 Name[th]=เปรียบเทียบ
 Name[tr]=Karşılaştır
-Name[xx]=xxKomparexx
 GenericName=Diff/Patch Frontend
 GenericName[af]=Diff/Lap Voorprogram
 GenericName[ar]=واجهة Diff/Patch
@@ -58,7 +57,6 @@
 GenericName[th]=ฟรอนต์เอนด์ของ Diff/Patch
 GenericName[tr]=Diff/Yama Önyüzü
 GenericName[uk]=Інтерфейс до diff/patch
-GenericName[xx]=xxDiff/Patch Frontendxx
 GenericName[zh_CN]=Diff/Patch 前端
 GenericName[zh_TW]=Diff/Patch 前端
 GenericName[zu]=Diff/PatchIsiqalo sokugcina
Index: kompare/komparenavtreepart/komparenavtreepart.desktop
===================================================================
--- kompare/komparenavtreepart/komparenavtreepart.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kompare/komparenavtreepart/komparenavtreepart.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -5,7 +5,6 @@
 Name[pt_BR]=Componente da árvore do Kompare
 Name[sv]=Kompare-navigeringsträdsdel
 Name[ta]=கோம்பெர் மரம் பாகம்
-Name[xx]=xxKompareNavTreePartxx
 MimeType=text/x-diff
 ServiceTypes=Kompare/NavigationPart
 X-KDE-Library=libkomparenavtreepart
Index: kdeaccounts-plugin/kdeaccountsplugin.desktop
===================================================================
--- kdeaccounts-plugin/kdeaccountsplugin.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kdeaccounts-plugin/kdeaccountsplugin.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -7,7 +7,9 @@
 Name[el]=Λογαριασμοί χώρου αποθήκευσης του KDE
 Name[es]=Cuentas del repositorio de KDE
 Name[et]=KDE hoidla kontod
+Name[eu]=KDE-ren biltegiaren kontuak
 Name[fr]=Comptes du référentiel de KDE
+Name[hu]=KDE SVN-azonosítók
 Name[is]=KDE geymslu aðgangur
 Name[it]=Account del deposito di KDE
 Name[ja]=KDE レポジトリアカウント
@@ -21,7 +23,6 @@
 Name[sr@Latn]=Nalozi KDE skladišta
 Name[sv]=KDE-arkivkonton
 Name[uk]=Рахунки сховища KDE
-Name[xx]=xxKDE Repository Accountsxx
 Name[zh_CN]=KDE 仓库账号
 
 [Plugin]
Index: scheck/scheck.themerc
===================================================================
--- scheck/scheck.themerc	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ scheck/scheck.themerc	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -4,7 +4,6 @@
 Name[hi]=शेक
 Name[hu]=Stílusellenőrző
 Name[ta]=Sசரிபார்ப்பு 
-Name[xx]=xxScheckxx
 Comment=Development style for searching accelerator and style guide conflicts
 Comment[bs]=Stil razvoja za pretragu konflikata akceleratora i konflikata sa stilskim vodičem
 Comment[ca]=Estil de desenvolupament per a cercar conflictes amb acceleradors i la guia d'estil
@@ -39,7 +38,6 @@
 Comment[tg]=Навъи коркард барои ҷустуҷӯи низоии акселаторҳо ва навъи навишти барнома
 Comment[tr]=Arama hızlandırıcısı ve biçem kılavuz çelişmeleri için geliştirme biçemi
 Comment[uk]=Стиль розробки для пошуку конфліктів акселераторів та правил стилю
-Comment[xx]=xxDevelopment style for searching accelerator and style guide conflictsxx
 Comment[zh_CN]=搜索加速键和样式指南冲突的开发样式
 
 [KDE]

Property changes on: kcachegrind/pics/hicolor/hi16-action-percent.png
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: kcachegrind/pics/hicolor/hi16-action-recrec.png
___________________________________________________________________
Name: svn:executable
   - *

Index: kcachegrind/kcachegrind/tips
===================================================================
--- kcachegrind/kcachegrind/tips	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kcachegrind/kcachegrind/tips	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1,10 +1,10 @@
 <tip category="KCachegrind|Help">
 <html>
-<p>...that the <em>What's this...</em> help for every GUI widget
+<p>...that the <em>What's This?</em> help for every GUI widget
 in KCachegrind contains detailed usage information for this widget?
-It is highly recommend to read at least these help texts on first
-use. Request <em>What's this...</em> help by pressing
-Shift-F1 and clicking on the widget.</p>
+It is highly recommended to read at least these help texts on first
+use. Request <em>What's This?</em> help by pressing
+Shift+F1 and clicking on the widget.</p>
 </html>
 </tip>
 
Index: kcachegrind/kcachegrind/kcachegrind.desktop
===================================================================
--- kcachegrind/kcachegrind/kcachegrind.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kcachegrind/kcachegrind/kcachegrind.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -11,7 +11,6 @@
 Name[hi]=के-केश-ग्रिंड
 Name[sv]=Kcachegrind
 Name[ta]=  இடைமாற்றகட்டம்
-Name[xx]=xxKCachegrindxx
 GenericName=Profiler Frontend
 GenericName[bs]=Profiler frontend
 GenericName[ca]=Interfície de Profiler
@@ -46,7 +45,6 @@
 GenericName[tg]=Интерфейс ба профилкунанда
 GenericName[tr]=Profil Önyüzü
 GenericName[uk]=Інтерфейс до Profiler
-GenericName[xx]=xxProfiler Frontendxx
 GenericName[zh_CN]=个性数据前端
 Comment=Visualization of Performance Profiling Data
 Comment[bs]=Vizualizacija podataka za profiliranje performansi
@@ -80,7 +78,6 @@
 Comment[ta]= விவர தகவலை செயல்பாட்டு காட்சியாளிப்பு
 Comment[tg]=Утилита барои гузориши профили визуалӣ
 Comment[uk]=Візуалізація даних профілювання швидкодії
-Comment[xx]=xxVisualization of Performance Profiling Dataxx
 Comment[zh_CN]=性能个性数据的可视化表现
 X-DCOP-ServiceType=Multi
 Categories=Qt;KDE;Development;
Index: kcachegrind/kcachegrind/x-kcachegrind.desktop
===================================================================
--- kcachegrind/kcachegrind/x-kcachegrind.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kcachegrind/kcachegrind/x-kcachegrind.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -29,7 +29,6 @@
 Comment[ta]=இடைமாற்றகட்டம்/ அழைப்பு கட்டம் விவரக்குறி திணிப்பு
 Comment[tg]=Дампи профилкунии Cachegrind/Callgrind
 Comment[uk]=Звалювання профілювання Cachegrind/Callgrind
-Comment[xx]=xxCachegrind/Callgrind Profile Dumpxx
 Comment[zh_CN]=Cachegrind/Callgrind 配置文件转存
 DefaultApp=kcachegrind
 Icon=kcachegrind
Index: kcachegrind/kcachegrind/tabview.cpp
===================================================================
--- kcachegrind/kcachegrind/tabview.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kcachegrind/kcachegrind/tabview.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -574,7 +574,7 @@
 		 "<li>The Assembler tab presents annotated assembler code "
 		 "if trace information on instruction level "
 		 "is available.</li></ul>"
-		 "For more information, see the <em>What's this</em> "
+		 "For more information, see the <em>What's This?</em> "
 		 "help of the corresponding tab widget</p>");
 }
 
Index: doc/kbabel/preferences.docbook
===================================================================
--- doc/kbabel/preferences.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/preferences.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -18,62 +18,96 @@
 </chapterinfo>
 
 <title>Preferences</title>
-<sect1 id="preferences-kbabel">
-<title>&kbabel; preferences</title>
 
-<para> To show the Preferences dialog choose
-<menuchoice><guimenu>Settings</guimenu> <guimenuitem>Configure
-KBabel...</guimenuitem></menuchoice> from &kbabel;'s menu.  It uses a
-structured configuration dialog which makes it very easy to find an
-option without having to perform an extensive search for it.</para>
 
-<para>The left side of the preferences dialog lists the categories of
-customizable items and the right side shows the corresponding tab for
-the selected category.  &kbabel; keeps changes if you move between
-categories, so when you're finally happy click the
-<guibutton>OK</guibutton> button.  At any time you can use quick
-help&mdash;just click on the question mark on the title bar and,
-after the cursor has changed to an arrow with a question mark,
-click on a button, label, or preference entry to find out more
-about it.</para>
+<sect1 id="preferences-overview">
+<title>Global and project settings</title>
 
-<sect2 id="preferences-identity">
-<title>Identity</title>
+<para>
+From KBabel 1.10 (KDE 3.4) on, KBabel has the concept of projects and therefore
+the settings have been split in two categories:
+the global settings and the project settings (also called project configuration).
+</para>
 
-<para>This section allows you to set standard fields for every
-translated <acronym>PO</acronym> file.  These are your name, email
-address, full language name, email address for your translation team
-mailing list.  There is also a timezone field to track your
-<quote>last modified</quote> time for <acronym>PO</acronym> files.
-You can specify it as character sequence like <acronym>EEST</acronym>
-or offset from <acronym>GMT</acronym> time like +0200 (&ie; for
-Romania).  This information is used when updating file headers.  You
-can find the options that control what fields in the header should be
-updated in the <link linkend="preferences-save">Save</link> section of
-the Preferences dialog.</para>
+<important><para>
+&GNU; gettext uses a term called "project", which has nothing to do with
+KBabel's projects. &GNU; gettext means by project an application which is
+related to the <acronym>PO</acronym> file. For KBabel, a project is
+much bigger. It can mean a set of applications, like &kde;.
+</para></important>
 
-<warning><para>Character sequences for timezones are not standardized.
-So you should not use the string set here in time specification for
-saving in <link linkend="preferences-save">Save</link> tab. You should
-use <literal>%z</literal> instead.</para></warning>
+<para>
+KBabel has <emphasis>always</emphasis> a current project, even if it is the
+default project. KBabel has not mode without any project. A project is always
+for KBabel's editor and KBabel's catalog manager.
+</para>
 
-<variablelist>
-<varlistentry>
-<term><guilabel>Number of singular/plural forms</guilabel></term>
-<listitem>
-<para> Use this for setting number of plural forms for your
-language. For example, it is 2 for German (one for the singular and
-one for the plural form).</para>
 
-<note><para>This feature is currently implemented only for plural forms format  used in &kde;. It does not work with gettext plural forms.</para></note> 
-</listitem>
-</varlistentry>
-</variablelist>
+<sect2 id="preferences-limitations">
+<title>Known limitations of the current implementation</title>
 
+<para>
+Unfortunately the current implementation of projects has a few known problems.
+</para>
+
+<para>
+An example is that in the global settings, there is no setting for the default user,
+his/her default language and other similar important global user data. It means that such
+data must be entered again each time that a new project is created.
+</para>
+
+<para>
+Another problem is the new project wizard. It does not ask enough information, especially
+it fails to ask for the team email address. So it is recommended to check the project
+settings after having run the wizard.
+</para>
+
+<tip><para>
+Currently you cannot copy projects from inside KBabel, so apparently you cannot easily share good settings.
+However you are free to copy the project outside KBabel and to load the copied project into KBabel.
+</para></tip>
+
 </sect2>
 
+<sect2 id="preferences-non-kde-projects">
+<title>Using KBabel for non-&kde; projects</title>
+
+<para>
+While &kbabel;'s defaults are oriented toward working with and for &kde;, &kbabel; can be used
+to translate <acronym>PO</acronym> files of other projects. However mostly you will have to tweak the
+settings to the need of your project. This is especially true for &GNU; and
+&GNU;-like projects, which need quite different defaults than for &kde;.
+</para>
+
+<para>
+One problem is that &kbabel; is relatively agressive when saving <acronym>PO</acronym> files and
+replaces setting of the <acronym>PO</acronym> files by settings of the projects, if not told otherwise.
+This might look very strange to somebody not used to &kde;. However &kde; has 900+
+<acronym>POT</acronym> files to translate for the <acronym>GUI</acronym> messages only.
+So for such a task, much automatisation is wanted. Taking time to set a project
+is little compared to the time gained thereafter. Of course, as non-&kde; user, you
+might be less fortunate. You need to do more settings, as the defaults are not entirely suitable
+and you will not gain much by doing many translations, as &GNU; projects have typically
+only one <acronym>POT</acronym> file to translate.
+</para>
+
+</sect2>
+
+</sect1>
+
+<sect1 id="preferences-global">
+<title>&kbabel; global settings</title>
+
+<para>
+To show the Preferences dialog choose
+<menuchoice><guimenu>Settings</guimenu> <guimenuitem>Configure
+KBabel...</guimenuitem></menuchoice> from &kbabel;'s menu.  It uses a
+structured configuration dialog which makes it very easy to find an
+option without having to perform an extensive search for it.
+</para>
+
 <sect2 id="preferences-editor">
-<title>Editor</title>
+<title>Edit</title>
 <para>
 The editor preferences category is divided in 3 subwindows:
 <guilabel>General</guilabel>, <guilabel>Appearance</guilabel>,
@@ -84,6 +118,16 @@
 <sect3 id="preferences-editor-general">
 <title>General</title>
 
+<screenshot>
+<screeninfo>Dialog Edit General</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_edit_general.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Dialog Edit General</phrase></textobject>
+</mediaobject>
+</screenshot>
+
 <para>This section contains a set of checkboxes.</para>
 
 <para>The first checkbox in the upper side sets if the fuzzy status is
@@ -101,12 +145,14 @@
 <keycap>Tab</keycap> and it allows special handling of
 <keycap>Enter</keycap>.</para>
 
-<para>The lower checkboxes are very useful in assisting, not for the
+<para>
+The lower checkboxes are very useful in assisting, not for the
 correctness of the translation, but if the translated string
 is a suitable replacement for the original.  For
 example, many messages represent menu items with keyboard accelerator
 and C-like formatted strings whose structure must remain intact once
-translated.</para>
+translated.
+</para>
 
 <variablelist>
   <varlistentry>
@@ -126,7 +172,7 @@
 accelerator characters is identical in both the original and the
 translated string.  Note that accelerator marker is &amp; (but not in
 every programming toolkit). See the <link
-linkend="preferences-miscellaneous">Miscellaneous</link> section below
+linkend="preferences-project-miscellaneous">Miscellaneous</link> section below
 to find how to change a keyboard accelerator.</para>
     </listitem>
   </varlistentry>
@@ -168,7 +214,9 @@
     If you are translating &kde; project, it uses a special kind of 
     syntax for specifying plural forms of messages. This check automatically
     counts the number of forms in <acronym>msgstr</acronym> and
-    compares it with the number specified in <link linkend="preferences-identity"><guilabel>Identity</guilabel></link> tab. Incorrect number of plural forms can result in crash of an application.
+    compares it with the number specified in
+<link linkend="preferences-project-identity"><guilabel>Identity</guilabel></link>
+tab. Incorrect number of plural forms can result in crash of an application.
     </para>
     </listitem>
   </varlistentry>
@@ -200,6 +248,16 @@
 <sect3 id="preferences-editor-appearance">
 <title>Appearance</title>
 
+<screenshot>
+<screeninfo>Dialog Edit Appearance</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_edit_appearance.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Dialog Edit Appearance</phrase></textobject>
+</mediaobject>
+</screenshot>
+
 <para>
 These options let
 you configure the appearance for the message editor. In upper part there
@@ -290,7 +348,8 @@
     <listitem><para>
      Keyboard accelerators start with (&amp;) <quote>ampersand</quote>
      character in &kde; but if you are translating for other projects there might be an different character marking the accelerator key.
-     See <link linkend="preferences-miscellaneous">Miscellaneous</link> section below to find how to change keyboard accelerator.
+See <link linkend="preferences-project-miscellaneous">Miscellaneous</link>
+section below to find how to change keyboard accelerator.
     </para></listitem>
   </varlistentry>
 </variablelist>
@@ -306,9 +365,123 @@
 
 </sect3>
 
-<sect3 id="preferences-editor-fonts">
+</sect2>
+
+<sect2 id="preferences-search">
+<title>Search</title>
+
+<screenshot>
+<screeninfo>Dialog Search</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_search.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Dialog Search</phrase></textobject>
+</mediaobject>
+</screenshot>
+
+<para>
+The search section allows you to customize various settings
+for searching in previously translated strings.
+</para>
+
+<para>General settings are common for all search types.  If you check
+the <guibutton>Automatically start search</guibutton> option then the
+search is automatically started whenever you switch to another entry
+in the editor.  Currently, there are three possibilities you can choose
+from, but since &kbabel; can use dictionary plugins the available
+dictionaries depend on those installed.  Using
+<menuchoice><guimenuitem>Settings</guimenuitem> <guimenuitem>Configure
+Dictionary</guimenuitem> <guimenuitem>...</guimenuitem></menuchoice>
+you can configure every search plugin.</para>
+
+<para>The dictionary plugins installed by default are:</para>
+
+<variablelist>
+<varlistentry>
+<term>&kde; Database Search Engine</term>
+<listitem>
+<para>This new method is still in alpha stage of development
+     and is based on &kbabeldict; which accompanies &kbabel;.
+     See &kbabeldict; documentation for further info on
+     configuring the search engine.
+  </para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term>PO Compendium</term>
+<listitem><para>The compendium is a normal <acronym>PO</acronym> file,
+    which should contain a list of standard translations from your translation
+    team. If you don't have one, you can also use a file that contains all
+    the translations from your team (&eg; the <filename>$lang.messages</filename>
+    file in the  &kde; Project, that can be found at
+    <ulink url="http://i18n.kde.org/po_overview/">i18n.kde.org</ulink>).
+  </para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term>PO Auxiliary</term>
+<listitem><para>The auxiliary should help you find the
+    context of a translation by looking up the same message in a message
+    catalog of the same package but translated to another language. This way
+    you can have a look how this message is translated in another language.
+  </para></listitem>
+</varlistentry>
+</variablelist>
+
+<para>
+You can also start searching manually by choosing an
+entry in the popup menu that appears, either by clicking
+<menuchoice>
+<guimenu>Dictionaries</guimenu><guimenuitem>Search Text</guimenuitem>
+<guimenuitem>PO Compendium</guimenuitem></menuchoice>
+or by keeping the search button on the toolbar pressed down for a while.
+</para>
+
+</sect2>
+
+<sect2 id="preferences-diffmode">
+<title>Diff</title>
+
+<screenshot>
+<screeninfo>Dialog Diff</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_diff.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Dialog Diff</phrase></textobject>
+</mediaobject>
+</screenshot>
+
+<para>The <guilabel>Diff</guilabel> section holds settings how to
+display differences in msgids. </para>
+
+<para>Every difference can be displayed by two added parts and by characters removed from the text. For both you can specify the method of display and the color to be used. <guilabel>Highlighted</guilabel> means that the background of the corresponding characters will be shown in the selected color, while 
+<guilabel>Underlined</guilabel>(for added characters) or <guilabel>Stroked Out</guilabel>
+(for removed characters) will denote the changed parts by colored lines.
+</para>
+<para>
+Diff mode needs to find the original <acronym>msgid</acronym> to compare
+with. For this purpose, &kbabel; can use the <link linkend="database">translation database</link>
+if you turn in on by enabling <guilabel>Use messages from Translation Database</guilabel>.
+A second possibility is to use a tree of original PO files and specifying the root of
+the tree in <guilabel>Base folder for diff files</guilabel>.
+</para>
+</sect2>
+
+<sect2 id="preferences-fonts">
 <title>Fonts</title>
 
+<screenshot>
+<screeninfo>Dialog Fonts</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_fonts.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Dialog Fonts</phrase></textobject>
+</mediaobject>
+</screenshot>
+
 <para>
 This is a standard &kde; font chooser dialog with a little addition. You can
 select to view only fixed fonts by checking the
@@ -317,11 +490,196 @@
 font family, style, size and encoding. The bottom box shows a preview of the
 current font for user convenience.
 </para>
-</sect3>
 </sect2>
 
-<sect2 id="preferences-save">
+</sect1>
+
+<sect1 id="preferences-project-wizard">
+<title>New Project Wizard</title>
+
+<sect2 id="preferences-project-wizard-basic">
+<title>Page 1</title>
+
+<screenshot>
+<screeninfo>Project Wizard Page 1</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_wizard_page1.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Project Wizard Page 1</phrase></textobject>
+</mediaobject>
+</screenshot>
+
+<para>
+The first page of the wizard ask about the basic data of the project.
+</para>
+
+<variablelist>
+<varlistentry>
+<term><guilabel>Project name</guilabel></term>
+<listitem><para>
+Enter here the name of the project, as it will be displayed in &kbabel;'s menu.
+</para></listitem>
+</varlistentry>
+<varlistentry>
+<term><guilabel>Configuration file name</guilabel></term>
+<listitem><para>
+Select here a file for holding your project settings.
+</para></listitem>
+</varlistentry>
+<varlistentry>
+<term><guilabel>Language</guilabel></term>
+<listitem><para>
+Select or enter here the language name used by this project.
+</para></listitem>
+</varlistentry>
+<varlistentry>
+<term><guilabel>Project type</guilabel></term>
+<listitem><para>
+Select here the type of your project.
+</para></listitem>
+</varlistentry>
+</variablelist>
+
+</sect2>
+
+<sect2 id="preferences-project-wizard-catman">
+<title>Page 2</title>
+
+<screenshot>
+<screeninfo>Project Wizard Page 2</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_wizard_page2.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Project Wizard Page 2</phrase></textobject>
+</mediaobject>
+</screenshot>
+
+<para>
+The second page of the wizard asks about settings related to the
+Catalog Manager.
+</para>
+
+<variablelist>
+<varlistentry>
+<term><guilabel>Base folder for PO files</guilabel></term>
+<listitem><para>
+Select the base folder where your PO files are.
+</para></listitem>
+</varlistentry>
+<varlistentry>
+<term><guilabel>Base folder for POT files</guilabel></term>
+<listitem><para>
+Select the base folder where your POT files are.
+</para></listitem>
+</varlistentry>
+</variablelist>
+
+<para>
+Type in or select the folders that contains all your <acronym>PO</acronym> and respectively
+<acronym>POT</acronym> files. The files and the folders in these folders will then be
+merged into one tree in &catalogmanager; window.
+</para>
+
+
+</sect2>
+
+<sect2>
+<title>Checking Project Stettings</title>
+
+<important><para>
+As written earlier in this chapter, unfortunately the wizard is very simple and
+therefore fails to ask for some important settings.
+</para></important>
+
+<para>
+Now that you have <quote>finished</quote> your new project, you should verify the main settings in
+<menuchoice><guimenu>Project</guimenu> <guimenuitem>Configure...</guimenuitem></menuchoice>.
+Especially select the <guilabel>Identity</guilabel> page and fix the team email address in
+<guilabel>Language mailing list</guilabel>.
+(The default one created by the wizard from the language setting is only useful if you are part of a &GNU; project.)
+</para>
+
+<para>
+If the project settings are not for KDE, it is recommended that you check the
+<guilabel>Save</guilabel> page and checks the settings there.
+</para>
+
+</sect2>
+
+</sect1>
+
+<sect1 id="preferences-project-settings">
+<title>Project Settings</title>
+
+<para> To show the project setting dialog choose
+<menuchoice><guimenu>Project</guimenu> <guimenuitem>Configure...</guimenuitem></menuchoice>
+from &kbabel;'s or &catalogmanager;'s menu.  It uses a
+structured configuration dialog which makes it very easy to find an
+option without having to perform an extensive search for it.</para>
+
+<para>The left side of the preferences dialog lists the categories of
+customizable items and the right side shows the corresponding tab for
+the selected category.  &kbabel; keeps changes if you move between
+categories, so when you're finally happy click the
+<guibutton>OK</guibutton> button.  At any time you can use quick
+help&mdash;just click on the question mark on the title bar and,
+after the cursor has changed to an arrow with a question mark,
+click on a button, label, or preference entry to find out more
+about it.</para>
+
+<note><para>
+Pages for settings for &kbabel; (the editor) and for &catalogmanager;
+are in the list.
+</para></note>
+
+<sect2 id="preferences-project-identity">
+<title>Identity</title>
+
+<para>These settings are for &kbabel;.</para>
+
+<para>This section allows you to set standard fields for every
+translated <acronym>PO</acronym> file.  These are your name, email
+address, full language name, email address for your translation team
+mailing list.  There is also a timezone field to track your
+<quote>last modified</quote> time for <acronym>PO</acronym> files.
+You can specify it as character sequence like <acronym>EEST</acronym>
+or offset from <acronym>GMT</acronym> time like +0200 (&ie; for
+Romania).  This information is used when updating file headers.  You
+can find the options that control what fields in the header should be
+updated in the <link linkend="preferences-project-save">Save</link> section of
+the Preferences dialog.</para>
+
+<warning><para>Character sequences for timezones are not standardized.
+So you should not use the string set here in time specification for
+saving in <link linkend="preferences-project-save">Save</link> tab. You should
+use <literal>%z</literal> instead.</para></warning>
+
+<variablelist>
+<varlistentry>
+<term><guilabel>Number of singular/plural forms</guilabel></term>
+<listitem>
+<para> Use this for setting number of plural forms for your
+language. For example, it is 2 for German (one for the singular and
+one for the plural form).</para>
+
+<note><para>This feature is currently implemented only for plural forms format  used in &kde;. It does not work with &GNU; gettext plural forms.</para></note> 
+</listitem>
+</varlistentry>
+</variablelist>
+
+</sect2>
+
+<sect2 id="preferences-project-save">
 <title>Save</title>
+
+<para>These settings are for &kbabel;.</para>
+
+<para><remark>
+TODO This seems to document only the "General" tab but not the "Header" and "Copyright" ones
+</remark></para>
+
 <para>
 This section allows you to edit the options for <acronym>PO</acronym> file saving. The first 
 group of checkboxes controls general behavior for actions
@@ -349,12 +707,12 @@
 Check this to automatically check syntax of file with
 <userinput><command>msgfmt</command> --statistics</userinput> when
 saving a file. You will only get a message if an error occurred. You
-should keep this validation enabled unless you know what you're doing.
+should keep this validation enabled unless you know what you are doing.
     </para></listitem>
   </varlistentry>
 </variablelist>
 
-<para>If you don't want to touch some fields in a <acronym>PO</acronym>
+<para>If you do not want to touch some fields in a <acronym>PO</acronym>
 file header or want to force updating of specific fields, there are five
 checkboxes which control this: revision date, <acronym>PO</acronym> file
 language, text encoding, last translator name, charset. If a field
@@ -366,9 +724,15 @@
 want to have the header updated.</para>
 
 <para>For date and time of the header field
-<emphasis>PO-Revision-Date</emphasis> you can choose one from bellow
-formats:</para>
+<emphasis>PO-Revision-Date</emphasis> you can choose one of the
+formats: <guilabel>Default</guilabel>, <guilabel>Local</guilabel>, <guilabel>Custom</guilabel>.</para>
 
+<important><para>
+You should keep the default setting of <guilabel>Default</guilabel>. The two other settings
+make that the generated <acronym>PO</acronym> file is not a standard &GNU; gettext <acronym>PO</acronym> file
+anymore, so this should be avoided.
+</para></important>
+
 <itemizedlist>
   <listitem><para>
     <guilabel>Default</guilabel> is the format normally used in <acronym>PO</acronym> files.
@@ -496,20 +860,32 @@
   </para></listitem>
 </itemizedlist>
 
+<note><para>
+The option to select the date format for the <acronym>PO</acronym> file is considered to be deprecated,
+and will probably be removed in a future version of KBabel.
+</para></note>
+
 <para>The lower group covers encoding options for <acronym>PO</acronym>
 files when saving. If you work on the &kde; project you should be aware
-that at least <filename>desktop.po</filename> file
-<emphasis>must</emphasis> be UTF-8 encoded. The drop-down list lets you select
-message encoding. You must at least have your language code and UTF-8 encoding set.
-If, for some reason, you don't want to accidentally change the current PO
+that at least <acronym>PO</acronym> files <emphasis>must</emphasis> be UTF-8 encoded in &kde;.
+Alternatively you can select the encoding corresponding to your locale.
+If, for some reason, you do not want to accidentally change the current PO
 file encoding, turn on <guibutton>Keep the encoding of the
 file</guibutton>.</para>
 
+<caution><para>
+For reason of informtation interchange, &GNU; gettext limits the encodings allowed for a
+<acronym>PO</acronym> file. &kbabel; does not know of this restriction, so the encoding
+correspondig to your locale might not be suitable. (UTF-8 is always supported by &GNU; gettext.)
+</para></caution>
+
 </sect2>
 
-<sect2 id="preferences-spellcheck">
+<sect2 id="preferences-project-spellcheck">
 <title>Spell Check</title>
 
+<para>These settings are for &kbabel;.</para>
+
 <para>Here you can set your spell checking preferences.  This is of 
 interest if you have a dictionary file for the language you are 
 translating to. Below are the items to consider setting:</para>
@@ -543,13 +919,24 @@
   </varlistentry>
   <varlistentry>
     <term><guilabel>Encoding</guilabel></term>
-    <listitem><para>
+    <listitem>
+<para>
     Here you choose the encoding for your text.  This option is passed
     to the spellchecker, and is used as the encoding for your words
     dictionary.
     See the <ulink url="help:/kspell">kspell</ulink> documentation for
     more details.
-    </para></listitem>
+</para>
+<note><para>
+The encoding selected here is not linked to encodings of the
+<acronym>PO</acronym> files. Depending on the spellchecker
+(especially in the case of  <command>ispell</command>),
+you might not have much choice for the encoding.
+(For example, a few Western European languages can only work
+with <command>ispell</command> when using ISO-8859-1.)
+</para></note>
+    </listitem>
+
   </varlistentry>
   <varlistentry>
     <term><guilabel>Client</guilabel></term>
@@ -570,104 +957,190 @@
     <listitem><para>    
     Here you can set location of the file for ignored words. Click
     on the folder icon to the right of the edit box.  The default is
-    <filename>$(HOME)/.kde/share/apps/kbabel/spellignores</filename>,
-    where <filename>$(HOME)</filename> is your home folder.
+    <filename>$<envar>HOME</envar>/.kde/share/apps/kbabel/spellignores</filename>,
+    where <filename>$<envar>HOME</envar></filename> is your home folder.
     </para></listitem>
   </varlistentry>
 </variablelist>
 </sect2>
 
-<sect2 id="preferences-search">
-<title>Search</title>
+<sect2 id="preferences-project-source">
+<title>Source reference</title>
+
+<para>These settings are for &kbabel;.</para>
+
+<screenshot>
+<screeninfo>Project Settings, source reference</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_proj_source.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Project Settings, source reference</phrase></textobject>
+</mediaobject>
+</screenshot>
+
 <para>
-The search section allows you to customize various settings
-for searching in previously translated strings.
+This dialog is for setting how KBabel should construct the full path from each source references,
+which are in the comments of each entry of a <acronym>PO</acronym> file.
 </para>
 
-<sect3 id="preferences-search-general">
-<title>General</title>
+<sect3>
+<title>Dialog elements</title>
 
-<para>General settings are common for all search types.  If you check
-the <guibutton>Automatically start search</guibutton> option then the
-search is automatically started whenever you switch to another entry
-in the editor.  Currently, there are three possibilities you can choose
-from, but since &kbabel; can use dictionary plugins the available
-dictionaries depend on those installed.  Using
-<menuchoice><guimenuitem>Settings</guimenuitem> <guimenuitem>Configure
-Dictionary</guimenuitem> <guimenuitem>...</guimenuitem></menuchoice>
-you can configure every search plugin.</para>
+<para>
+In the edit line <guilabel>Base folder for source code</guilabel>, you can set a
+base folder where the source code of your project is. This defines the value of the variable
+<userinput>@CODEROOT@</userinput>, which is described below.
+</para>
 
-<para>The dictionary plugins installed by default are:</para>
+<para>
+In the group <guilabel>Path Patterns</guilabel>, you can define patterns or rules
+to construct the paths with the help of a few variables:
+<userinput>@CODEROOT@</userinput>, <userinput>@PACKAGEDIR@</userinput>,
+<userinput>@PACKAGE@</userinput>, <userinput>@COMMENTPATH@</userinput>,
+<userinput>@POFILEDIR@</userinput>, which are defined below.
+</para>
 
-<variablelist>
-<varlistentry>
-<term>&kde; Database Search Engine</term>
-<listitem>
-<para>This new method is still in alpha stage of development
-     and is based on &kbabeldict; which accompanies &kbabel;.
-     See &kbabeldict; documentation for further info on
-     configuring the search engine.
-  </para></listitem>
-</varlistentry>
+<note><para>
+The variable <userinput>@PODIRFILE@</userinput> was introduced in &kbabel; version 1.11.1 (for &kde; 3.5.1).
+</para></note>
 
-<varlistentry>
-<term>PO Compendium</term>
-<listitem><para>The compendium is a normal <acronym>PO</acronym> file,
-    which should contain a list of standard translations from your translation
-    team. If you don't have one, you can also use a file that contains all
-    the translations from your team (&eg; the <filename>$lang.messages</filename>
-    file in the  &kde; Project, that can be found at
-    <ulink url="http://i18n.kde.org/po_overview/">i18n.kde.org</ulink>).
-  </para></listitem>
-</varlistentry>
+<para>
+With the button <guibutton>Add</guibutton>, you can add the line from the text box
+to the list of used path patterns. With the button <guibutton>Remove</guibutton>,
+you can remove the selected pattern from the list. With the buttons
+<guibutton>Up</guibutton> and <guibutton>Down</guibutton>, you can change the priority of
+the path patterns.
+</para>
 
-<varlistentry>
-<term>PO Auxiliary</term>
-<listitem><para>The auxiliary should help you find the
-    context of a translation by looking up the same message in a message
-    catalog of the same package but translated to another language. This way
-    you can have a look how this message is translated in another language.
-  </para></listitem>
-</varlistentry>
-</variablelist>
+</sect3>
 
+<sect3>
+<title>The variables</title>
+
+<itemizedlist>
+<listitem><para>
+<userinput>@CODEROOT@</userinput>: The base folder of the source code.
+</para></listitem>
+<listitem><para>
+<userinput>@PACKAGEDIR@</userinput>: The folder of the package (i.e. <acronym>PO</acronym> file).
+</para></listitem>
+<listitem><para>
+<userinput>@PACKAGE@</userinput>: The package name (i.e. <acronym>PO</acronym> file name without extension).
+</para></listitem>
+<listitem><para>
+<userinput>@POFILEDIR@</userinput>: The folder of the <acronym>PO</acronym> file.
+</para></listitem>
+<listitem><para>
+<userinput>@COMMENTPATH@</userinput>: The relative path given as source reference in the comment of an entry of the <acronym>PO</acronym> file.
+</para></listitem>
+</itemizedlist>
+
+<important><para>
+The variables <userinput>@PACKAGEDIR@</userinput> and <userinput>@POFILEDIR@</userinput> have similar
+meaning but not the same result. The variable <userinput>@POFILEDIR@</userinput>
+will always hold the folder of <acronym>PO</acronym> file,
+<userinput>@PACKAGEDIR@</userinput> might not. If the <acronym>PO</acronym> file was loaded
+by the help of the &catalogmanager; then <userinput>@PACKAGEDIR@</userinput> has only the part of
+the path, based on the <acronym>PO</acronym> base path defined for the &catalogmanager;
+<link linkend="preferences-project-folders">(see below)</link>.
+</para></important>
+
+<note><para>
+The variables <userinput>@CODEROOT@</userinput> and <userinput>@POFILEDIR@</userinput> can only be used at
+the beginning of a pattern to be useful. The variable <userinput>@COMMENTPATH@</userinput> can only be used at the
+end of a pattern and is nearly mandatory.
+The variables <userinput>@PACKAGEDIR@</userinput> and <userinput>@POFILEDIR@</userinput>
+should not be used in the same pattern. The variables <userinput>@CODEROOT@</userinput> and <userinput>@POFILEDIR@</userinput> should not be used in the same pattern either.
+</para></note>
+
+</sect3>
+
+<sect3>
+<title>The default path patterns</title>
+
 <para>
-You can also start searching manually by choosing an
-entry in the popup menu that appears, either by clicking
-<menuchoice>
-<guimenu>Dictionaries</guimenu><guimenuitem>Search Text</guimenuitem>
-<guimenuitem>PO Compendium</guimenuitem></menuchoice>
-or by keeping the search button on the toolbar pressed down for a while.
+From &kbabel; 1.11.1 (of &kde; 3.5.1) on, there are five default path patterns:
 </para>
+
+<itemizedlist>
+<listitem><para>
+<userinput>@PACKAGEDIR@</userinput>/<userinput>@PACKAGE@</userinput>/<userinput>@COMMENTPATH@</userinput>
+</para></listitem>
+<listitem><para>
+<userinput>@CODEROOT@</userinput>/<userinput>@PACKAGEDIR@</userinput>/<userinput>@PACKAGE@</userinput>/<userinput>@COMMENTPATH@</userinput>
+</para></listitem>
+<listitem><para>
+<userinput>@CODEROOT@</userinput>/<userinput>@PACKAGE@</userinput>/<userinput>@COMMENTPATH@</userinput>
+</para></listitem>
+<listitem><para>
+<userinput>@POFILEDIR@</userinput>/<userinput>@COMMENTPATH@</userinput>
+</para></listitem>
+<listitem><para>
+<userinput>@POFILEDIR@</userinput>/../<userinput>@COMMENTPATH@</userinput>
+</para></listitem>
+</itemizedlist>
+
+<note><para>
+&kde; projects need typically the third pattern.
+The last pattern is typical for &GNU; projects, where the source references are related to
+the parent of the directory where the PO file is.
+</para></note>
+
 </sect3>
 
-</sect2>
+<sect3>
+<title>Creating New Path Patterns</title>
 
-<sect2 id="preferences-diffmode">
-<title>Diff</title>
+<para>
+In most cases the default path patterns should be enough, whatever
+the project is for KDE (assuming that you have set the correct base directory)
+or if the project is a &GNU; one (or structured like a &GNU; project).
+</para>
 
-<para>The <guilabel>Diff</guilabel> section holds settings how to
-display differences in msgids. </para>
+<note><para>
+For &kde;, some <acronym>PO</acronym> files do not contain enough information
+(including the file path and name) for &kbabel; to find the right source file
+that is supposed to be refered. To fix that you would need precise path patterns
+for such files, which is nearly impossible to define by the numbers of such files
+in &kde;. But if you work often with such a file, may be it is worth to set
+a path pattern explicitely for supporting that <acronym>PO</acronym> file.
+</para></note>
 
-<para>Every difference can be displayed by two added parts and by characters removed from the text. For both you can specify the method of display and the color to be used. <guilabel>Highlighted</guilabel> means that the background of the corresponding characters will be shown in the selected color, while 
-<guilabel>Underlined</guilabel>(for added characters) or <guilabel>Stroked Out</guilabel>
-(for removed characters) will denote the changed parts by colored lines.
+<para>
+For creating your own path patterns, you can use the variables defined above,
+but apart <userinput>@COMMENTPATH@</userinput> not any variable is mandatory to use.
+(To be exact, <userinput>@COMMENTPATH@</userinput> is not mandatory either,
+but not using it will probably lead to no result.)
 </para>
+
 <para>
-Diff mode needs to find the original <acronym>msgid</acronym> to compare
-with. For this purpose, &kbabel; can use the <link linkend="database">translation database</link>
-if you turn in on by enabling <guilabel>Use messages from Translation Database</guilabel>.
-A second possibility is to use a tree of original PO files and specifying the root of
-the tree in <guilabel>Base folder for diff files</guilabel>.
+An example of path pattern could be that you want to display the source reference
+of &kde;'s file desktop_kdebase.po. In that case you will probably need a path  pattern like:
+<userinput>@CODEROOT@</userinput>/<userinput>@PACKAGEDIR@</userinput>/kdebase/<userinput>@COMMENTPATH@</userinput>
+(compared to one of the default path patterns, the sequence <userinput>@PACKAGE@</userinput> has been
+replaced by kdebase).
 </para>
+
+<para>
+In case of really complex problems you can, of course, define an absolute path
+without any variables beside <userinput>@COMMENTPATH@</userinput>, like for example:
+/home/usr/kde-source/kdebase/<userinput>@COMMENTPATH@</userinput> assuming that
+/home/usr/kde-source/kdebase is the path where the kdebase source module is.
+</para>
+
+</sect3>
+
 </sect2>
 
+<sect2 id="preferences-project-miscellaneous">
+<title>Miscellaneous</title>
 
-<sect2 id="preferences-miscellaneous">
-<title>Miscellaneous</title>
+<para>These settings are for &kbabel;.</para>
+
 <para>
 <guilabel>Miscellaneous</guilabel> section
-holds settings which don't fit anywhere else. Currently there are two:
+holds &kbabel; settings that do not fit anywhere else.
 </para>
 
 <variablelist>
@@ -701,22 +1174,17 @@
 </variablelist>
 </sect2>
 
+<!-- Catalog Manager project settings -->
 
-</sect1>
+<sect2 id="preferences-project-folders">
+<title>Project folders</title>
 
-<sect1 id="preferences-catalogmanager">
-<title>&catalogmanager; preferences</title>
+<para>These settings are for &catalogmanager;.</para>
 
 <para>
-This dialog allows you to edit the options for the Catalog Manager.
-</para>
-
-<sect2 id="preferences-catalogmanager-general">
-<title>General</title>
-<para>
-Here are two edit lines with <guibutton>Browse...</guibutton> buttons.
-Type in the folders which contains all your <acronym>PO</acronym>- and respectively
-<acronym>POT</acronym>-files. The files and the folders in these folders will then be
+Here are two edit lines with folder buttons.
+Type in or select the folders that contains all your <acronym>PO</acronym> and respectively
+<acronym>POT</acronym> files. The files and the folders in these folders will then be
 merged into one tree in Catalog Manager window.
 </para>
 
@@ -756,8 +1224,21 @@
 </variablelist>
 </sect2>
 
-<sect2 id="preferences-catalogmanager-folders">
+<sect2 id="preferences-project-folder-commands">
 <title>Folder Commands</title>
+
+<para>These settings are for &catalogmanager;.</para>
+
+<screenshot>
+<screeninfo>Project Settings,folder commands</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_proj_folder_commands.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Project Settings, folder commands</phrase></textobject>
+</mediaobject>
+</screenshot>
+
 <para>
 Here you can insert commands you want to execute in folders from the
 Catalog Manager. The commands are then shown in the submenu
@@ -765,8 +1246,8 @@
 in the Catalog Manager's context menu.
 
 </para><para>
-Insert in the <guilabel>Name</guilabel> field the
-name of the command. The name can be chosen freely and is only used to be displayed
+Insert in the <guilabel>Command Label</guilabel> field the
+label of the command. The label can be chosen freely and is only used to be displayed
 in the menu. In the <guilabel>Command</guilabel> field insert the command you want to
 have executed when selecting the corresponding menu item. Then press the <guibutton>Add</guibutton>
 button to add the command to your available commands.
@@ -810,8 +1291,21 @@
 </para>
 </sect2>
 
-<sect2>
+<sect2 id="preferences-project-file-commands">
 <title>File Commands</title>
+
+<para>These settings are for &catalogmanager;.</para>
+
+<screenshot>
+<screeninfo>Project Settings, file commands</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_proj_file_commands.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Project Settings, file commands</phrase></textobject>
+</mediaobject>
+</screenshot>
+
 <para>
 Here you can insert the commands you want to execute on files from the Catalog
 Manager. The commands are then shown in the submenu
@@ -820,7 +1314,7 @@
 </para>
 
 <para>
-Insert in the <guilabel>Name</guilabel> field the name of the command. The name can be
+Insert in the <guilabel>Command Label</guilabel> field the label of the command. The label can be
 chosen freely and is only used to be displayed in the menu. In the 
 <guilabel>Command</guilabel> field insert the command you want to have executed when
 selecting the corresponding menu item. Then press the <guibutton>Add</guibutton> button
@@ -870,6 +1364,45 @@
 from a file's context menu, the <acronym>PO</acronym> file will be merged with its template file.
 </para>
 </sect2>
+
+<sect2 id="preferences-project-catalog-manager">
+<title>Catalog Manager</title>
+
+<para>These settings are for &catalogmanager;.</para>
+
+<screenshot>
+<screeninfo>Project Settings, &catalogmanager;</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_proj_catman.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Project Settings, &catalogmanager;</phrase></textobject>
+</mediaobject>
+</screenshot>
+
+<para>The checkboxes switches on or off the corresponding column of the &catalogmanager;'s view.</para>
+
+</sect2>
+
+<sect2 id="preferences-project-diff">
+<title>Diff</title>
+
+<para>These settings are for &catalogmanager;.</para>
+
+<screenshot>
+<screeninfo>Project Settings, diff</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="pref_proj_diff.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Project Settings, diff</phrase></textobject>
+</mediaobject>
+</screenshot>
+
+<para><remark>TODO</remark></para>
+
+</sect2>
+
 </sect1>
 </chapter>
 <!--
Index: doc/kbabel/catman.docbook
===================================================================
--- doc/kbabel/catman.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/catman.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -38,6 +38,21 @@
 entries, number of fuzzy entries, number of untranslated entries, the
 date of the last revision and the last translator of the file.
 </para>
+
+<important><para>
+KBabel's Catalog Manager is meant for projects structured like KDE,
+where the <acronym>POT</acronym> and <acronym>PO</acronym> files
+share a same name, save the extensions. However this is not the
+case of &GNU; projects and of many projects structured like &GNU; ones.
+Typically in such projects, the <acronym>PO</acronym> file is named
+following the language code and so is very different than the name
+of the <acronym>POT</acronym> files. Also such projects have
+one <acronym>POT</acronym> file sharing a directory with all its
+translated <acronym>PO</acronym> files. Unfortunately, all these reasons
+mean that the Catalog Manager is <emphasis>not</emphasis> suitable for
+such projects. (See <ulink url="http://bugs.kde.org/show_bug.cgi?id=76495">KDE bug #76495</ulink>.)
+</para></important>
+
 <para>
 To make it easier for you to find files that need work or are
 missing the status of each file is also displayed using an icon:
@@ -125,9 +140,9 @@
 action="simul">&Ctrl;<keycap>O</keycap> </keycombo>.</para>
 
 <para>You can configure the &catalogmanager; by
-<menuchoice><guimenu>Settings</guimenu><guimenuitem>
-Configure &catalogmanager;...</guimenuitem></menuchoice>.
-See section <link linkend="preferences-catalogmanager">Preferences</link> for more
+<menuchoice><guimenu>Project</guimenu><guimenuitem>
+Configure...</guimenuitem></menuchoice>.
+See section <link linkend="preferences-project-settings">Project Settings</link> for more
 details.</para>
 
 <sect1 id="catman-features">
@@ -176,10 +191,11 @@
 Because &catalogmanager; cannot provide any functionality you would like
 to use, you can extend it by defining your own commands.
 </para>
+<!-- ### TODO: we should lik to preferences-project-file-commands too -->
 <para>
 There are two sets of commands. One for folders and one for single files.
 You can set them in <link
-linkend="preferences-catalogmanager">configuration dialog </link> and
+linkend="preferences-project-folder-commands">configuration dialog </link> and
 access by pressing &RMB; on an entry in the file list.</para>
 </sect2>
 
Index: doc/kbabel/pref_proj_folder_commands.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_proj_folder_commands.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/index.docbook
===================================================================
--- doc/kbabel/index.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/index.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -26,12 +26,17 @@
 <author>
 &Matthias.Kiefer;
 </author>
+<author>
+<firstname>Nicolas</firstname>
+<surname>Goutte</surname>
+<email>goutte@kde.org</email>
+</author>
 <!-- TRANS:ROLES_OF_TRANSLATORS -->
 </authorgroup>
 
 
-<date>2003-09-18</date>
-<releaseinfo>3.1.91</releaseinfo>
+<date>2005-12-29</date>
+<releaseinfo>3.5.1.03</releaseinfo>
 
 <abstract>
 <para>
@@ -51,7 +56,9 @@
 <keyword>gettext</keyword>
 <keyword>translation</keyword>
 <keyword>i18n</keyword>
+<keyword>internationalization</keyword>
 <keyword>l10n</keyword>
+<keyword>localization</keyword>
 </keywordset>
 
 </bookinfo>
@@ -59,6 +66,12 @@
 <chapter id="introduction">
 <title>Introduction</title>
 
+<important><para>
+In its current state, this KBabel documentation is partially outdated.
+The basic documentation was meant for KDE 3.2,
+the corrections are meant for KBabel 1.11.1 of KDE 3.5.1.
+</para></important>
+
 <para>
 &kbabel; is an advanced and easy to use <acronym>PO</acronym> file
 (&GNU; gettext message catalogs) editor. It has many features, that
@@ -117,6 +130,9 @@
 <para>Update for &kde; 3.0 Copyright &copy; 2002 &Stanislav.Visnovsky;
 &Stanislav.Visnovsky.mail;</para>
 
+<para>Update for &kde; 3.5.1 Copyright &copy; 2005 Nicolas Goutte
+<email>goutte@kde.org</email></para>
+
 <!-- TRANS:CREDIT_FOR_TRANSLATORS -->
 
 &underFDL;
@@ -126,42 +142,26 @@
 
 &glossary;
 
-<appendix id="installation">
-<title>Installation</title>
+<appendix id="mailing-list">
+<title>Mailing List For KBabel</title>
 
-<sect1 id="getting-kbabel">
-<title>How to obtain &kbabel;</title>
-
-&install.intro.documentation;
-
-</sect1>
-
-<sect1 id="requirements">
-<title>Requirements</title>
-
 <para>
-In order to successfully use &kbabel;, you need &kde; 3.x.
+There is a mailing list for KBabel named kbabel.
+It is a mixed list for developers and for users of KBabel.
 </para>
 
 <para>
-All required libraries as well as &kbabel; itself can be found
-on &kde-ftp;.
+You can subscribe it at 
+<ulink url="http://mail.kde.org/mailman/listinfo/kbabel/">the Mailman interface</ulink>.
 </para>
 
 <para>
-If you want to use the translation database, you need Berkeley Database II.
+The mailing list has
+<ulink url="http://mail.kde.org/pipermail/kbabel/">a public archive</ulink>.
 </para>
 
-</sect1>
+</appendix>
 
-<sect1 id="compilation">
-<title>Compilation and Installation</title>
-
-&install.compile.documentation;
-
-</sect1>
-
-</appendix>
 &documentation.index;
 </book>
 
Index: doc/kbabel/pref_fonts.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_fonts.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/pref_proj_file_commands.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_proj_file_commands.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/pref_proj_source.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_proj_source.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/man-catalogmanager.1.docbook
===================================================================
--- doc/kbabel/man-catalogmanager.1.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/man-catalogmanager.1.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -5,7 +5,7 @@
 
 <refentry lang="&language;">
 <refentryinfo>
-<date>March 7, 2003</date>
+<date>2003-03-07</date>
 </refentryinfo>
 
 <refmeta>
Index: doc/kbabel/pref_proj_catman.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_proj_catman.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/kbabeldict.docbook
===================================================================
--- doc/kbabel/kbabeldict.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/kbabeldict.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -4,6 +4,8 @@
 <!-- standalone.  Be sure to recomment them before attempting to -->
 <!-- process index.docbook -->
 
+<!-- Note: the id attribute "using-kbabeldict" is used in KBabelDict's source code to call the help.
+So if you change this id attribute, the name *must* be changed in KBabelDict's source code too! -->
 <chapter id="using-kbabeldict">
 <chapterinfo>
 <!-- Fill in this section if this document has a different author -->
Index: doc/kbabel/pref_edit_appearance.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_edit_appearance.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/pref_search.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_search.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/using.docbook
===================================================================
--- doc/kbabel/using.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/using.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -30,7 +30,7 @@
 includes translating the program's interfaces and documentation to the
 various languages users need and, in some countries or regions, making
 the inputs and outputs conform to particular conventions.  &kbabel; is
-a tool which will assist you in the internationalization process to
+a tool which will assist you in the localization process to
 make an application's interface speak many languages.</para>
 
 <para> Every internationalization-aware program makes available for
@@ -39,33 +39,33 @@
 <acronym>POT</acronym> is an acronym for <quote>Portable Object
 Template</quote>.</para>
 
-
-<para> Every translator takes a <acronym>POT</acronym> file copy and
-begins translating messages. This file will became a
-<acronym>PO</acronym> file - Portable Object and represents only one
-language.</para>
-
-<para> Each translator takes a copy of one of these POT templates and
-begins filling in the blanks: each message is translated into the
+<para>
+Each translator takes a copy of one of these <acronym>POT</acronym> templates and
+begins to fill in the blanks: each message is translated into the
 language desired.  The file containing the translated text is referred
-to as a <acronym>PO</acronym> (Portable Object) file.  </para>
+to as a <acronym>PO</acronym> (Portable Object) file.
+</para>
 
-<para> Once all the messages have been translated, the
+<para>
+Once all the messages have been translated, the
 <acronym>PO</acronym> file is compiled into a machine-readable binary
 format, known as a <acronym>MO</acronym> (Machine Object) file.  These
 files, which will be stored with a <literal
-role="extension">.mo</literal> extension, act as a database to
+role="extension">.mo</literal> extension
+(or a <literal role="extension">.gmo</literal> extension to show
+that they were processed by &GNU; gettext), act as a database to
 minimize the time taken by the applications to look up each translated
-message.  </para>
+message.
+</para>
 
 <para> This suggests a question: do I need to know what is
 inside a <acronym>PO</acronym> file even though I have &kbabel;?  The
 answer is, undoubtedly, yes.  There are situations when a message
 catalog can become corrupted and needs to be manually fixed.  Most of
-these problems are the so-hated <acronym>CVS</acronym> conflicts which
-occur when a translating process is coordinated by a concurrent version
-system (see the <ulink url="info:/cvs">CVS</ulink> documentation).
-&kbabel; can't help you very much if a problem like this arises so a
+these problems are the so-hated <acronym>CVS</acronym> or <acronym>SVN</acronym> conflicts which
+occur when a translating process is coordinated by a version management
+system, like <acronym>CVS</acronym> or Subversion (<acronym>SVN</acronym>).
+&kbabel; cannot help you much if a problem like this arises so a
 text editor and some knowledge of <acronym>PO</acronym>-files are
 needed. Let's see how a <acronym>PO</acronym> file is made.</para>
 
@@ -77,11 +77,13 @@
 from a <acronym>PO</acronym> file for &noatun;, is <literal>msgid
 &quot;Open a Playlist&quot;</literal> </para>
 
+<!-- ### TODO: we would need an example of an entry -->
+
 <para>Empty lines and those starting with <literal>#</literal> are
 ignored.  Lines starting with a # represent comments and are a useful
-means of providing a note detailing which file this message is going
+way of providing a note detailing which file this message is going
 to be used in and, in the case of the application writers, to provide
-additional comments to aide translation.  &kbabel; displays these
+additional comments to help translation.  &kbabel; displays these
 comment lines for every message.</para>
 
 <para>In many cases the first msgid-msgstr pair in
@@ -91,33 +93,49 @@
 application name, translating date, translator name and so on.</para>
 
 <para>
-Recent versions of <application>&GNU; gettext</application> added
-another useful i18n feature called <emphasis>plural forms</emphasis>.
+An useful feature is called <emphasis>plural forms</emphasis>.
 English uses only singular and one plural form of nouns, &eg; <quote>1 file
 </quote> and <quote>10 files</quote>. This leads many developers
 to an idea that the world is that simple and they can use messages like
 <quote>Do you want to delete %1 file(s)?</quote>, where
 <literal>%1</literal> denotes a number of files to be deleted.
-But this is fundamentally wrong. For Slovak translation you need 3 different
+But this is fundamentally wrong and for many languages such a kind of translation
+will not work. For Slovak translation you need 3 different
 forms of the message. This number is  different for different languages
 and even when it is the same, &eg; Czech uses 3 forms as well, the rule to decide which
-form to use can be very different.
+form to use can be very different. Plural forms in <acronym>PO</acronym> files are here to help.
 </para>
-<para>
-Plural forms in <acronym>PO</acronym> files are here to help. Unfortunately,
-&kde; developers do not like the plural forms implementation in
+
+<note><para>
+&kde; developers have chosen a different implementation for the plural forms than
 <application>&GNU; gettext</application> and they have introduced their own
 format and handling for them.
-</para>
+It is planned to use &GNU; gettext's plural forms in &kde; version 4.
+</para></note>
+
 </sect1>
 
 <sect1 id="using-editor">
 <title>Editor</title>
 
-<para>Here is a screenshot of &kbabel;.  For convenience &kbabel; has
+<para>Here is a screenshot of &kbabel;.</para>
+
+<screenshot>
+<screeninfo>Screenshot of &kbabel;</screeninfo>
+<mediaobject>
+<imageobject>
+<imagedata fileref="snap1.png" format="PNG"/>
+</imageobject>
+<textobject><phrase>Screenshot of &kbabel;</phrase></textobject>
+</mediaobject>
+</screenshot>
+
+<para>
+For convenience &kbabel; has
 toolbars to speed up many operations and, for busy users, there are
 many keyboard shortcuts.  The main window is divided into four
-parts.</para>
+parts.
+</para>
 
 <para>The <emphasis>upper-left</emphasis> edit box is read-only and
 contains the current msgid field from the opened PO-file and its
@@ -150,16 +168,6 @@
 </para></listitem>
 </itemizedlist>
 
-<screenshot>
-<screeninfo>Screenshot of &kbabel;</screeninfo>
-<mediaobject>
-<imageobject>
-<imagedata fileref="snap1.png" format="PNG"/>
-</imageobject>
-<textobject><phrase>Screenshot of &kbabel;</phrase></textobject>
-</mediaobject>
-</screenshot>
-
 <para>
 The editor window (in the bottom right) is the most sophisticated part
 of &kbabel;'s main window.  Its size can be
@@ -341,7 +349,7 @@
 </informaltable>
 <note>
 <para>
-If you want to see where are spaces, you can turn on <guibutton>Highlight background</guibutton>
+If you want to see where spaces are, you can turn on <guibutton>Highlight background</guibutton>
 and/or <guibutton>Mark whitespaces with points</guibutton> in preferences dialog
 on tab <guilabel>Edit</guilabel> <guilabel>Appearance</guilabel>.
 </para>
@@ -442,7 +450,7 @@
      <listitem>
        <para>
        This invokes <command>msgfmt</command> to check validity of the PO file
-       as seen by gettext package. It will show the result of the command
+       as seen by &GNU; gettext package. It will show the result of the command
        and mark error <acronym>msgstr</acronym>s.
        </para>
      </listitem>
@@ -506,6 +514,7 @@
        must use this special format as well. This means that the translation must start (up to the
        first occurrence of <literal>=</literal> with the same text as the original message, &eg;
        <userinput>Name=</userinput>.
+       <!-- ### TODO: is this feature is specific to KDE too? How does e.g. GNOME translate them? -->
        </para>
      </listitem>
    </varlistentry>
@@ -517,8 +526,7 @@
 <para>As always, it is very important to spell-check your translation before
 using your result. This way you can find typos and other problems in your translation.
 &kbabel; uses the standard &kde; library for spellchecking and its standard
-settings can be found in <link linkend="preferences-spellcheck">the &kbabel;
-configuration dialog</link>. Spell checking itself can be found in
+settings can be found in <link linkend="preferences-project-spellcheck">the project setting dialog</link>. Spell checking itself can be found in
 <menuchoice><guimenu>Tools</guimenu><guisubmenu>Spelling</guisubmenu>
 </menuchoice> submenu.
 You can use a number of modes for spell checking:
@@ -719,22 +727,32 @@
 <title>Plural Forms</title>
 <para>
 Because plural forms are quite a complicated issue, we devote a special section
-for their suport in &kbabel;.
+for their support in &kbabel;.
 </para>
+
+<note><para>
+This section handles about &kde; plural forms (to be precise of &kde; version 3).
+From &kbabel; version 1.11 (KDE 3.5) on, &kbabel; should be able to
+read, edit and save the &GNU; gettext plural forms too.
+</para></note>
+
 <para>
-&kbabel; can read the &GNU; plural forms only, but cannot edit them. It only supports
-the &kde; version of plural forms at the moment.
-</para>
-<para>
 Every language to which &kde; is translated must have set a correct
-number of plural forms. This is done by translating an entry in <filename>kdelibs.po</filename>.
+number of plural forms. This is done by translating a specific entry in <filename>kdelibs.po</filename>.
 The number is set by selecting the name of a language, which uses
 the same number and <emphasis>rules</emphasis> for finding the
 right plural form. The up-to-date list of possible values can be found in the
 kdelibs source code, in the file <filename>kdecore/klocale.cpp</filename>.
 </para>
+
+<note><para>
+&GNU; gettext allows to define the number and type of plural forms by a formula and to set this
+formula independently for each PO file. &kde; can only define the number and type of plural forms
+one time in kdelibs.
+</para></note>
+
 <para>
-&kde; plural forms are denoted by comment <userinput>_:</userinput> containing
+&kde; plural forms are denoted by comment <userinput>_n:</userinput> (including a trailing space) containing
 the <literal>%n</literal> argument. This argument is then used in the message
 itself and it controls which plural form of your language should be used
 depending on the rules for your language.
@@ -742,8 +760,9 @@
 <para>
 The translation of a plural form message has to have a special format. 
 It must contain the correct number of translations (one for each plural form)
-separated by an end of the line <literal>\n</literal>. For example, 
-<quote>Selected %n files</quote> translated to Slovak would be:
+separated by an end of the line <literal>\n</literal>,
+<emphasis>without</emphasis> any <userinput>_n:</userinput> sequence (without the space either). For example,
+<quote>_n: Selected 1 file\nSelected %n files</quote> translated to Slovak would be:
 </para>
 <programlisting>
 Vybraný %n súbor\n
Index: doc/kbabel/pref_diff.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_diff.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/pref_edit_general.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_edit_general.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/menu.docbook
===================================================================
--- doc/kbabel/menu.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/menu.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1099,7 +1099,7 @@
     characters is identical in both the original and the translated
     string.</action>  Note that accelerator marker is &amp; in &kde;
     (but not in every programming toolkit). See the
-    <link linkend="preferences-miscellaneous">Miscellaneous</link> section 
+    <link linkend="preferences-project-miscellaneous">Miscellaneous</link> section 
 	below to find out how to change a keyboard accelerator.
       </para>
     </listitem>
@@ -1399,7 +1399,7 @@
     <listitem>
       <para>
         All &kbabel;-specific settings go here.
-	Please read the <link linkend="preferences-kbabel">Preferences</link> section for specific topics.
+	Please read the <link linkend="preferences-global">&kbabel; Global Settings</link> section for specific topics.
       </para>
     </listitem>
   </varlistentry>
@@ -2297,22 +2297,6 @@
       </para>
     </listitem>
   </varlistentry>
-  <varlistentry>
-    <term>
-      <menuchoice>
-        <guimenu>Settings</guimenu>
-        <guimenuitem>Configure KBabel - Catalog Manager...</guimenuitem>
-      </menuchoice>
-    </term>
-    <listitem>
-      <para>
-        <action>
-        All &catalogmanager; specific settings go here.
-	</action>
-	Please read <link linkend="preferences-catalogmanager">Preferences</link> section for specific topics.
-      </para>
-    </listitem>
-  </varlistentry>
 </variablelist>
 </sect2>
 
Index: doc/kbabel/faq.docbook
===================================================================
--- doc/kbabel/faq.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/faq.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -18,34 +18,10 @@
 
 <title>Questions and Answers</title>
 <qandaset>
+  <!-- ### FIXME: describe better the situation of Qt3. (This text sounds like being for Qt2.) -->
   <qandaentry>
     <question>
       <para>
-      Why does &kbabel; show question marks when entering language specific
-      characters?
-      </para>
-    </question>
-    <answer>
-
-      <para>
-        This is a problem with your locale settings. The following might help:
-        Exit &kbabel;, in a shell set the environment variable
-<envar>LANG</envar> to a locale, valid for your language. If you use
-<command>bash</command> do
-        <userinput><command>export
-<envar>LANG</envar>=<replaceable>change
-this</replaceable></command></userinput>. For example, when you use
-german characters, do <userinput><command>export
-<envar>LANG</envar>=de_DE.88591</command></userinput>. Then start
-&kbabel; from this shell. If the problem is gone, insert
-        this command in your <filename>~/.profile</filename>.
-      </para>
-
-    </answer>
-  </qandaentry>
-  <qandaentry>
-    <question>
-      <para>
       Why does &kbabel; show question marks instead of language specific
 characters after loading a <acronym>PO</acronym> file?</para>
     </question>
@@ -62,6 +38,19 @@
       </para>
     </answer>
   </qandaentry>
+<qandaentry>
+<question>
+<para>
+How can I translate &kde;?
+</para>
+</question>
+<answer>
+<para>
+You can look for information about how to translate KDE in the
+<ulink url="http://i18n.kde.org/translation-howto/">The KDE Translation HOWTO</ulink>.
+</para>
+</answer>
+</qandaentry> 
 </qandaset>
 </chapter>
 <!--
Index: doc/kbabel/dictionaries.docbook
===================================================================
--- doc/kbabel/dictionaries.docbook	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ doc/kbabel/dictionaries.docbook	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -41,8 +41,9 @@
 <!-- FIXME: settings -->
 <title>Translation database</title>
 
+<!-- ### TODO: only *one* file? Seems more to be four... -->
 <para>Translation database allows you to store translations in a
-database based on Berkeley Database II, &ie; it is stored in a binary
+database based on Berkeley Database IV, &ie; it is stored in a binary
 file on your disk. The database guarantees fast searching in a large
 number of translations.</para>
 
@@ -276,17 +277,23 @@
 
 <para>This searching mode is based on matching the same original
 English string (the msgid) translated in some other language in an
-auxillary <acronym>PO</acronym> file.  It is very common for romanic
-languages to have similar words, similarly for anglosaxon and
-slavonic ones.</para>
+auxillary <acronym>PO</acronym> file.  It is very common for Romance
+<!-- ### TODO: is "Anglo-Saxon" not too Romance or too technical for an English text? -->
+languages to have similar words, similarly for Anglo-Saxon and
+Slavic ones.</para>
 
-<para>For example, say I wanted to translate the word
+<para>
+For example, say I wanted to translate the word
 <quote>on</quote>, from <filename>kdelibs.po</filename>, into Romanian
 but have no clue.  I look in the same file for French and find
-<quote>actif</quote>, and in the Spanish one find
-<quote>activado</quote>.  So, I conclude that the best one in Romanian
-will be <quote>active</quote>.  &kbabel; automates this task.
-Currently you can define only one auxiliary file to search.</para>
+<foreignphrase lang="fr">actif</foreignphrase>, and in the Spanish one find
+<foreignphrase lang="es">activado</foreignphrase>.  So, I conclude that the best one in Romanian
+will be <foreignphrase lang="ro">active</foreignphrase>.
+(Of course, in English instead of <quote>on</quote> the word could have been
+<quote>active</quote> or <quote>activated</quote>,
+which would have made the translation process easier.)
+&kbabel; automates this task. Currently you can define only one auxiliary file to search.
+</para>
 
 <sect2 id="auxiliary-settings">
 <title>Settings</title>
@@ -341,6 +348,7 @@
 <para>I'm Romanian and I have some knowledge about French language and
 I work on &kde; translation.</para>
 
+<!-- ### TODO: check URL, especially the kde-l10n part -->
 <para>First step is to download a very fresh
 <filename>kde-l10n-fr.tar.bz2</filename> from the <ulink
 url="ftp://ftp.kde.org/pub/kde/snapshots/kde-l10n">&kde; &FTP;
@@ -349,7 +357,7 @@
 <filename>/home/clau/cvs-cvs.kde.org/kde-l10n/fr</filename>.</para>
 
 <para>My <acronym>PO</acronym> sources folder is in
-<filename>/home/clau/cvs-cvs.kde.org/kde-l10n/ro</filename>.  Don't
+<filename>/home/clau/cvs-cvs.kde.org/kde-l10n/ro</filename>.  Do not
 forget to select <guilabel>PO Auxiliary</guilabel> as the default
 dictionary and check <guilabel>Automatically start search</guilabel>
 on the <guilabel>Search</guilabel> tab from &kbabel;'s
@@ -415,6 +423,7 @@
 path, it's possible to choose an absolute, real path to an existing
 <acronym>PO</acronym> file to be used as a compendium.</para>
 
+<!-- ### TODO: check URL, especially the kde-l10n part -->
 <para>A very fresh compendium for &kde; translation into &eg; French
 you can download <filename>fr.messages.bz2</filename> from the <ulink
 url="ftp://ftp.kde.org/pub/kde/snapshots/kde-l10n">&kde; &FTP;
Index: doc/kbabel/pref_proj_diff.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_proj_diff.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/pref_wizard_page1.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_wizard_page1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Index: doc/kbabel/pref_wizard_page2.png
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = image/png

Property changes on: doc/kbabel/pref_wizard_page2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png


Property changes on: doc/kbabel
___________________________________________________________________
Name: svn:ignore
   - Makefile
Makefile.in
*.html
   + Makefile
Makefile.in
*.html
*.1
index.cache.bz2


Index: cervisia/commitdlg.cpp
===================================================================
--- cervisia/commitdlg.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ cervisia/commitdlg.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -36,7 +36,23 @@
 #include "diffdlg.h"
 
 
-CommitDialog::CommitDialog(KConfig& cfg, CvsService_stub* service, 
+class CommitListItem : public QCheckListItem
+{
+public:
+    CommitListItem(QListView* parent, const QString& text, const QString fileName)
+        : QCheckListItem(parent, text, QCheckListItem::CheckBox)
+        , m_fileName(fileName)
+    {
+    }
+
+    QString fileName() const { return m_fileName; }
+
+private:
+    QString m_fileName;
+};
+
+
+CommitDialog::CommitDialog(KConfig& cfg, CvsService_stub* service,
                            QWidget *parent, const char *name)
     : KDialogBase(parent, name, true, i18n("CVS Commit"),
                   Ok | Cancel | Help | User1, Ok, true)
@@ -63,14 +79,14 @@
 
     QLabel *archivelabel = new QLabel(i18n("Older &messages:"), mainWidget);
     layout->addWidget(archivelabel);
-            
+
     combo = new QComboBox(mainWidget);
     archivelabel->setBuddy(combo);
     connect( combo, SIGNAL(activated(int)), this, SLOT(comboActivated(int)) );
     // make sure that combobox is smaller than the screen
     combo->setSizePolicy(QSizePolicy(QSizePolicy::Preferred, QSizePolicy::Fixed));
     layout->addWidget(combo);
-            
+
     QLabel *messagelabel = new QLabel(i18n("&Log message:"), mainWidget);
     layout->addWidget(messagelabel);
 
@@ -90,7 +106,7 @@
     setButtonGuiItem(User1, KGuiItem(i18n("&Diff"), "vcs_diff"));
     enableButton(User1, false);
     connect( this, SIGNAL(user1Clicked()),
-             this, SLOT(diffClicked()) );            
+             this, SLOT(diffClicked()) );
 
     setHelp("commitingfiles");
 
@@ -120,7 +136,7 @@
         QString text = (*it != "." ? *it : currentDirName);
 
         edit->compObj()->addItem(text);
-        QCheckListItem* item = new QCheckListItem(m_fileList, text, QCheckListItem::CheckBox);
+        CommitListItem* item = new CommitListItem(m_fileList, text, *it);
         item->setOn(true);
     }
 }
@@ -133,7 +149,8 @@
     QListViewItemIterator it(m_fileList, QListViewItemIterator::Checked);
     for( ; it.current(); ++it )
     {
-        files.append(it.current()->text(0));
+        CommitListItem* item = static_cast<CommitListItem*>(it.current());
+        files.append(item->fileName());
     }
 
     return files;
@@ -229,15 +246,15 @@
 void CommitDialog::showDiffDialog(const QString& fileName)
 {
     DiffDialog *l = new DiffDialog(partConfig, this, "diffdialog");
-    
+
     // disable diff button so user doesn't open the same diff several times (#83018)
     enableButton(User1, false);
-    
+
     if (l->parseCvsDiff(cvsService, fileName, "", ""))
         l->show();
     else
         delete l;
-    
+
     // re-enable diff button
     enableButton(User1, true);
 }
Index: cervisia/cervisia.desktop
===================================================================
--- cervisia/cervisia.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ cervisia/cervisia.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -47,7 +47,6 @@
 GenericName[uk]=Інтерфейс до CVS
 GenericName[ven]=CVS yo iswa phanda
 GenericName[xh]=CVS Isiqalo sesiphelo
-GenericName[xx]=xxCVS Frontendxx
 GenericName[zh_CN]=CVS 前端
 GenericName[zh_TW]=CVS 前端
 GenericName[zu]=CVSIsiqalo sokugcina
@@ -64,7 +63,6 @@
 Name[pa]=ਸਰਵੀਸੀਆ(Cervisia)
 Name[ta]= செர்வியா
 Name[th]=เซอร์วิเซีย
-Name[xx]=xxCervisiaxx
 ServiceTypes=KParts/ReadOnlyPart,Browser/View
 X-KDE-Library=libcervisiapart
 X-KDE-BrowserView-Args=DetailedList

Property changes on: cervisia/hi48-app-cervisia.png
___________________________________________________________________
Name: svn:executable
   - *

Index: cervisia/eventsrc
===================================================================
--- cervisia/eventsrc	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ cervisia/eventsrc	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -1,7 +1,6 @@
 [!Global!]
 IconName=cervisia
 Comment=Cervisia
-Comment[xx]=xxCervisiaxx
 
 [cvs_commit_done]
 Name=CVS commit job done
@@ -32,7 +31,6 @@
 Name[sv]=CVS-arkiveringsjobb klart
 Name[tr]=CVS teslim etme işi tamamlandı
 Name[uk]=Завдання передачі CVS виконане
-Name[xx]=xxCVS commit job donexx
 Name[zh_CN]=CVS 提交任务已完成
 Comment=A CVS commit job is done
 Comment[bg]=Предаването в CVS е готово
@@ -62,6 +60,5 @@
 Comment[sv]=Ett CVS-arkiveringsjobb är klart
 Comment[tr]=Bir CVS teslim etme işi tamamlandı
 Comment[uk]=Завдання передачі CVS виконане
-Comment[xx]=xxA CVS commit job is donexx
 Comment[zh_CN]=CVS 提交任务已完成
 default_presentation=0
Index: cervisia/cvsservice/cvsservice.desktop
===================================================================
--- cervisia/cvsservice/cvsservice.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ cervisia/cvsservice/cvsservice.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -22,7 +22,6 @@
 Name[sv]=CVS-tjänst
 Name[ta]=Cvsசேவை
 Name[tg]=ҲизматиCvs
-Name[xx]=xxCvsServicexx
 Exec=cvsservice
 X-DCOP-ServiceType=Multi
 X-KDE-StartupNotify=false
@@ -60,5 +59,4 @@
 Comment[tg]=Хизмати DCOP барои интерфейс бо cvs
 Comment[tr]= CVS'ye arayüz sağlayan bir DCOP Servisi
 Comment[uk]=Служба DCOP, яка надає інтерфейс до cvs
-Comment[xx]=xxA DCOP service that provides an interface to cvsxx
 Comment[zh_CN]=提供 CVS 接口的 DCOP 服务
Index: kfile-plugins/ts/kfile_ts.desktop
===================================================================
--- kfile-plugins/ts/kfile_ts.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kfile-plugins/ts/kfile_ts.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -36,7 +36,6 @@
 Name[tg]=Ахборот дар бораи файл дар формати Qt Linguist
 Name[tr]=Qt Dilbilimci Dosya Bilgisi
 Name[uk]=інформація про файл формату Qt Linguist
-Name[xx]=xxQt Linguist File Infoxx
 Name[zh_CN]=Qt 语言大师文件信息
 ServiceTypes=KFilePlugin
 X-KDE-Library=kfile_ts
Index: kfile-plugins/c++/kfile_cpp.desktop
===================================================================
--- kfile-plugins/c++/kfile_cpp.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kfile-plugins/c++/kfile_cpp.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -46,7 +46,6 @@
 Name[tr]=C++ Bilgisi
 Name[uk]=Інформація про C++
 Name[xh]=C++ Ulwazi
-Name[xx]=xxC++ Infoxx
 Name[zh_CN]=C++ 信息
 Name[zh_TW]=C++ 資訊
 ServiceTypes=KFilePlugin
Index: kfile-plugins/c++/kfile_h.desktop
===================================================================
--- kfile-plugins/c++/kfile_h.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kfile-plugins/c++/kfile_h.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -45,7 +45,6 @@
 Name[tr]=C/C++ Başlık Bilgisi
 Name[uk]=Інформація по заголовкам C++
 Name[xh]=C/C++ Ulwazi lokubhaliweyo okuphezulu
-Name[xx]=xxC/C++ Header Infoxx
 Name[zh_CN]=C/C++ 头文件信息
 Name[zh_TW]=C/C++ 檔頭資訊
 ServiceTypes=KFilePlugin
Index: kfile-plugins/diff/kfile_diff.desktop
===================================================================
--- kfile-plugins/diff/kfile_diff.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kfile-plugins/diff/kfile_diff.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -44,7 +44,6 @@
 Name[th]=สถานะแตกต่าง
 Name[tr]=Diff İstatistikleri
 Name[uk]=Статистика відмінностей
-Name[xx]=xxDiff Statsxx
 Name[zh_CN]=Diff 统计
 Name[zh_TW]=Diff 狀態
 ServiceTypes=KFilePlugin
Index: kuiviewer/kuiviewer.desktop
===================================================================
--- kuiviewer/kuiviewer.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kuiviewer/kuiviewer.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -6,7 +6,6 @@
 Name[ja]=KUI ビューア
 Name[sv]=KUIviewer
 Name[ta]=KUIவியூவர்
-Name[xx]=xxKUIViewerxx
 Exec=kuiviewer %i %m -caption "%c"
 Icon=kuiviewer
 Type=Application
@@ -43,7 +42,6 @@
 GenericName[tg]=Намоишгари UI-файлҳо Qt Designer
 GenericName[tr]=Qt Designer UI Dosya Görüntüleyici
 GenericName[uk]=Переглядач UI-файлів Qt Designer
-GenericName[xx]=xxQt Designer UI File Viewerxx
 GenericName[zh_CN]=Qt 设计师 UI 文件查看器
 MimeType=application/x-designer;
 Terminal=false
Index: kuiviewer/kuiviewer_part.desktop
===================================================================
--- kuiviewer/kuiviewer_part.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kuiviewer/kuiviewer_part.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -4,7 +4,6 @@
 Name[hi]=के-यूआई-व्यूअर-पार्ट
 Name[sv]=KUIviewer-del
 Name[ta]=KUIவியூவர் உறுப்பு
-Name[xx]=xxKUIViewerPartxx
 MimeType=application/x-designer;
 ServiceTypes=KParts/ReadOnlyPart
 X-KDE-Library=libkuiviewerpart
Index: kuiviewer/designerthumbnail.desktop
===================================================================
--- kuiviewer/designerthumbnail.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kuiviewer/designerthumbnail.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -37,7 +37,6 @@
 Name[tg]=Файлҳои Qt Designer
 Name[tr]=Qt Designer Dosyaları
 Name[uk]=Файли Qt Designer
-Name[xx]=xxQt Designer Filesxx
 Name[zh_CN]=Qt 设计师文件
 ServiceTypes=ThumbCreator
 MimeTypes=application/x-designer
Index: kbugbuster/gui/cwbugdetails.cpp
===================================================================
--- kbugbuster/gui/cwbugdetails.cpp	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbugbuster/gui/cwbugdetails.cpp	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -122,10 +122,12 @@
                 text.append( "<a href=\"" + BugSystem::self()->server()->bugLink( bug ).url()
                              + "\">" + i18n("Bug Report</a> from <b>%1</b>")
                              .arg( sender ) );
-            else
+            else {
                 text.append( "<a href=\"" + BugSystem::self()->server()->bugLink( bug ).url() + QString("#c%1").arg( replies )
 			     + "\">" + i18n("Reply #%1</a> from <b>%2</b>")
-                             .arg( replies-- ).arg( sender ) );
+                             .arg( replies ).arg( sender ) );
+                replies--;
+            }
             text.append( "</div>\n" );
             text += "<div style=\"" + highlightStyle + borderBottomStyle;
             if ( !firstHeader ) text += borderTopStyle;
Index: kbugbuster/kbugbuster.desktop
===================================================================
--- kbugbuster/kbugbuster.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbugbuster/kbugbuster.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -55,7 +55,6 @@
 GenericName[ven]=Malangulele a Bug a KDE
 GenericName[vi]=Trình quản lí bug KDE
 GenericName[xh]=Umxholo Wokuxoxwa We KDE
-GenericName[xx]=xxKDE Bug Managementxx
 GenericName[zh_CN]=KDE 除错管理
 GenericName[zh_TW]=KDE 臭蟲管理
 GenericName[zu]=KDE Ukuphathwa Kwegciwane
@@ -71,5 +70,4 @@
 Name[ta]= Kபக்பஸ்டர்
 Name[th]=บักบัสเตอร์
 Name[ven]=Mupandeli wa Baga wa K
-Name[xx]=xxKBugBusterxx
 Categories=Qt;KDE;Development;
Index: kbugbuster/kresources/bugzilla.desktop
===================================================================
--- kbugbuster/kresources/bugzilla.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kbugbuster/kresources/bugzilla.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -7,8 +7,11 @@
 Name[el]=Λίστα να-κάνω του Bugzilla
 Name[es]=Listado de tareas pendientes de BugZilla
 Name[et]=Bugzilla ülesannete nimekiri
+Name[eu]=Bugzilla-ren egiteke zerrenda
 Name[fr]=Liste de tâches de Bugzilla
 Name[ga]=Tascliosta Bugzilla
+Name[he]=רשימת מטלות של Bugzilla
+Name[hu]=Bugzilla feladatlista
 Name[is]=Bugzilla verklisti
 Name[it]=Lista delle cosa da fare di Bugzilla
 Name[ja]=BugzillaToDo リスト
@@ -23,7 +26,6 @@
 Name[sv]=Bugzilla uppgiftslista
 Name[tr]=Bugzilla To-do Listesi
 Name[uk]=Список завдань Bugzilla
-Name[xx]=xxBugzilla To-do Listxx
 Name[zh_CN]=Bugzilla 待办列表
 X-KDE-Library=kcal_bugzilla
 Type=Service
Index: kioslave/svn/svn+http.protocol
===================================================================
--- kioslave/svn/svn+http.protocol	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/svn+http.protocol	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -33,6 +33,5 @@
 Description[sv]=Subversion I/O-slav
 Description[tr]=Alt Version ioslave
 Description[uk]=Підлеглий В/В Subversion
-Description[xx]=xxSubversion ioslavexx
 maxInstances=5
 class=:internet
Index: kioslave/svn/svn+file.protocol
===================================================================
--- kioslave/svn/svn+file.protocol	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/svn+file.protocol	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -33,6 +33,5 @@
 Description[sv]=Subversion I/O-slav
 Description[tr]=Alt Version ioslave
 Description[uk]=Підлеглий В/В Subversion
-Description[xx]=xxSubversion ioslavexx
 maxInstances=5
 class=:internet
Index: kioslave/svn/ksvnd/ksvnd.desktop
===================================================================
--- kioslave/svn/ksvnd/ksvnd.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/ksvnd/ksvnd.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -31,7 +31,6 @@
 Name[sv]=KDED Subversion-modul
 Name[tr]=KDED Alt Versiyon Modülü
 Name[uk]=Модуль KDED Subversion
-Name[xx]=xxKDED Subversion Modulexx
 Name[zh_CN]=KDED Subversion 模块
 ServiceTypes=KDEDModule
 X-KDE-ModuleType=Library
Index: kioslave/svn/svn+ssh.protocol
===================================================================
--- kioslave/svn/svn+ssh.protocol	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/svn+ssh.protocol	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -33,6 +33,5 @@
 Description[sv]=Subversion I/O-slav
 Description[tr]=Alt Version ioslave
 Description[uk]=Підлеглий В/В Subversion
-Description[xx]=xxSubversion ioslavexx
 maxInstances=5
 class=:internet
Index: kioslave/svn/svn+https.protocol
===================================================================
--- kioslave/svn/svn+https.protocol	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/svn+https.protocol	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -33,6 +33,5 @@
 Description[sv]=Subversion I/O-slav
 Description[tr]=Alt Version ioslave
 Description[uk]=Підлеглий В/В Subversion
-Description[xx]=xxSubversion ioslavexx
 maxInstances=5
 class=:internet
Index: kioslave/svn/svn.protocol
===================================================================
--- kioslave/svn/svn.protocol	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/svn.protocol	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -33,6 +33,5 @@
 Description[sv]=Subversion I/O-slav
 Description[tr]=Alt Version ioslave
 Description[uk]=Підлеглий В/В Subversion
-Description[xx]=xxSubversion ioslavexx
 maxInstances=5
 class=:internet
Index: kioslave/svn/svnhelper/subversion_toplevel.desktop
===================================================================
--- kioslave/svn/svnhelper/subversion_toplevel.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/svnhelper/subversion_toplevel.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -14,7 +14,9 @@
 Name[el]=Ενημέρωση SVN
 Name[es]=Actualizar SVN
 Name[et]=SVN uuendamine
+Name[eu]=SVN eguneratu
 Name[fr]=Mise à jour SVN
+Name[hu]=SVN frissítés
 Name[is]=Uppfæra SVN
 Name[it]=Aggiornamento SVN
 Name[ja]=SVN アップデート
@@ -29,7 +31,6 @@
 Name[sv]=SVN-uppdatera
 Name[tr]=SVN Güncelleme
 Name[uk]=SVN-оновлення
-Name[xx]=xxSVN Updatexx
 Name[zh_CN]=SVN 更新
 Icon=redo
 Exec=kio_svn_helper -u %U
@@ -42,7 +43,9 @@
 Name[el]=Καταχώρηση SVN
 Name[es]=Entrega SVN
 Name[et]=SVN sissekanne
+Name[eu]=SVN entregatu
 Name[fr]=Validation SVN
+Name[hu]=SVN eltárolás
 Name[is]=Setja inn í SVN
 Name[it]=Deposito SVN
 Name[ja]=SVN コミット
@@ -57,7 +60,6 @@
 Name[sv]=SVN-arkivera
 Name[tr]=SVN Teslim Etme
 Name[uk]=SVN-передання
-Name[xx]=xxSVN Commitxx
 Name[zh_CN]=SVN 提交
 Icon=undo
 Exec=kio_svn_helper -c %U
Index: kioslave/svn/svnhelper/subversion.desktop
===================================================================
--- kioslave/svn/svnhelper/subversion.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/svnhelper/subversion.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -2,7 +2,6 @@
 Encoding=UTF-8
 ServiceTypes=inode/directory,all/all
 X-KDE-Submenu=Subversion
-X-KDE-Submenu[xx]=xxSubversionxx
 #X-KDE-ShowIfDcopCall=kded ksvnd anyValidWorkingCopy(KURL::List)
 
 #Return type of below is a QStringList with a list of Actions which is appended to the Actions above
@@ -11,14 +10,18 @@
 [Desktop Action Add]
 Name=Add to Repository
 Name[bg]=Добавяне в хранилището
+Name[br]=Ouzhpennañ d'an daveiñ
 Name[cs]=Přidat do repository
 Name[da]=Tilføj til lager
 Name[de]=Zum SVN-Archiv hinzufügen
 Name[el]=Προσθήκη στο χώρο αποθήκευσης
 Name[es]=Añadir al repositorio
 Name[et]=Hoidlasse lisamine
+Name[eu]=Gehitu biltegira
 Name[fr]=Ajouter au référentiel
 Name[ga]=Cuir leis an Stór
+Name[he]=הוסף למאגר
+Name[hu]=Hozzáadás az adattárhoz
 Name[is]=Bæta við geymslu
 Name[it]=Aggiungi al deposito
 Name[ja]=レポジトリへ追加
@@ -33,7 +36,6 @@
 Name[sv]=Lägg till i arkiv
 Name[tr]=Depoya Ekle
 Name[uk]=Додати до сховища
-Name[xx]=xxAdd to Repositoryxx
 Name[zh_CN]=添加到仓库
 Icon=svn_add
 Exec=kio_svn_helper -a %U
@@ -41,13 +43,17 @@
 [Desktop Action Delete]
 Name=Delete From Repository
 Name[bg]=Изтриване от хранилището
+Name[br]=Lemel eus an daveiñ
 Name[cs]=Smazat z repository
 Name[da]=Slet fra lager
 Name[de]=Aus dem SVN-Archiv löschen
 Name[el]=Διαγραφή από το χώρο αποθήκευσης
 Name[es]=Eliminar del repositorio
 Name[et]=Hoidlast kustutamine
+Name[eu]=Ezabatu biltegitik
 Name[fr]=Supprimer du référentiel
+Name[he]=מחק ממאגר
+Name[hu]=Törlés az adattárból
 Name[is]=Eyða frá geymslu
 Name[it]=Elimina dal deposito
 Name[ja]=レポジトリから削除
@@ -62,7 +68,6 @@
 Name[sv]=Ta bort från arkiv
 Name[tr]=Depodan Sil
 Name[uk]=Видалити зі сховища
-Name[xx]=xxDelete From Repositoryxx
 Name[zh_CN]=从仓库删除
 Icon=svn_remove
 Exec=kio_svn_helper -d %U
@@ -76,7 +81,10 @@
 Name[el]=Επαναφορά τοπικών αλλαγών
 Name[es]=Revertir cambios locales
 Name[et]=Kohalike muudatuste tühistamine
+Name[eu]=Leheneratu aldaketa lokalak
 Name[fr]=Annuler les modifications locales
+Name[he]=נקה שינויים מקומיים
+Name[hu]=A helyi módosítások visszavonása
 Name[is]=Afturkalla staðbundnar breytingar
 Name[it]=Annulla i cambiamenti locali
 Name[ja]=ローカル状での変更を元に戻す
@@ -91,7 +99,6 @@
 Name[sv]=Återställ lokal ändring
 Name[tr]=Yerel Değişiklikleri Ters Çevir
 Name[uk]=Повернути локальні зміни
-Name[xx]=xxRevert Local Changesxx
 Name[zh_CN]=恢复本地更改
 Icon=undo
 Exec=kio_svn_helper -r %U
@@ -103,7 +110,9 @@
 Comment[el]=Αφαίρεση κάθε τροποποίησης που έγινε τοπικά. Προειδοποίηση ότι αυτό δε μπορεί να αναιρεθεί.
 Comment[es]=Eliminar cualquier cambio local. Atención: esto no se puede deshacer.
 Comment[et]=Eemaldab kõik kohalikud muudatused. Hoiatus: seda ei saa tagasi võtta.
+Comment[eu]=Kendu lokalki egindako aldaketak. Abisua: ekintza hau ezin da desegin.
 Comment[fr]=Annuler toutes les modifications effectuées localement. Attention, cela ne peut pas être annulé.
+Comment[hu]=A helyi módosítások visszavonása. Ez a művelet nem vonható vissza!
 Comment[is]=Fjarlægja allar breytingar sem voru gerðar hér. Athugið - það er ekki hægt að afturkalla þetta.
 Comment[it]=Rimuovi ogni cambiamento fatto localmente. Attenzione: non si può tornare indietro.
 Comment[ja]=ローカルで行われた変更を削除します。注意： 元に戻せません。
@@ -117,7 +126,6 @@
 Comment[sv]=Tar bort alla ändringar som gjorts lokalt. Varning: detta kan inte ångras.
 Comment[tr]=Yerel olarak yapılan değişiklikleri kaldır. Dikkat - bu işlem geri alınamaz.
 Comment[uk]=Вилучити всі зміни, які було зроблено локально. Попередження - зміни буде вилучено назавжди.
-Comment[xx]=xxRemove any changes made locally. Warning - this cannot be undone.xx
 Comment[zh_CN]=删除本地进行的任何更改。警告 - 此操作无法撤消。
 
 [Desktop Action Rename]
@@ -127,12 +135,15 @@
 Name[cs]=Přejmenovat...
 Name[cy]=Ail-enwi...
 Name[da]=Omdøb...
-Name[de]=Umbenennen...
+Name[de]=Umbenennen ...
 Name[el]=Μετονομασία...
 Name[es]=Renombrar...
 Name[et]=Ümbernimetamine...
+Name[eu]=Berrizendatu...
 Name[fr]=Renommer...
 Name[ga]=Athainmnigh...
+Name[he]=שנה שם...
+Name[hu]=Átnevezés...
 Name[is]=Endurnefna...
 Name[it]=Rinomina...
 Name[ja]=名前の変更...
@@ -147,7 +158,6 @@
 Name[sv]=Byt namn...
 Name[tr]=Yeniden Adlandır...
 Name[uk]=Перейменувати...
-Name[xx]=xxRename...xx
 Name[zh_CN]=重命名...
 Icon=pencil
 Exec=kio_svn_helper -r %U
@@ -159,7 +169,9 @@
 Comment[el]=Μετονομασία ενός αρχείου τοπικά και στο χώρο αποθήκευσης. Χρησιμοποιήστε αυτό αντί της προσθήκης και αφαίρεσης για τη μετονομασία ενός αρχείου.
 Comment[es]=Renombrar un archivo localmente y en el repositorio. Use esto en lugar de añadir y eliminar para renombrar un archivo.
 Comment[et]=Faili ümbernimetamine nii kohalikult kui hoidlas. See on eelistatud viis faili ümbernimetamisel lisamise ja kustutamise asemel.
+Comment[eu]=Berrizendatu fitxategi bat lokalki eta biltegian. Erabili hau fitxategia ezabatu eta berriro gehitu ordez.
 Comment[fr]=Renommer un fichier localement et dans le référentiel. Utilisez cette option pour renommer un fichier, au lieu de le supprimer puis l'ajouter sous le nouveau nom.
+Comment[hu]=Fájl átnevezése helyben és az adattárban. Ezt érdemes használni hozzáadás és törlés helyett.
 Comment[is]=Endurnefna skrá hér og í geymslunni. Notist heldur við þetta í stað þess að bæta við og eyða til að endurnefna skrá.
 Comment[it]=Rinomina un file localmente e nel deposito. Usa questo invece di aggiungere e rimuovere un file per rinominarlo.
 Comment[ja]=ローカルとレポジトリのファイルを改名します。名前の変更の際に追加と削除をしないで、この方法を使用してください。
@@ -172,19 +184,21 @@
 Comment[sr@Latn]=Preimenuj fajl lokalno i u skladištu. Koristite ovo umesto trika sa dodavanjem i brisanjem fajla.
 Comment[sv]=Byt namn på en fil lokalt och i arkivet. Använd detta istället för att lägga till och ta bort för att byta namn på en fil.
 Comment[uk]=Перейменувати файл локально і в сховищі. Вживайте замість додавання і видалення файла, щоб його перейменувати.
-Comment[xx]=xxRename a file locally and in the repository.  Use this rather than adding and deleting to rename a file.xx
 Comment[zh_CN]=在本地和仓库中重命名文件。使用此功能来取代对文件的添加和删除。
 
 [Desktop Action Import]
 Name=Import Repository
 Name[bg]=Импорт на директория
+Name[br]=Enporzh an daveiñ
 Name[cs]=Importovat repository
 Name[da]=Importér lager
 Name[de]=SVN-Archiv importieren
 Name[el]=Εισαγωγή χώρου αποθήκευσης
 Name[es]=Importar repositorio
 Name[et]=Hoidla import
+Name[eu]=Inportatu biltegia
 Name[fr]=Importer dans un référentiel
+Name[hu]=Adattár importálása
 Name[is]=Flytja inn geymslu
 Name[it]=Importa deposito
 Name[ja]=レポジトリのインポート
@@ -199,7 +213,6 @@
 Name[sv]=Importera arkiv
 Name[tr]=Depoyu İçe Aktar
 Name[uk]=Імпортувати сховище
-Name[xx]=xxImport Repositoryxx
 Name[zh_CN]=导入仓库
 Icon=svn_import
 Exec=kio_svn_helper -i %U
@@ -211,8 +224,10 @@
 Comment[el]=Εισαγωγή φακέλου σε έναν υπάρχον χώρο αποθήκευσης για τον έλεγχο εκδόσεων.
 Comment[es]=Situar la carpeta en un repositorio existente para ponerla bajo control de revisión.
 Comment[et]=Kataloogi lisamine olemasolevasse versioonikontrolli süsteemi hoidlasse.
+Comment[eu]=Jarri karpeta biltegi batean errebisio kontrolpean edukitzeko.
 Comment[fr]=Place le dossier dans un référentiel existant afin de le mettre sous contrôle de version.
-Comment[is]=Setja möppu í geymslu sem fynnst fyrir til að setja hana undir breytingarstjórn.
+Comment[hu]=Könyvtár felvétele a verziókövető rendszer felügyelete alá.
+Comment[is]=Setja möppu í geymslu sem finnst fyrir til að setja hana undir breytingarstjórn.
 Comment[it]=Metti una cartella in un deposito esistente per metterla sotto controllo di revisione.
 Comment[ja]=既存のレポジトリにフォルダを置き、リビジョン管理の対象とします。
 Comment[nl]=Plaats een map in een bestaande repository zodat het onder het versiebeheer system valt.
@@ -225,7 +240,6 @@
 Comment[sv]=Lägg till katalog i ett befintligt arkiv för att få den under versionskontroll
 Comment[tr]=Dizini başka bie alt düzeltme controlünde var olan bir depo içine koy.
 Comment[uk]=Вставити теку в існуюче сховище, щоб уможливити для неї керування версіями.
-Comment[xx]=xxPut folder into an existing repository to put it under revision control.xx
 Comment[zh_CN]=将文件夹放入现有仓库，以便让其受到版本控制。
 
 [Desktop Action Checkout]
@@ -233,11 +247,13 @@
 Name[bg]=Изтегляне от хранилището...
 Name[cs]=Získat z repository...
 Name[da]=Tjek ud fra lager...
-Name[de]=Aus SVN-Archiv herausholen...
+Name[de]=Aus SVN-Archiv herausholen ...
 Name[el]=Έλεγχος εξόδου από το χώρο αποθήκευσης...
 Name[es]=Obtener del repositorio...
 Name[et]=Hoidla väljavõte...
+Name[eu]=Deskargatu biltegitik...
 Name[fr]=Extraire depuis un référentiel...
+Name[hu]=Kimásolás az adattárból...
 Name[is]=Ná í frá geymslu...
 Name[it]=Ritira dal deposito...
 Name[ja]=レポジトリからチェックアウト
@@ -252,7 +268,6 @@
 Name[sv]=Checka ut från ett arkiv...
 Name[tr]=Depodan Kontrol Et...
 Name[uk]=Взяти зі сховища...
-Name[xx]=xxCheckout From Repository...xx
 Name[zh_CN]=从仓库中检出...
 Icon=svn_checkout
 Exec=kio_svn_helper -C %U
@@ -264,7 +279,9 @@
 Comment[el]=΄Έλεγχος εξόδου των αρχείων από έναν υπάρχον χώρο αποθήκευσης σε αυτόν τον φάκελο.
 Comment[es]=Descargar archivos de un repositorio existente en esta carpeta.
 Comment[et]=Olemasoleva hoidla failide väljavõte sellesse kataloogi.
+Comment[eu]=Deskargatu fitxategiak biltegi batetik karpeta honetara.
 Comment[fr]=Extraire dans ce dossier les fichiers d'un référentiel existant
+Comment[hu]=Fájlok kimásolása az adattárból ebbe a könyvtárba.
 Comment[is]=Ná í skrár frá geymslu og setja í þessa möppu.
 Comment[it]=Ritira i file da un deposito esistente in questa cartella.
 Comment[ja]=既存のレポジトリから、このディレクトリへファイルをチェックアウトします。
@@ -278,7 +295,6 @@
 Comment[sv]=Checka ut filer från ett befintligt arkiv till katalogen.
 Comment[tr]=Bu dizinde var olan bir depodan hatalı dosyaları kontrol et.
 Comment[uk]=Взяти файли з існуючого сховища і покласти в цю теку.
-Comment[xx]=xxCheckout out files from an existing repository into this folder.xx
 Comment[zh_CN]=从已有仓库中检出文件并存放至此文件夹。
 
 [Desktop Action Switch]
@@ -290,7 +306,9 @@
 Name[el]=Εναλλαγή...
 Name[es]=Cambiar...
 Name[et]=Lülitumine...
+Name[eu]=Aldatu...
 Name[fr]=Basculer...
+Name[hu]=Váltás...
 Name[is]=Skipta...
 Name[it]=Passa...
 Name[ja]=スイッチ...
@@ -305,7 +323,6 @@
 Name[sv]=Byt...
 Name[tr]=Değiştir...
 Name[uk]=Перемкнути...
-Name[xx]=xxSwitch...xx
 Name[zh_CN]=切换...
 Icon=svn_switch
 Comment=Switch given working copy to another branch
@@ -316,7 +333,9 @@
 Comment[el]=Εναλλαγή του δοσμένου αντιγράφου εργασίας σε άλλον κλάδο
 Comment[es]=Cambiar una determinada copia de trabajo a otra rama
 Comment[et]=Antud töökoopia lülitamine teise harru
+Comment[eu]=aldatu laneko kopia bat beste adar batekin
 Comment[fr]=Basculer la copie de travail vers une autre branche
+Comment[hu]=A munkamásolat átváltása másik ágra
 Comment[is]=Skipta núverandi vinnuafriti yfir í aðra grein
 Comment[it]=Passa la copia di lavoro a un altro ramo
 Comment[ja]=作業中のコピーを他のブランチへ切り換えます。
@@ -330,7 +349,6 @@
 Comment[sv]=Byt angiven arbetskopia till en annan gren
 Comment[tr]=Çalışan belirli bir kopyayı başka bölüme değiştir
 Comment[uk]=Перемкнути поточну робочу копію на іншу гілку
-Comment[xx]=xxSwitch given working copy to another branchxx
 Comment[zh_CN]=将工作副本切换到另外一个分支
 Exec=kio_svn_helper -s %U
 
@@ -339,12 +357,14 @@
 Name[bg]=Смесване...
 Name[cs]=Sloučit...
 Name[da]=Indflet...
-Name[de]=Zusammenführen...
+Name[de]=Zusammenführen ...
 Name[el]=Συγχώνευση...
 Name[es]=Mezclar...
 Name[et]=Ühendamine...
+Name[eu]=Bateratu...
 Name[fr]=Fusionner...
 Name[ga]=Cumaisc...
+Name[hu]=Összeolvasztás...
 Name[is]=Bræða saman...
 Name[it]=Fondi...
 Name[ja]=マージ...
@@ -359,7 +379,6 @@
 Name[sv]=Sammanfoga...
 Name[tr]=Birleştir...
 Name[uk]=Об'єднати...
-Name[xx]=xxMerge...xx
 Name[zh_CN]=合并...
 Icon=svn_merge
 Comment=Merge changes between this and another branch
@@ -370,7 +389,9 @@
 Comment[el]=Συγχώνευση αλλαγών μεταξύ του τρέχοντος και κάποιου άλλου κλάδου
 Comment[es]=Mezclar los cambios entre esta y otra rama
 Comment[et]=Selle ja teise haru muudatuste ühendamine
+Comment[eu]=Bateratu hau eta beste adar baten arteko aldaketak
 Comment[fr]=Fusionner les modifications entre cette branche et une autre
+Comment[hu]=A módosítások összefésülése egy másik ággal
 Comment[is]=Bræða saman breytingar milli þessarar og annarar greinar
 Comment[it]=Fondi i cambiamenti tra questo e un altro ramo
 Comment[ja]=このブランチと他のブランチの間で、変更をマージします。
@@ -384,7 +405,6 @@
 Comment[sv]=Sammanfoga ändringar mellan den här och en annan gren
 Comment[tr]=Bu ve başka bölüm arasındaki değişiklikleri birleştir
 Comment[uk]=Об'єднати зміни в цій та іншій гілках
-Comment[xx]=xxMerge changes between this and another branchxx
 Comment[zh_CN]=合并本地和另外一个分支的更改
 Exec=kio_svn_helper -m %U
 
@@ -392,10 +412,13 @@
 Name=Blame...
 Name[bg]=Информация...
 Name[cs]=Obvinit...
+Name[de]=Blame ...
 Name[el]=Συσχέτιση...
 Name[es]=Responsabilizar...
 Name[et]=Autorsus...
+Name[eu]=Erruduna...
 Name[fr]=Blâmer...
+Name[hu]=Ki tette ezt...
 Name[is]=Kenna um...
 Name[it]=Traccia...
 Name[ja]=ブレイム...
@@ -409,7 +432,6 @@
 Name[sr@Latn]=Okrivi...
 Name[sv]=Klandra...
 Name[uk]=Вина...
-Name[xx]=xxBlame...xx
 Name[zh_CN]=历史...
 Icon=svn_blame
 Comment=See who wrote each line of the file and in what revision
@@ -420,7 +442,9 @@
 Comment[el]=Δείτε ποιος έγραψε κάθε γραμμή του αρχείου και σε ποια αναθεώρηση
 Comment[es]=Ver quién escribió cada línea del archivo y en qué revisión
 Comment[et]=Vaatamine, kes ja millises versioonis mingi faili rea kirjutas
+Comment[eu]=Ikusi nork idatzi duen lerro bakoitza eta zer errebisiotan
 Comment[fr]=Voir qui a écrit chacune des lignes du fichier, et dans quelle version.
+Comment[hu]=A fájlok készítőinek megtekintése soronként, verzió szerint
 Comment[is]=Sjá hver skrifaði hvaða línu og í hvaða útgáfu
 Comment[it]=Vedi chi ha scritto ogni riga del file e in quale revisione
 Comment[ja]=誰がどのリビジョンの、どのファイルの、どの行を書いたのかを見ます。
@@ -433,7 +457,6 @@
 Comment[sr@Latn]=Prikaži za svaku liniju fajla ko ju je napisao i u kojoj reviziji
 Comment[sv]=Se vem som skrev varje rad i filen och för vilken version
 Comment[uk]=Подивитись хто написав кожний рядок файла і в якій модифікації
-Comment[xx]=xxSee who wrote each line of the file and in what revisionxx
 Comment[zh_CN]=查看谁在哪次修订中写了文件的哪一行
 Exec=kio_svn_helper -b %U
 
@@ -442,11 +465,13 @@
 Name[bg]=Създаване на кръпка...
 Name[cs]=Vytvořit záplatu...
 Name[da]=Lav rettelse...
-Name[de]=Patch erstellen...
+Name[de]=Patch erstellen ...
 Name[el]=Δημιουργία διόρθωσης...
 Name[es]=Crear parche...
 Name[et]=Paiga loomine...
+Name[eu]=Sortu adabakia...
 Name[fr]=Créer un correctif...
+Name[hu]=Folt készítése...
 Name[is]=Búa til plástur...
 Name[it]=Crea correzione...
 Name[ja]=パッチの作成...
@@ -461,7 +486,6 @@
 Name[sv]=Skapa programfix...
 Name[tr]=Yama Oluştur...
 Name[uk]=Створити латку...
-Name[xx]=xxCreate Patch...xx
 Name[zh_CN]=创建补丁...
 Exec=kio_svn_helper -p %U
 
@@ -472,12 +496,14 @@
 Name[cs]=Exportovat...
 Name[cy]=Allforio...
 Name[da]=Eksportér...
-Name[de]=Exportieren...
+Name[de]=Exportieren ...
 Name[el]=Εξαγωγή...
 Name[es]=Exportar...
 Name[et]=Eksport...
+Name[eu]=Esportatu...
 Name[fr]=Exporter...
 Name[ga]=Easpórtáil...
+Name[hu]=Exportálás...
 Name[is]=Flytja út...
 Name[it]=Esporta...
 Name[ja]=エクスポート...
@@ -492,7 +518,6 @@
 Name[sv]=Exportera...
 Name[tr]=Dışa Aktar...
 Name[uk]=Експортувати...
-Name[xx]=xxExport...xx
 Name[zh_CN]=导出...
 Icon=svn_export
 Exec=kio_svn_helper -e %U
@@ -504,7 +529,10 @@
 Comment[el]=Έλεγχος εξόδου ενός αντιγράφου χωρίς έκδοση από ένα δέντρο του χώρου αποθήκευσης
 Comment[es]=Exporta una copia no versionada de un árbol de un repositorio
 Comment[et]=Hoidla failipuu versioonita koopia väljavõte
+Comment[eu]=Deskargatu bertsio-gabeko zuhaitz baten kopia bat biltegitik
 Comment[fr]=Extraire une copie sans contrôle de version d'une arborescence depuis un référentiel
+Comment[hu]=Verzió nélküli másolat készítése az adattárból
+Comment[is]=Ná í afrit af tré án útgáfunúmers frá geymslu
 Comment[it]=Ritira una copia senza versione di un albero da un deposito
 Comment[ja]=レポジトリから非バージョン管理ツリーとしてチェックアウトします。
 Comment[nl]=Een niet onder versiebeheer vallende kopie uitchecken van een tak uit de repository
@@ -517,7 +545,6 @@
 Comment[sv]=Checka ut en kopia utan versionskontroll från ett arkiv
 Comment[tr]=Depodaki bir ağaçtan kusurlu bir versionsuz kopyayı kontrol et
 Comment[uk]=Взяти зі сховища копію дерева без версій
-Comment[xx]=xxCheckout out an unversioned copy of a tree from a repositoryxx
 Comment[zh_CN]=从仓库中检出无版本副本
 
 [Desktop Action Diff]
@@ -529,8 +556,10 @@
 Name[el]=Διαφορές (τοπικά)
 Name[es]=Diferencias (locales)
 Name[et]=Võrdlemine (kohalik)
+Name[eu]=Desberdintasunak (lokala)
 Name[fr]=Différences (locales)
 Name[ga]=Diff (logánta)
+Name[hu]=Diff (helyi)
 Name[is]=Bera saman (staðbundið)
 Name[it]=Differenza (locale)
 Name[ja]=Diff（ローカル）
@@ -545,7 +574,6 @@
 Name[sv]=Jämför (lokalt)
 Name[tr]=Diff (yerel)
 Name[uk]=Розбіжності (локальні)
-Name[xx]=xxDiff (local)xx
 Name[zh_CN]=Diff (本地)
 Icon=svn_diff
 Exec=kio_svn_helper -D %U
@@ -557,7 +585,9 @@
 Comment[el]=Εμφάνιση τοπικών αλλαγών από την τελευταία ενημέρωση
 Comment[es]=Mostrar los cambios locales desde la última actualización
 Comment[et]=Kohalike muudatuste näitamine pärast viimast uuendamist
+Comment[eu]=Erakutsi azken aldaketatik gertatu diren aldaketa lokalak
 Comment[fr]=Afficher les changements locaux effectués depuis la dernière mise à jour
+Comment[hu]=A helyi módosítások mutatása (az utolsó frissítés óta)
 Comment[is]=Sýna staðbundnar breytingar frá seinustu uppfærslu
 Comment[it]=Mostra i cambiamenti locali dall'ultimo aggiornamento
 Comment[ja]=最終アップデートからローカルにどのような変更があったのかを表示します。
@@ -571,6 +601,5 @@
 Comment[sv]=Visa lokala ändringar sedan senaste uppdateringen
 Comment[tr]=Son güncellemeden sonraki yerel değişiklikleri göster
 Comment[uk]=Показати локальні зміни з часу останнього оновлення
-Comment[xx]=xxShow local changes since last updatexx
 Comment[zh_CN]=显示上次更新后本地的更改
 
Index: kioslave/svn/svnhelper/apply_patch.desktop
===================================================================
--- kioslave/svn/svnhelper/apply_patch.desktop	(.../tags/KDE/3.5.0/kdesdk)	(revision 493327)
+++ kioslave/svn/svnhelper/apply_patch.desktop	(.../branches/KDE/3.5/kdesdk)	(revision 493327)
@@ -9,12 +9,15 @@
 Name[bg]=Прилагане на кръпка...
 Name[cs]=Aplikovat záplatu...
 Name[da]=Anvend rettelse...
-Name[de]=Patch einspielen...
+Name[de]=Patch einspielen ...
 Name[el]=Εφαρμογή επιδιόρθωσης...
 Name[es]=Aplicar parche...
 Name[et]=Paiga rakendamine...
+Name[eu]=Aplikatu adabakia...
 Name[fr]=Appliquer le correctif...
 Name[ga]=Cuir Paiste i bhFeidhm...
+Name[he]=החל את הטלאי...
+Name[hu]=Folt alkalmazása...
 Name[is]=Virkja plástur...
 Name[it]=Applica correzione...
 Name[ja]=パッチ適用
@@ -29,7 +32,6 @@
 Name[sv]=Utför programfix...
 Name[tr]=Yamayı Uygula...
 Name[uk]=Застосувати латку...
-Name[xx]=xxApply Patch...xx
 Name[zh_CN]=应用补丁...
 Icon=apply
 Exec=
@@ -41,7 +43,9 @@
 Comment[el]=Εφαρμογή της επιδιόρθωσης σε άλλο φάκελο/αρχείο
 Comment[es]=Aplicar el parche a otra carpeta o archivo
 Comment[et]=Paiga rakendamine teisele kataloogile/failile
+Comment[eu]=Aplikatu adabakia beste karpeta/fitxategi bati
 Comment[fr]=Appliquer le correctif sur un autre dossier / fichier
+Comment[hu]=A folt alkalmazása másik könyvtárra vagy fájlra
 Comment[is]=Virkja plásturinn á aðra möppu/skrá
 Comment[it]=Applica la correzione a un'altra cartella o file
 Comment[ja]=他のフォルダやファイルへパッチを適用する。
@@ -56,6 +60,5 @@
 Comment[sv]=Utför en programfix för en annan katalog eller fil
 Comment[tr]=Yamayı diğer dizine/dosyaya uygula
 Comment[uk]=Застосувати латку до іншої теки файла
-Comment[xx]=xxApply the patch to another folder/filexx
 Comment[zh_CN]=将补丁应用到其它文件夹/文件
 

Property changes on: .
___________________________________________________________________
Name: svn:externals
   + admin https://svn.kde.org/home/kde/branches/KDE/3.5/kde-common/admin


